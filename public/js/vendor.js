(self.webpackChunk=self.webpackChunk||[]).push([[660],{435:(e,t,i)=>{"use strict";function r(e,t,i){if(-1===e.indexOf(t))return i;const r=e[e.indexOf(t)+1];if(!r)return i;if("duration"===t){let e=r.match(/([0-9]+)ms/);if(e)return e[1]}if("min"===t){let e=r.match(/([0-9]+)px/);if(e)return e[1]}return r}i.d(t,{A:()=>n});var n=function(e){function t(t,{modifiers:i}){let n=r(i,"duration",250)/1e3,s=r(i,"min",0),o=!i.includes("min");t._x_isShown||(t.style.height=`${s}px`),!t._x_isShown&&o&&(t.hidden=!0),t._x_isShown||(t.style.overflow="hidden");let a=(t,i)=>{let r=e.setStyles(t,i);return i.height?()=>{}:r},l={transitionProperty:"height",transitionDuration:`${n}s`,transitionTimingFunction:"cubic-bezier(0.4, 0.0, 0.2, 1)"};t._x_transition={in(i=(()=>{}),r=(()=>{})){o&&(t.hidden=!1),o&&(t.style.display=null);let n=t.getBoundingClientRect().height;t.style.height="auto";let a=t.getBoundingClientRect().height;n===a&&(n=s),e.transition(t,e.setStyles,{during:l,start:{height:n+"px"},end:{height:a+"px"}},(()=>t._x_isShown=!0),(()=>{t.getBoundingClientRect().height==a&&(t.style.overflow=null)}))},out(i=(()=>{}),r=(()=>{})){let n=t.getBoundingClientRect().height;e.transition(t,a,{during:l,start:{height:n+"px"},end:{height:s+"px"}},(()=>t.style.overflow="hidden"),(()=>{t._x_isShown=!1,t.style.height==`${s}px`&&o&&(t.style.display="none",t.hidden=!0)}))}}}e.directive("collapse",t),t.inline=(e,{modifiers:t})=>{t.includes("min")&&(e._x_doShow=()=>{},e._x_doHide=()=>{})}}},533:(e,t,i)=>{"use strict";function r(e){if(e.includes("full"))return.99;if(e.includes("half"))return.5;if(!e.includes("threshold"))return 0;let t=e[e.indexOf("threshold")+1];return"100"===t?1:"0"===t?0:Number(`.${t}`)}function n(e){let t=e.match(/^(-?[0-9]+)(px|%)?$/);return t?t[1]+(t[2]||"px"):void 0}function s(e){const t="0px 0px 0px 0px",i=e.indexOf("margin");if(-1===i)return t;let r=[];for(let t=1;t<5;t++)r.push(n(e[i+t]||""));return r=r.filter((e=>void 0!==e)),r.length?r.join(" ").trim():t}i.d(t,{A:()=>o});var o=function(e){e.directive("intersect",e.skipDuringClone(((e,{value:t,expression:i,modifiers:n},{evaluateLater:o,cleanup:a})=>{let l=o(i),c={rootMargin:s(n),threshold:r(n)},u=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting!==("leave"===t)&&(l(),n.includes("once")&&u.disconnect())}))}),c);u.observe(e),a((()=>{u.disconnect()}))})))}},607:(e,t,i)=>{"use strict";function r(e,t){return null!==t.getItem(e)}function n(e,t){return JSON.parse(t.getItem(e,t))}function s(e,t,i){i.setItem(e,JSON.stringify(t))}i.d(t,{A:()=>o});var o=function(e){let t=()=>{let t,i;try{i=localStorage}catch(e){console.error(e),console.warn("Alpine: $persist is using temporary storage since localStorage is unavailable.");let t=new Map;i={getItem:t.get.bind(t),setItem:t.set.bind(t)}}return e.interceptor(((o,a,l,c,u)=>{let d=t||`_x_${c}`,h=r(d,i)?n(d,i):o;return l(h),e.effect((()=>{let e=a();s(d,e,i),l(e)})),h}),(e=>{e.as=i=>(t=i,e),e.using=t=>(i=t,e)}))};Object.defineProperty(e,"$persist",{get:()=>t()}),e.magic("persist",t),e.persist=(t,{get:i,set:o},a=localStorage)=>{let l=r(t,a)?n(t,a):i();o(l),e.effect((()=>{let e=i();s(t,e,a),o(e)}))}}},760:(e,t,i)=>{"use strict";i.d(t,{A:()=>Le});
/*!
 * iro.js v5.5.2
 * 2016-2021 James Daniel
 * Licensed under MPL 2.0
 * github.com/jaames/iro.js
 */
var r,n,s,o,a,l={},c=[],u=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i;function d(e,t){for(var i in t)e[i]=t[i];return e}function h(e){var t=e.parentNode;t&&t.removeChild(e)}function p(e,t,i){var r,n,s,o,a=arguments;if(t=d({},t),arguments.length>3)for(i=[i],r=3;r<arguments.length;r++)i.push(a[r]);if(null!=i&&(t.children=i),null!=e&&null!=e.defaultProps)for(n in e.defaultProps)void 0===t[n]&&(t[n]=e.defaultProps[n]);return o=t.key,null!=(s=t.ref)&&delete t.ref,null!=o&&delete t.key,f(e,t,o,s)}function f(e,t,i,n){var s={type:e,props:t,key:i,ref:n,__k:null,__p:null,__b:0,__e:null,l:null,__c:null,constructor:void 0};return r.vnode&&r.vnode(s),s}function m(e){return e.children}function g(e,t){this.props=e,this.context=t}function y(e,t){if(null==t)return e.__p?y(e.__p,e.__p.__k.indexOf(e)+1):null;for(var i;t<e.__k.length;t++)if(null!=(i=e.__k[t])&&null!=i.__e)return i.__e;return"function"==typeof e.type?y(e):null}function v(e){var t,i;if(null!=(e=e.__p)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(i=e.__k[t])&&null!=i.__e){e.__e=e.__c.base=i.__e;break}return v(e)}}function b(e){(!e.__d&&(e.__d=!0)&&1===n.push(e)||o!==r.debounceRendering)&&(o=r.debounceRendering,(r.debounceRendering||s)(w))}function w(){var e,t,i,r,s,o,a,l;for(n.sort((function(e,t){return t.__v.__b-e.__v.__b}));e=n.pop();)e.__d&&(i=void 0,r=void 0,o=(s=(t=e).__v).__e,a=t.__P,l=t.u,t.u=!1,a&&(i=[],r=x(a,s,d({},s),t.__n,void 0!==a.ownerSVGElement,null,i,l,null==o?y(s):o),C(i,s),r!=o&&v(s)))}function _(e,t,i,r,n,s,o,a,u){var d,p,f,m,g,v,b,w=i&&i.__k||c,_=w.length;if(a==l&&(a=null!=s?s[0]:_?y(i,0):null),d=0,t.__k=E(t.__k,(function(i){if(null!=i){if(i.__p=t,i.__b=t.__b+1,null===(f=w[d])||f&&i.key==f.key&&i.type===f.type)w[d]=void 0;else for(p=0;p<_;p++){if((f=w[p])&&i.key==f.key&&i.type===f.type){w[p]=void 0;break}f=null}if(m=x(e,i,f=f||l,r,n,s,o,null,a,u),(p=i.ref)&&f.ref!=p&&(b||(b=[])).push(p,i.__c||m,i),null!=m){if(null==v&&(v=m),null!=i.l)m=i.l,i.l=null;else if(s==f||m!=a||null==m.parentNode){e:if(null==a||a.parentNode!==e)e.appendChild(m);else{for(g=a,p=0;(g=g.nextSibling)&&p<_;p+=2)if(g==m)break e;e.insertBefore(m,a)}"option"==t.type&&(e.value="")}a=m.nextSibling,"function"==typeof t.type&&(t.l=m)}}return d++,i})),t.__e=v,null!=s&&"function"!=typeof t.type)for(d=s.length;d--;)null!=s[d]&&h(s[d]);for(d=_;d--;)null!=w[d]&&L(w[d],w[d]);if(b)for(d=0;d<b.length;d++)R(b[d],b[++d],b[++d])}function E(e,t,i){if(null==i&&(i=[]),null==e||"boolean"==typeof e)t&&i.push(t(null));else if(Array.isArray(e))for(var r=0;r<e.length;r++)E(e[r],t,i);else i.push(t?t(function(e){if(null==e||"boolean"==typeof e)return null;if("string"==typeof e||"number"==typeof e)return f(null,e,null,null);if(null!=e.__e||null!=e.__c){var t=f(e.type,e.props,e.key,null);return t.__e=e.__e,t}return e}(e)):e);return i}function T(e,t,i){"-"===t[0]?e.setProperty(t,i):e[t]="number"==typeof i&&!1===u.test(t)?i+"px":null==i?"":i}function S(e,t,i,r,n){var s,o,a,l,c;if("key"===(t=n?"className"===t?"class":t:"class"===t?"className":t)||"children"===t);else if("style"===t)if(s=e.style,"string"==typeof i)s.cssText=i;else{if("string"==typeof r&&(s.cssText="",r=null),r)for(o in r)i&&o in i||T(s,o,"");if(i)for(a in i)r&&i[a]===r[a]||T(s,a,i[a])}else"o"===t[0]&&"n"===t[1]?(l=t!==(t=t.replace(/Capture$/,"")),c=t.toLowerCase(),t=(c in e?c:t).slice(2),i?(r||e.addEventListener(t,k,l),(e.t||(e.t={}))[t]=i):e.removeEventListener(t,k,l)):"list"!==t&&"tagName"!==t&&"form"!==t&&!n&&t in e?e[t]=null==i?"":i:"function"!=typeof i&&"dangerouslySetInnerHTML"!==t&&(t!==(t=t.replace(/^xlink:?/,""))?null==i||!1===i?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),i):null==i||!1===i?e.removeAttribute(t):e.setAttribute(t,i))}function k(e){return this.t[e.type](r.event?r.event(e):e)}function x(e,t,i,n,s,o,a,l,c,u){var h,p,f,y,v,b,w,T,S,k,x=t.type;if(void 0!==t.constructor)return null;(h=r.__b)&&h(t);try{e:if("function"==typeof x){if(T=t.props,S=(h=x.contextType)&&n[h.__c],k=h?S?S.props.value:h.__p:n,i.__c?w=(p=t.__c=i.__c).__p=p.__E:("prototype"in x&&x.prototype.render?t.__c=p=new x(T,k):(t.__c=p=new g(T,k),p.constructor=x,p.render=P),S&&S.sub(p),p.props=T,p.state||(p.state={}),p.context=k,p.__n=n,f=p.__d=!0,p.__h=[]),null==p.__s&&(p.__s=p.state),null!=x.getDerivedStateFromProps&&d(p.__s==p.state?p.__s=d({},p.__s):p.__s,x.getDerivedStateFromProps(T,p.__s)),f)null==x.getDerivedStateFromProps&&null!=p.componentWillMount&&p.componentWillMount(),null!=p.componentDidMount&&a.push(p);else{if(null==x.getDerivedStateFromProps&&null==l&&null!=p.componentWillReceiveProps&&p.componentWillReceiveProps(T,k),!l&&null!=p.shouldComponentUpdate&&!1===p.shouldComponentUpdate(T,p.__s,k)){for(p.props=T,p.state=p.__s,p.__d=!1,p.__v=t,t.__e=null!=c?c!==i.__e?c:i.__e:null,t.__k=i.__k,h=0;h<t.__k.length;h++)t.__k[h]&&(t.__k[h].__p=t);break e}null!=p.componentWillUpdate&&p.componentWillUpdate(T,p.__s,k)}for(y=p.props,v=p.state,p.context=k,p.props=T,p.state=p.__s,(h=r.__r)&&h(t),p.__d=!1,p.__v=t,p.__P=e,h=p.render(p.props,p.state,p.context),t.__k=E(null!=h&&h.type==m&&null==h.key?h.props.children:h),null!=p.getChildContext&&(n=d(d({},n),p.getChildContext())),f||null==p.getSnapshotBeforeUpdate||(b=p.getSnapshotBeforeUpdate(y,v)),_(e,t,i,n,s,o,a,c,u),p.base=t.__e;h=p.__h.pop();)p.__s&&(p.state=p.__s),h.call(p);f||null==y||null==p.componentDidUpdate||p.componentDidUpdate(y,v,b),w&&(p.__E=p.__p=null)}else t.__e=A(i.__e,t,i,n,s,o,a,u);(h=r.diffed)&&h(t)}catch(e){r.__e(e,t,i)}return t.__e}function C(e,t){for(var i;i=e.pop();)try{i.componentDidMount()}catch(e){r.__e(e,i.__v)}r.__c&&r.__c(t)}function A(e,t,i,r,n,s,o,a){var u,d,h,p,f=i.props,m=t.props;if(n="svg"===t.type||n,null==e&&null!=s)for(u=0;u<s.length;u++)if(null!=(d=s[u])&&(null===t.type?3===d.nodeType:d.localName===t.type)){e=d,s[u]=null;break}if(null==e){if(null===t.type)return document.createTextNode(m);e=n?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type),s=null}return null===t.type?f!==m&&(null!=s&&(s[s.indexOf(e)]=null),e.data=m):t!==i&&(null!=s&&(s=c.slice.call(e.childNodes)),h=(f=i.props||l).dangerouslySetInnerHTML,p=m.dangerouslySetInnerHTML,a||(p||h)&&(p&&h&&p.__html==h.__html||(e.innerHTML=p&&p.__html||"")),function(e,t,i,r,n){var s;for(s in i)s in t||S(e,s,null,i[s],r);for(s in t)n&&"function"!=typeof t[s]||"value"===s||"checked"===s||i[s]===t[s]||S(e,s,t[s],i[s],r)}(e,m,f,n,a),t.__k=t.props.children,p||_(e,t,i,r,"foreignObject"!==t.type&&n,s,o,l,a),a||("value"in m&&void 0!==m.value&&m.value!==e.value&&(e.value=null==m.value?"":m.value),"checked"in m&&void 0!==m.checked&&m.checked!==e.checked&&(e.checked=m.checked))),e}function R(e,t,i){try{"function"==typeof e?e(t):e.current=t}catch(e){r.__e(e,i)}}function L(e,t,i){var n,s,o;if(r.unmount&&r.unmount(e),(n=e.ref)&&R(n,null,t),i||"function"==typeof e.type||(i=null!=(s=e.__e)),e.__e=e.l=null,null!=(n=e.__c)){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(e){r.__e(e,t)}n.base=n.__P=null}if(n=e.__k)for(o=0;o<n.length;o++)n[o]&&L(n[o],t,i);null!=s&&h(s)}function P(e,t,i){return this.constructor(e,i)}function O(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function D(){return D=Object.assign||function(e){for(var t=arguments,i=1;i<arguments.length;i++){var r=t[i];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},D.apply(this,arguments)}r={},g.prototype.setState=function(e,t){var i=this.__s!==this.state&&this.__s||(this.__s=d({},this.state));("function"!=typeof e||(e=e(i,this.props)))&&d(i,e),null!=e&&this.__v&&(this.u=!1,t&&this.__h.push(t),b(this))},g.prototype.forceUpdate=function(e){this.__v&&(e&&this.__h.push(e),this.u=!0,b(this))},g.prototype.render=m,n=[],s="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,o=r.debounceRendering,r.__e=function(e,t,i){for(var r;t=t.__p;)if((r=t.__c)&&!r.__p)try{if(r.constructor&&null!=r.constructor.getDerivedStateFromError)r.setState(r.constructor.getDerivedStateFromError(e));else{if(null==r.componentDidCatch)continue;r.componentDidCatch(e)}return b(r.__E=r)}catch(t){e=t}throw e},a=l;var I="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",M="[\\s|\\(]+("+I+")[,|\\s]+("+I+")[,|\\s]+("+I+")\\s*\\)?",F="[\\s|\\(]+("+I+")[,|\\s]+("+I+")[,|\\s]+("+I+")[,|\\s]+("+I+")\\s*\\)?",N=new RegExp("rgb"+M),j=new RegExp("rgba"+F),B=new RegExp("hsl"+M),U=new RegExp("hsla"+F),z="^(?:#?|0x?)",$="([0-9a-fA-F]{1})",H="([0-9a-fA-F]{2})",V=new RegExp(z+$+$+$+"$"),G=new RegExp(z+$+$+$+$+"$"),K=new RegExp(z+H+H+H+"$"),q=new RegExp(z+H+H+H+H+"$"),W=Math.log,Y=Math.round,X=Math.floor;function Q(e,t,i){return Math.min(Math.max(e,t),i)}function J(e,t){var i=e.indexOf("%")>-1,r=parseFloat(e);return i?t/100*r:r}function Z(e){return parseInt(e,16)}function ee(e){return e.toString(16).padStart(2,"0")}var te=function(){function e(e,t){this.$={h:0,s:0,v:0,a:1},e&&this.set(e),this.onChange=t,this.initialValue=D({},this.$)}var t,i,r,n=e.prototype;return n.set=function(t){if("string"==typeof t)/^(?:#?|0x?)[0-9a-fA-F]{3,8}$/.test(t)?this.hexString=t:/^rgba?/.test(t)?this.rgbString=t:/^hsla?/.test(t)&&(this.hslString=t);else{if("object"!=typeof t)throw new Error("Invalid color value");t instanceof e?this.hsva=t.hsva:"r"in t&&"g"in t&&"b"in t?this.rgb=t:"h"in t&&"s"in t&&"v"in t?this.hsv=t:"h"in t&&"s"in t&&"l"in t?this.hsl=t:"kelvin"in t&&(this.kelvin=t.kelvin)}},n.setChannel=function(e,t,i){var r;this[e]=D({},this[e],((r={})[t]=i,r))},n.reset=function(){this.hsva=this.initialValue},n.clone=function(){return new e(this)},n.unbind=function(){this.onChange=void 0},e.hsvToRgb=function(e){var t=e.h/60,i=e.s/100,r=e.v/100,n=X(t),s=t-n,o=r*(1-i),a=r*(1-s*i),l=r*(1-(1-s)*i),c=n%6,u=[l,r,r,a,o,o][c],d=[o,o,l,r,r,a][c];return{r:Q(255*[r,a,o,o,l,r][c],0,255),g:Q(255*u,0,255),b:Q(255*d,0,255)}},e.rgbToHsv=function(e){var t=e.r/255,i=e.g/255,r=e.b/255,n=Math.max(t,i,r),s=Math.min(t,i,r),o=n-s,a=0,l=n,c=0===n?0:o/n;switch(n){case s:a=0;break;case t:a=(i-r)/o+(i<r?6:0);break;case i:a=(r-t)/o+2;break;case r:a=(t-i)/o+4}return{h:60*a%360,s:Q(100*c,0,100),v:Q(100*l,0,100)}},e.hsvToHsl=function(e){var t=e.s/100,i=e.v/100,r=(2-t)*i,n=r<=1?r:2-r,s=n<1e-9?0:t*i/n;return{h:e.h,s:Q(100*s,0,100),l:Q(50*r,0,100)}},e.hslToHsv=function(e){var t=2*e.l,i=e.s*(t<=100?t:200-t)/100,r=t+i<1e-9?0:2*i/(t+i);return{h:e.h,s:Q(100*r,0,100),v:Q((t+i)/2,0,100)}},e.kelvinToRgb=function(e){var t,i,r,n=e/100;return n<66?(t=255,i=-155.25485562709179-.44596950469579133*(i=n-2)+104.49216199393888*W(i),r=n<20?0:.8274096064007395*(r=n-10)-254.76935184120902+115.67994401066147*W(r)):(t=351.97690566805693+.114206453784165*(t=n-55)-40.25366309332127*W(t),i=325.4494125711974+.07943456536662342*(i=n-50)-28.0852963507957*W(i),r=255),{r:Q(X(t),0,255),g:Q(X(i),0,255),b:Q(X(r),0,255)}},e.rgbToKelvin=function(t){for(var i,r=t.r,n=t.b,s=2e3,o=4e4;o-s>.4;){i=.5*(o+s);var a=e.kelvinToRgb(i);a.b/a.r>=n/r?o=i:s=i}return i},t=e,i=[{key:"hsv",get:function(){var e=this.$;return{h:e.h,s:e.s,v:e.v}},set:function(e){var t=this.$;if(e=D({},t,e),this.onChange){var i={h:!1,v:!1,s:!1,a:!1};for(var r in t)i[r]=e[r]!=t[r];this.$=e,(i.h||i.s||i.v||i.a)&&this.onChange(this,i)}else this.$=e}},{key:"hsva",get:function(){return D({},this.$)},set:function(e){this.hsv=e}},{key:"hue",get:function(){return this.$.h},set:function(e){this.hsv={h:e}}},{key:"saturation",get:function(){return this.$.s},set:function(e){this.hsv={s:e}}},{key:"value",get:function(){return this.$.v},set:function(e){this.hsv={v:e}}},{key:"alpha",get:function(){return this.$.a},set:function(e){this.hsv=D({},this.hsv,{a:e})}},{key:"kelvin",get:function(){return e.rgbToKelvin(this.rgb)},set:function(t){this.rgb=e.kelvinToRgb(t)}},{key:"red",get:function(){return this.rgb.r},set:function(e){this.rgb=D({},this.rgb,{r:e})}},{key:"green",get:function(){return this.rgb.g},set:function(e){this.rgb=D({},this.rgb,{g:e})}},{key:"blue",get:function(){return this.rgb.b},set:function(e){this.rgb=D({},this.rgb,{b:e})}},{key:"rgb",get:function(){var t=e.hsvToRgb(this.$),i=t.r,r=t.g,n=t.b;return{r:Y(i),g:Y(r),b:Y(n)}},set:function(t){this.hsv=D({},e.rgbToHsv(t),{a:void 0===t.a?1:t.a})}},{key:"rgba",get:function(){return D({},this.rgb,{a:this.alpha})},set:function(e){this.rgb=e}},{key:"hsl",get:function(){var t=e.hsvToHsl(this.$),i=t.h,r=t.s,n=t.l;return{h:Y(i),s:Y(r),l:Y(n)}},set:function(t){this.hsv=D({},e.hslToHsv(t),{a:void 0===t.a?1:t.a})}},{key:"hsla",get:function(){return D({},this.hsl,{a:this.alpha})},set:function(e){this.hsl=e}},{key:"rgbString",get:function(){var e=this.rgb;return"rgb("+e.r+", "+e.g+", "+e.b+")"},set:function(e){var t,i,r,n,s=1;if((t=N.exec(e))?(i=J(t[1],255),r=J(t[2],255),n=J(t[3],255)):(t=j.exec(e))&&(i=J(t[1],255),r=J(t[2],255),n=J(t[3],255),s=J(t[4],1)),!t)throw new Error("Invalid rgb string");this.rgb={r:i,g:r,b:n,a:s}}},{key:"rgbaString",get:function(){var e=this.rgba;return"rgba("+e.r+", "+e.g+", "+e.b+", "+e.a+")"},set:function(e){this.rgbString=e}},{key:"hexString",get:function(){var e=this.rgb;return"#"+ee(e.r)+ee(e.g)+ee(e.b)},set:function(e){var t,i,r,n,s=255;if((t=V.exec(e))?(i=17*Z(t[1]),r=17*Z(t[2]),n=17*Z(t[3])):(t=G.exec(e))?(i=17*Z(t[1]),r=17*Z(t[2]),n=17*Z(t[3]),s=17*Z(t[4])):(t=K.exec(e))?(i=Z(t[1]),r=Z(t[2]),n=Z(t[3])):(t=q.exec(e))&&(i=Z(t[1]),r=Z(t[2]),n=Z(t[3]),s=Z(t[4])),!t)throw new Error("Invalid hex string");this.rgb={r:i,g:r,b:n,a:s/255}}},{key:"hex8String",get:function(){var e=this.rgba;return"#"+ee(e.r)+ee(e.g)+ee(e.b)+ee(X(255*e.a))},set:function(e){this.hexString=e}},{key:"hslString",get:function(){var e=this.hsl;return"hsl("+e.h+", "+e.s+"%, "+e.l+"%)"},set:function(e){var t,i,r,n,s=1;if((t=B.exec(e))?(i=J(t[1],360),r=J(t[2],100),n=J(t[3],100)):(t=U.exec(e))&&(i=J(t[1],360),r=J(t[2],100),n=J(t[3],100),s=J(t[4],1)),!t)throw new Error("Invalid hsl string");this.hsl={h:i,s:r,l:n,a:s}}},{key:"hslaString",get:function(){var e=this.hsla;return"hsla("+e.h+", "+e.s+"%, "+e.l+"%, "+e.a+")"},set:function(e){this.hslString=e}}],i&&O(t.prototype,i),r&&O(t,r),e}();function ie(e){var t,i=e.width,r=e.sliderSize,n=e.borderWidth,s=e.handleRadius,o=e.padding,a=e.sliderShape,l="horizontal"===e.layoutDirection;return r=null!=(t=r)?t:2*o+2*s,"circle"===a?{handleStart:e.padding+e.handleRadius,handleRange:i-2*o-2*s,width:i,height:i,cx:i/2,cy:i/2,radius:i/2-n/2}:{handleStart:r/2,handleRange:i-r,radius:r/2,x:0,y:0,width:l?r:i,height:l?i:r}}function re(e,t){var i=ie(e),r=i.width,n=i.height,s=i.handleRange,o=i.handleStart,a="horizontal"===e.layoutDirection,l=function(e,t){var i=t.hsva,r=t.rgb;switch(e.sliderType){case"red":return r.r/2.55;case"green":return r.g/2.55;case"blue":return r.b/2.55;case"alpha":return 100*i.a;case"kelvin":var n=e.minTemperature,s=e.maxTemperature-n,o=(t.kelvin-n)/s*100;return Math.max(0,Math.min(o,100));case"hue":return i.h/=3.6;case"saturation":return i.s;default:return i.v}}(e,t),c=a?r/2:n/2,u=o+l/100*s;return a&&(u=-1*u+s+2*o),{x:a?c:u,y:a?u:c}}var ne,se=2*Math.PI,oe=function(e,t){return(e%t+t)%t},ae=function(e,t){return Math.sqrt(e*e+t*t)};function le(e){return e.width/2-e.padding-e.handleRadius-e.borderWidth}function ce(e){var t=e.width/2;return{width:e.width,radius:t-e.borderWidth,cx:t,cy:t}}function ue(e,t,i){var r=e.wheelAngle,n=e.wheelDirection;return i&&"clockwise"===n?t=r+t:"clockwise"===n?t=360-r+t:i&&"anticlockwise"===n?t=r+180-t:"anticlockwise"===n&&(t=r-t),oe(t,360)}function de(e,t,i){var r=ce(e),n=r.cx,s=r.cy,o=le(e);t=n-t,i=s-i;var a=ue(e,Math.atan2(-i,-t)*(360/se)),l=Math.min(ae(t,i),o);return{h:Math.round(a),s:Math.round(100/o*l)}}function he(e){var t=e.width,i=e.boxHeight;return{width:t,height:null!=i?i:t,radius:e.padding+e.handleRadius}}function pe(e,t,i){var r=he(e),n=r.width,s=r.height,o=r.radius,a=(t-o)/(n-2*o)*100,l=(i-o)/(s-2*o)*100;return{s:Math.max(0,Math.min(a,100)),v:Math.max(0,Math.min(100-l,100))}}function fe(e){ne||(ne=document.getElementsByTagName("base"));var t=window.navigator.userAgent,i=/^((?!chrome|android).)*safari/i.test(t),r=/iPhone|iPod|iPad/i.test(t),n=window.location;return(i||r)&&ne.length>0?n.protocol+"//"+n.host+n.pathname+n.search+e:e}function me(e,t,i,r){for(var n=0;n<r.length;n++){var s=r[n].x-t,o=r[n].y-i;if(Math.sqrt(s*s+o*o)<e.handleRadius)return n}return null}function ge(e){return{boxSizing:"border-box",border:e.borderWidth+"px solid "+e.borderColor}}function ye(e,t,i){return e+"-gradient("+t+", "+i.map((function(e){var t=e[0];return e[1]+" "+t+"%"})).join(",")+")"}function ve(e){return"string"==typeof e?e:e+"px"}var be=["mousemove","touchmove","mouseup","touchend"],we=function(e){function t(t){e.call(this,t),this.uid=(Math.random()+1).toString(36).substring(5)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(e){var t=this.handleEvent.bind(this),i={onMouseDown:t,ontouchstart:t},r="horizontal"===e.layoutDirection,n=null===e.margin?e.sliderMargin:e.margin,s={overflow:"visible",display:r?"inline-block":"block"};return e.index>0&&(s[r?"marginLeft":"marginTop"]=n),p(m,null,e.children(this.uid,i,s))},t.prototype.handleEvent=function(e){var t=this,i=this.props.onInput,r=this.base.getBoundingClientRect();e.preventDefault();var n=e.touches?e.changedTouches[0]:e,s=n.clientX-r.left,o=n.clientY-r.top;switch(e.type){case"mousedown":case"touchstart":!1!==i(s,o,0)&&be.forEach((function(e){document.addEventListener(e,t,{passive:!1})}));break;case"mousemove":case"touchmove":i(s,o,1);break;case"mouseup":case"touchend":i(s,o,2),be.forEach((function(e){document.removeEventListener(e,t,{passive:!1})}))}},t}(g);function _e(e){var t=e.r,i=e.url,r=t,n=t;return p("svg",{className:"IroHandle IroHandle--"+e.index+" "+(e.isActive?"IroHandle--isActive":""),style:{"-webkit-tap-highlight-color":"rgba(0, 0, 0, 0);",transform:"translate("+ve(e.x)+", "+ve(e.y)+")",willChange:"transform",top:ve(-t),left:ve(-t),width:ve(2*t),height:ve(2*t),position:"absolute",overflow:"visible"}},i&&p("use",Object.assign({xlinkHref:fe(i)},e.props)),!i&&p("circle",{cx:r,cy:n,r:t,fill:"none","stroke-width":2,stroke:"#000"}),!i&&p("circle",{cx:r,cy:n,r:t-2,fill:e.fill,"stroke-width":2,stroke:"#fff"}))}function Ee(e){var t=e.activeIndex,i=void 0!==t&&t<e.colors.length?e.colors[t]:e.color,r=ie(e),n=r.width,s=r.height,o=r.radius,a=re(e,i),l=function(e,t){var i=t.hsv,r=t.rgb;switch(e.sliderType){case"red":return[[0,"rgb(0,"+r.g+","+r.b+")"],[100,"rgb(255,"+r.g+","+r.b+")"]];case"green":return[[0,"rgb("+r.r+",0,"+r.b+")"],[100,"rgb("+r.r+",255,"+r.b+")"]];case"blue":return[[0,"rgb("+r.r+","+r.g+",0)"],[100,"rgb("+r.r+","+r.g+",255)"]];case"alpha":return[[0,"rgba("+r.r+","+r.g+","+r.b+",0)"],[100,"rgb("+r.r+","+r.g+","+r.b+")"]];case"kelvin":for(var n=[],s=e.minTemperature,o=e.maxTemperature,a=o-s,l=s,c=0;l<o;l+=a/8,c+=1){var u=te.kelvinToRgb(l),d=u.r,h=u.g,p=u.b;n.push([12.5*c,"rgb("+d+","+h+","+p+")"])}return n;case"hue":return[[0,"#f00"],[16.666,"#ff0"],[33.333,"#0f0"],[50,"#0ff"],[66.666,"#00f"],[83.333,"#f0f"],[100,"#f00"]];case"saturation":var f=te.hsvToHsl({h:i.h,s:0,v:i.v}),m=te.hsvToHsl({h:i.h,s:100,v:i.v});return[[0,"hsl("+f.h+","+f.s+"%,"+f.l+"%)"],[100,"hsl("+m.h+","+m.s+"%,"+m.l+"%)"]];default:var g=te.hsvToHsl({h:i.h,s:i.s,v:100});return[[0,"#000"],[100,"hsl("+g.h+","+g.s+"%,"+g.l+"%)"]]}}(e,i);return p(we,Object.assign({},e,{onInput:function(t,r,n){var s=function(e,t,i){var r,n=ie(e),s=n.handleRange,o=n.handleStart;r="horizontal"===e.layoutDirection?-1*i+s+o:t-o,r=Math.max(Math.min(r,s),0);var a=Math.round(100/s*r);switch(e.sliderType){case"kelvin":var l=e.minTemperature;return l+(e.maxTemperature-l)*(a/100);case"alpha":return a/100;case"hue":return 3.6*a;case"red":case"blue":case"green":return 2.55*a;default:return a}}(e,t,r);e.parent.inputActive=!0,i[e.sliderType]=s,e.onInput(n,e.id)}}),(function(t,r,c){return p("div",Object.assign({},r,{className:"IroSlider",style:Object.assign({},{position:"relative",width:ve(n),height:ve(s),borderRadius:ve(o),background:"conic-gradient(#ccc 25%, #fff 0 50%, #ccc 0 75%, #fff 0)",backgroundSize:"8px 8px"},c)}),p("div",{className:"IroSliderGradient",style:Object.assign({},{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:ve(o),background:ye("linear","horizontal"===e.layoutDirection?"to top":"to right",l)},ge(e))}),p(_e,{isActive:!0,index:i.index,r:e.handleRadius,url:e.handleSvg,props:e.handleProps,x:a.x,y:a.y}))}))}function Te(e){var t=he(e),i=t.width,r=t.height,n=t.radius,s=e.colors,o=e.parent,a=e.activeIndex,l=void 0!==a&&a<e.colors.length?e.colors[a]:e.color,c=[[[0,"#fff"],[100,"hsl("+l.hue+",100%,50%)"]],[[0,"rgba(0,0,0,0)"],[100,"#000"]]],u=s.map((function(t){return function(e,t){var i=he(e),r=i.width,n=i.height,s=i.radius,o=t.hsv,a=s,l=r-2*s,c=n-2*s;return{x:a+o.s/100*l,y:a+(c-o.v/100*c)}}(e,t)}));return p(we,Object.assign({},e,{onInput:function(t,i,r){if(0===r){var n=me(e,t,i,u);null!==n?o.setActiveColor(n):(o.inputActive=!0,l.hsv=pe(e,t,i),e.onInput(r,e.id))}else 1===r&&(o.inputActive=!0,l.hsv=pe(e,t,i));e.onInput(r,e.id)}}),(function(t,o,a){return p("div",Object.assign({},o,{className:"IroBox",style:Object.assign({},{width:ve(i),height:ve(r),position:"relative"},a)}),p("div",{className:"IroBox",style:Object.assign({},{width:"100%",height:"100%",borderRadius:ve(n)},ge(e),{background:ye("linear","to bottom",c[1])+","+ye("linear","to right",c[0])})}),s.filter((function(e){return e!==l})).map((function(t){return p(_e,{isActive:!1,index:t.index,fill:t.hslString,r:e.handleRadius,url:e.handleSvg,props:e.handleProps,x:u[t.index].x,y:u[t.index].y})})),p(_e,{isActive:!0,index:l.index,fill:l.hslString,r:e.activeHandleRadius||e.handleRadius,url:e.handleSvg,props:e.handleProps,x:u[l.index].x,y:u[l.index].y}))}))}_e.defaultProps={fill:"none",x:0,y:0,r:8,url:null,props:{x:0,y:0}},Ee.defaultProps=Object.assign({},{sliderShape:"bar",sliderType:"value",minTemperature:2200,maxTemperature:11e3});function Se(e){var t=ce(e).width,i=e.colors,r=(e.borderWidth,e.parent),n=e.color,s=n.hsv,o=i.map((function(t){return function(e,t){var i=t.hsv,r=ce(e),n=r.cx,s=r.cy,o=le(e),a=(180+ue(e,i.h,!0))*(se/360),l=i.s/100*o,c="clockwise"===e.wheelDirection?-1:1;return{x:n+l*Math.cos(a)*c,y:s+l*Math.sin(a)*c}}(e,t)})),a={position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",boxSizing:"border-box"};return p(we,Object.assign({},e,{onInput:function(t,i,s){if(0===s){if(!function(e,t,i){var r=ce(e),n=r.cx,s=r.cy,o=e.width/2;return ae(n-t,s-i)<o}(e,t,i))return!1;var a=me(e,t,i,o);null!==a?r.setActiveColor(a):(r.inputActive=!0,n.hsv=de(e,t,i),e.onInput(s,e.id))}else 1===s&&(r.inputActive=!0,n.hsv=de(e,t,i));e.onInput(s,e.id)}}),(function(r,l,c){return p("div",Object.assign({},l,{className:"IroWheel",style:Object.assign({},{width:ve(t),height:ve(t),position:"relative"},c)}),p("div",{className:"IroWheelHue",style:Object.assign({},a,{transform:"rotateZ("+(e.wheelAngle+90)+"deg)",background:"clockwise"===e.wheelDirection?"conic-gradient(red, yellow, lime, aqua, blue, magenta, red)":"conic-gradient(red, magenta, blue, aqua, lime, yellow, red)"})}),p("div",{className:"IroWheelSaturation",style:Object.assign({},a,{background:"radial-gradient(circle closest-side, #fff, transparent)"})}),e.wheelLightness&&p("div",{className:"IroWheelLightness",style:Object.assign({},a,{background:"#000",opacity:1-s.v/100})}),p("div",{className:"IroWheelBorder",style:Object.assign({},a,ge(e))}),i.filter((function(e){return e!==n})).map((function(t){return p(_e,{isActive:!1,index:t.index,fill:t.hslString,r:e.handleRadius,url:e.handleSvg,props:e.handleProps,x:o[t.index].x,y:o[t.index].y})})),p(_e,{isActive:!0,index:n.index,fill:n.hslString,r:e.activeHandleRadius||e.handleRadius,url:e.handleSvg,props:e.handleProps,x:o[n.index].x,y:o[n.index].y}))}))}var ke=function(e){function t(t){var i=this;e.call(this,t),this.colors=[],this.inputActive=!1,this.events={},this.activeEvents={},this.deferredEvents={},this.id=t.id,(t.colors.length>0?t.colors:[t.color]).forEach((function(e){return i.addColor(e)})),this.setActiveColor(0),this.state=Object.assign({},t,{color:this.color,colors:this.colors,layout:t.layout})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.addColor=function(e,t){void 0===t&&(t=this.colors.length);var i=new te(e,this.onColorChange.bind(this));this.colors.splice(t,0,i),this.colors.forEach((function(e,t){return e.index=t})),this.state&&this.setState({colors:this.colors}),this.deferredEmit("color:init",i)},t.prototype.removeColor=function(e){var t=this.colors.splice(e,1)[0];t.unbind(),this.colors.forEach((function(e,t){return e.index=t})),this.state&&this.setState({colors:this.colors}),t.index===this.color.index&&this.setActiveColor(0),this.emit("color:remove",t)},t.prototype.setActiveColor=function(e){this.color=this.colors[e],this.state&&this.setState({color:this.color}),this.emit("color:setActive",this.color)},t.prototype.setColors=function(e,t){var i=this;void 0===t&&(t=0),this.colors.forEach((function(e){return e.unbind()})),this.colors=[],e.forEach((function(e){return i.addColor(e)})),this.setActiveColor(t),this.emit("color:setAll",this.colors)},t.prototype.on=function(e,t){var i=this,r=this.events;(Array.isArray(e)?e:[e]).forEach((function(e){(r[e]||(r[e]=[])).push(t),i.deferredEvents[e]&&(i.deferredEvents[e].forEach((function(e){t.apply(null,e)})),i.deferredEvents[e]=[])}))},t.prototype.off=function(e,t){var i=this;(Array.isArray(e)?e:[e]).forEach((function(e){var r=i.events[e];r&&r.splice(r.indexOf(t),1)}))},t.prototype.emit=function(e){for(var t=this,i=[],r=arguments.length-1;r-- >0;)i[r]=arguments[r+1];var n=this.activeEvents;!!n.hasOwnProperty(e)&&n[e]||(n[e]=!0,(this.events[e]||[]).forEach((function(e){return e.apply(t,i)})),n[e]=!1)},t.prototype.deferredEmit=function(e){for(var t,i=[],r=arguments.length-1;r-- >0;)i[r]=arguments[r+1];var n=this.deferredEvents;(t=this).emit.apply(t,[e].concat(i)),(n[e]||(n[e]=[])).push(i)},t.prototype.setOptions=function(e){this.setState(e)},t.prototype.resize=function(e){this.setOptions({width:e})},t.prototype.reset=function(){this.colors.forEach((function(e){return e.reset()})),this.setState({colors:this.colors})},t.prototype.onMount=function(e){this.el=e,this.deferredEmit("mount",this)},t.prototype.onColorChange=function(e,t){this.setState({color:this.color}),this.inputActive&&(this.inputActive=!1,this.emit("input:change",e,t)),this.emit("color:change",e,t)},t.prototype.emitInputEvent=function(e,t){0===e?this.emit("input:start",this.color,t):1===e?this.emit("input:move",this.color,t):2===e&&this.emit("input:end",this.color,t)},t.prototype.render=function(e,t){var i=this,r=t.layout;return Array.isArray(r)||(r=[{component:Se},{component:Ee}],t.transparency&&r.push({component:Ee,options:{sliderType:"alpha"}})),p("div",{class:"IroColorPicker",id:t.id,style:{display:t.display}},r.map((function(e,r){var n=e.component,s=e.options;return p(n,Object.assign({},t,s,{ref:void 0,onInput:i.emitInputEvent.bind(i),parent:i,index:r}))})))},t}(g);ke.defaultProps=Object.assign({},{width:300,height:300,color:"#fff",colors:[],padding:6,layoutDirection:"vertical",borderColor:"#fff",borderWidth:0,handleRadius:8,activeHandleRadius:null,handleSvg:null,handleProps:{x:0,y:0},wheelLightness:!0,wheelAngle:0,wheelDirection:"anticlockwise",sliderSize:null,sliderMargin:12,boxHeight:null},{colors:[],display:"block",id:null,layout:"default",margin:null});var xe,Ce,Ae,Re=(Ce=function(e,t){var i,n=document.createElement("div");function s(){var t=e instanceof Element?e:document.querySelector(e);t.appendChild(i.base),i.onMount(t)}return function(e,t,i){var n,s,o;r.__p&&r.__p(e,t),s=(n=i===a)?null:i&&i.__k||t.__k,e=p(m,null,[e]),o=[],x(t,n?t.__k=e:(i||t).__k=e,s||l,l,void 0!==t.ownerSVGElement,i&&!n?[i]:s?null:c.slice.call(t.childNodes),o,!1,i||l,n),C(o,e)}(p(xe,Object.assign({},{ref:function(e){return i=e}},t)),n),"loading"!==document.readyState?s():document.addEventListener("DOMContentLoaded",s),i},Ce.prototype=(xe=ke).prototype,Object.assign(Ce,xe),Ce.__component=xe,Ce);!function(e){e.version="5.5.2",e.Color=te,e.ColorPicker=Re,function(e){e.h=p,e.ComponentBase=we,e.Handle=_e,e.Slider=Ee,e.Wheel=Se,e.Box=Te}(e.ui||(e.ui={}))}(Ae||(Ae={}));const Le=Ae},705:(e,t,i)=>{"use strict";i.d(t,{A:()=>qi});var r,n,s,o,a=!1,l=!1,c=[],u=-1;function d(e){!function(e){c.includes(e)||c.push(e);l||a||(a=!0,queueMicrotask(p))}(e)}function h(e){let t=c.indexOf(e);-1!==t&&t>u&&c.splice(t,1)}function p(){a=!1,l=!0;for(let e=0;e<c.length;e++)c[e](),u=e;c.length=0,u=-1,l=!1}var f=!0;function m(e){n=e}function g(e,t){let i,r=!0,o=n((()=>{let n=e();JSON.stringify(n),r?i=n:queueMicrotask((()=>{t(n,i),i=n})),r=!1}));return()=>s(o)}function y(e,t,i={}){e.dispatchEvent(new CustomEvent(t,{detail:i,bubbles:!0,composed:!0,cancelable:!0}))}function v(e,t){if("function"==typeof ShadowRoot&&e instanceof ShadowRoot)return void Array.from(e.children).forEach((e=>v(e,t)));let i=!1;if(t(e,(()=>i=!0)),i)return;let r=e.firstElementChild;for(;r;)v(r,t),r=r.nextElementSibling}function b(e,...t){console.warn(`Alpine Warning: ${e}`,...t)}var w=!1;var _=[],E=[];function T(){return _.map((e=>e()))}function S(){return _.concat(E).map((e=>e()))}function k(e){_.push(e)}function x(e){E.push(e)}function C(e,t=!1){return A(e,(e=>{if((t?S():T()).some((t=>e.matches(t))))return!0}))}function A(e,t){if(e){if(t(e))return e;if(e._x_teleportBack&&(e=e._x_teleportBack),e.parentElement)return A(e.parentElement,t)}}var R=[];function L(e,t=v,i=(()=>{})){!function(e){Ee=!0;let t=Symbol();Se=t,Te.set(t,[]);let i=()=>{for(;Te.get(t).length;)Te.get(t).shift()();Te.delete(t)},r=()=>{Ee=!1,i()};e(i),r()}((()=>{t(e,((e,t)=>{i(e,t),R.forEach((i=>i(e,t))),we(e,e.attributes).forEach((e=>e())),e._x_ignore&&t()}))}))}function P(e,t=v){t(e,(e=>{j(e),function(e){if(e._x_cleanups)for(;e._x_cleanups.length;)e._x_cleanups.pop()()}(e)}))}var O=[],D=[],I=[];function M(e,t){"function"==typeof t?(e._x_cleanups||(e._x_cleanups=[]),e._x_cleanups.push(t)):(t=e,D.push(t))}function F(e){O.push(e)}function N(e,t,i){e._x_attributeCleanups||(e._x_attributeCleanups={}),e._x_attributeCleanups[t]||(e._x_attributeCleanups[t]=[]),e._x_attributeCleanups[t].push(i)}function j(e,t){e._x_attributeCleanups&&Object.entries(e._x_attributeCleanups).forEach((([i,r])=>{(void 0===t||t.includes(i))&&(r.forEach((e=>e())),delete e._x_attributeCleanups[i])}))}var B=new MutationObserver(q),U=!1;function z(){B.observe(document,{subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0}),U=!0}function $(){!function(){let e=B.takeRecords();H.push((()=>e.length>0&&q(e)));let t=H.length;queueMicrotask((()=>{if(H.length===t)for(;H.length>0;)H.shift()()}))}(),B.disconnect(),U=!1}var H=[];function V(e){if(!U)return e();$();let t=e();return z(),t}var G=!1,K=[];function q(e){if(G)return void(K=K.concat(e));let t=new Set,i=new Set,r=new Map,n=new Map;for(let s=0;s<e.length;s++)if(!e[s].target._x_ignoreMutationObserver&&("childList"===e[s].type&&(e[s].addedNodes.forEach((e=>1===e.nodeType&&t.add(e))),e[s].removedNodes.forEach((e=>1===e.nodeType&&i.add(e)))),"attributes"===e[s].type)){let t=e[s].target,i=e[s].attributeName,o=e[s].oldValue,a=()=>{r.has(t)||r.set(t,[]),r.get(t).push({name:i,value:t.getAttribute(i)})},l=()=>{n.has(t)||n.set(t,[]),n.get(t).push(i)};t.hasAttribute(i)&&null===o?a():t.hasAttribute(i)?(l(),a()):l()}n.forEach(((e,t)=>{j(t,e)})),r.forEach(((e,t)=>{O.forEach((i=>i(t,e)))}));for(let e of i)t.has(e)||(D.forEach((t=>t(e))),P(e));t.forEach((e=>{e._x_ignoreSelf=!0,e._x_ignore=!0}));for(let e of t)i.has(e)||e.isConnected&&(delete e._x_ignoreSelf,delete e._x_ignore,I.forEach((t=>t(e))),e._x_ignore=!0,e._x_ignoreSelf=!0);t.forEach((e=>{delete e._x_ignoreSelf,delete e._x_ignore})),t=null,i=null,r=null,n=null}function W(e){return Q(X(e))}function Y(e,t,i){return e._x_dataStack=[t,...X(i||e)],()=>{e._x_dataStack=e._x_dataStack.filter((e=>e!==t))}}function X(e){return e._x_dataStack?e._x_dataStack:"function"==typeof ShadowRoot&&e instanceof ShadowRoot?X(e.host):e.parentNode?X(e.parentNode):[]}function Q(e){return new Proxy({objects:e},J)}var J={ownKeys:({objects:e})=>Array.from(new Set(e.flatMap((e=>Object.keys(e))))),has:({objects:e},t)=>t!=Symbol.unscopables&&e.some((e=>Object.prototype.hasOwnProperty.call(e,t)||Reflect.has(e,t))),get:({objects:e},t,i)=>"toJSON"==t?Z:Reflect.get(e.find((e=>Reflect.has(e,t)))||{},t,i),set({objects:e},t,i,r){const n=e.find((e=>Object.prototype.hasOwnProperty.call(e,t)))||e[e.length-1],s=Object.getOwnPropertyDescriptor(n,t);return s?.set&&s?.get?Reflect.set(n,t,i,r):Reflect.set(n,t,i)}};function Z(){return Reflect.ownKeys(this).reduce(((e,t)=>(e[t]=Reflect.get(this,t),e)),{})}function ee(e){let t=(i,r="")=>{Object.entries(Object.getOwnPropertyDescriptors(i)).forEach((([n,{value:s,enumerable:o}])=>{if(!1===o||void 0===s)return;if("object"==typeof s&&null!==s&&s.__v_skip)return;let a=""===r?n:`${r}.${n}`;var l;"object"==typeof s&&null!==s&&s._x_interceptor?i[n]=s.initialize(e,a,n):"object"!=typeof(l=s)||Array.isArray(l)||null===l||s===i||s instanceof Element||t(s,a)}))};return t(e)}function te(e,t=(()=>{})){let i={initialValue:void 0,_x_interceptor:!0,initialize(t,i,r){return e(this.initialValue,(()=>function(e,t){return t.split(".").reduce(((e,t)=>e[t]),e)}(t,i)),(e=>ie(t,i,e)),i,r)}};return t(i),e=>{if("object"==typeof e&&null!==e&&e._x_interceptor){let t=i.initialize.bind(i);i.initialize=(r,n,s)=>{let o=e.initialize(r,n,s);return i.initialValue=o,t(r,n,s)}}else i.initialValue=e;return i}}function ie(e,t,i){if("string"==typeof t&&(t=t.split(".")),1!==t.length){if(0===t.length)throw error;return e[t[0]]||(e[t[0]]={}),ie(e[t[0]],t.slice(1),i)}e[t[0]]=i}var re={};function ne(e,t){re[e]=t}function se(e,t){return Object.entries(re).forEach((([i,r])=>{let n=null;Object.defineProperty(e,`$${i}`,{get:()=>r(t,function(){if(n)return n;{let[e,i]=ke(t);return n={interceptor:te,...e},M(t,i),n}}()),enumerable:!1})})),e}function oe(e,t,i,...r){try{return i(...r)}catch(i){ae(i,e,t)}}function ae(e,t,i=void 0){e=Object.assign(e??{message:"No error message given."},{el:t,expression:i}),console.warn(`Alpine Expression Error: ${e.message}\n\n${i?'Expression: "'+i+'"\n\n':""}`,t),setTimeout((()=>{throw e}),0)}var le=!0;function ce(e){let t=le;le=!1;let i=e();return le=t,i}function ue(e,t,i={}){let r;return de(e,t)((e=>r=e),i),r}function de(...e){return he(...e)}var he=pe;function pe(e,t){let i={};se(i,e);let r=[i,...X(e)],n="function"==typeof t?function(e,t){return(i=(()=>{}),{scope:r={},params:n=[]}={})=>{me(i,t.apply(Q([r,...e]),n))}}(r,t):function(e,t,i){let r=function(e,t){if(fe[e])return fe[e];let i=Object.getPrototypeOf((async function(){})).constructor,r=/^[\n\s]*if.*\(.*\)/.test(e.trim())||/^(let|const)\s/.test(e.trim())?`(async()=>{ ${e} })()`:e;const n=()=>{try{let t=new i(["__self","scope"],`with (scope) { __self.result = ${r} }; __self.finished = true; return __self.result;`);return Object.defineProperty(t,"name",{value:`[Alpine] ${e}`}),t}catch(i){return ae(i,t,e),Promise.resolve()}};let s=n();return fe[e]=s,s}(t,i);return(n=(()=>{}),{scope:s={},params:o=[]}={})=>{r.result=void 0,r.finished=!1;let a=Q([s,...e]);if("function"==typeof r){let e=r(r,a).catch((e=>ae(e,i,t)));r.finished?(me(n,r.result,a,o,i),r.result=void 0):e.then((e=>{me(n,e,a,o,i)})).catch((e=>ae(e,i,t))).finally((()=>r.result=void 0))}}}(r,t,e);return oe.bind(null,e,t,n)}var fe={};function me(e,t,i,r,n){if(le&&"function"==typeof t){let s=t.apply(i,r);s instanceof Promise?s.then((t=>me(e,t,i,r))).catch((e=>ae(e,n,t))):e(s)}else"object"==typeof t&&t instanceof Promise?t.then((t=>e(t))):e(t)}var ge="x-";function ye(e=""){return ge+e}var ve={};function be(e,t){return ve[e]=t,{before(t){if(!ve[t])return void console.warn(String.raw`Cannot find directive \`${t}\`. \`${e}\` will use the default order of execution`);const i=De.indexOf(t);De.splice(i>=0?i:De.indexOf("DEFAULT"),0,e)}}}function we(e,t,i){if(t=Array.from(t),e._x_virtualDirectives){let i=Object.entries(e._x_virtualDirectives).map((([e,t])=>({name:e,value:t}))),r=_e(i);i=i.map((e=>r.find((t=>t.name===e.name))?{name:`x-bind:${e.name}`,value:`"${e.value}"`}:e)),t=t.concat(i)}let r={},n=t.map(Ce(((e,t)=>r[e]=t))).filter(Le).map(function(e,t){return({name:i,value:r})=>{let n=i.match(Pe()),s=i.match(/:([a-zA-Z0-9\-_:]+)/),o=i.match(/\.[^.\]]+(?=[^\]]*$)/g)||[],a=t||e[i]||i;return{type:n?n[1]:null,value:s?s[1]:null,modifiers:o.map((e=>e.replace(".",""))),expression:r,original:a}}}(r,i)).sort(Ie);return n.map((t=>function(e,t){let i=()=>{},r=ve[t.type]||i,[n,s]=ke(e);N(e,t.original,s);let o=()=>{e._x_ignore||e._x_ignoreSelf||(r.inline&&r.inline(e,t,n),r=r.bind(r,e,t,n),Ee?Te.get(Se).push(r):r())};return o.runCleanups=s,o}(e,t)))}function _e(e){return Array.from(e).map(Ce()).filter((e=>!Le(e)))}var Ee=!1,Te=new Map,Se=Symbol();function ke(e){let t=[],[i,r]=function(e){let t=()=>{};return[i=>{let r=n(i);return e._x_effects||(e._x_effects=new Set,e._x_runEffects=()=>{e._x_effects.forEach((e=>e()))}),e._x_effects.add(r),t=()=>{void 0!==r&&(e._x_effects.delete(r),s(r))},r},()=>{t()}]}(e);t.push(r);return[{Alpine:ft,effect:i,cleanup:e=>t.push(e),evaluateLater:de.bind(de,e),evaluate:ue.bind(ue,e)},()=>t.forEach((e=>e()))]}var xe=(e,t)=>({name:i,value:r})=>(i.startsWith(e)&&(i=i.replace(e,t)),{name:i,value:r});function Ce(e=(()=>{})){return({name:t,value:i})=>{let{name:r,value:n}=Ae.reduce(((e,t)=>t(e)),{name:t,value:i});return r!==t&&e(r,t),{name:r,value:n}}}var Ae=[];function Re(e){Ae.push(e)}function Le({name:e}){return Pe().test(e)}var Pe=()=>new RegExp(`^${ge}([^:^.]+)\\b`);var Oe="DEFAULT",De=["ignore","ref","data","id","anchor","bind","init","for","model","modelable","transition","show","if",Oe,"teleport"];function Ie(e,t){let i=-1===De.indexOf(e.type)?Oe:e.type,r=-1===De.indexOf(t.type)?Oe:t.type;return De.indexOf(i)-De.indexOf(r)}var Me=[],Fe=!1;function Ne(e=(()=>{})){return queueMicrotask((()=>{Fe||setTimeout((()=>{je()}))})),new Promise((t=>{Me.push((()=>{e(),t()}))}))}function je(){for(Fe=!1;Me.length;)Me.shift()()}function Be(e,t){return Array.isArray(t)?Ue(e,t.join(" ")):"object"==typeof t&&null!==t?function(e,t){let i=e=>e.split(" ").filter(Boolean),r=Object.entries(t).flatMap((([e,t])=>!!t&&i(e))).filter(Boolean),n=Object.entries(t).flatMap((([e,t])=>!t&&i(e))).filter(Boolean),s=[],o=[];return n.forEach((t=>{e.classList.contains(t)&&(e.classList.remove(t),o.push(t))})),r.forEach((t=>{e.classList.contains(t)||(e.classList.add(t),s.push(t))})),()=>{o.forEach((t=>e.classList.add(t))),s.forEach((t=>e.classList.remove(t)))}}(e,t):"function"==typeof t?Be(e,t()):Ue(e,t)}function Ue(e,t){return t=!0===t?t="":t||"",i=t.split(" ").filter((t=>!e.classList.contains(t))).filter(Boolean),e.classList.add(...i),()=>{e.classList.remove(...i)};var i}function ze(e,t){return"object"==typeof t&&null!==t?function(e,t){let i={};return Object.entries(t).forEach((([t,r])=>{i[t]=e.style[t],t.startsWith("--")||(t=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()),e.style.setProperty(t,r)})),setTimeout((()=>{0===e.style.length&&e.removeAttribute("style")})),()=>{ze(e,i)}}(e,t):function(e,t){let i=e.getAttribute("style",t);return e.setAttribute("style",t),()=>{e.setAttribute("style",i||"")}}(e,t)}function $e(e,t=(()=>{})){let i=!1;return function(){i?t.apply(this,arguments):(i=!0,e.apply(this,arguments))}}function He(e,t,i={}){e._x_transition||(e._x_transition={enter:{during:i,start:i,end:i},leave:{during:i,start:i,end:i},in(i=(()=>{}),r=(()=>{})){Ge(e,t,{during:this.enter.during,start:this.enter.start,end:this.enter.end},i,r)},out(i=(()=>{}),r=(()=>{})){Ge(e,t,{during:this.leave.during,start:this.leave.start,end:this.leave.end},i,r)}})}function Ve(e){let t=e.parentNode;if(t)return t._x_hidePromise?t:Ve(t)}function Ge(e,t,{during:i,start:r,end:n}={},s=(()=>{}),o=(()=>{})){if(e._x_transitioning&&e._x_transitioning.cancel(),0===Object.keys(i).length&&0===Object.keys(r).length&&0===Object.keys(n).length)return s(),void o();let a,l,c;!function(e,t){let i,r,n,s=$e((()=>{V((()=>{i=!0,r||t.before(),n||(t.end(),je()),t.after(),e.isConnected&&t.cleanup(),delete e._x_transitioning}))}));e._x_transitioning={beforeCancels:[],beforeCancel(e){this.beforeCancels.push(e)},cancel:$e((function(){for(;this.beforeCancels.length;)this.beforeCancels.shift()();s()})),finish:s},V((()=>{t.start(),t.during()})),Fe=!0,requestAnimationFrame((()=>{if(i)return;let s=1e3*Number(getComputedStyle(e).transitionDuration.replace(/,.*/,"").replace("s","")),o=1e3*Number(getComputedStyle(e).transitionDelay.replace(/,.*/,"").replace("s",""));0===s&&(s=1e3*Number(getComputedStyle(e).animationDuration.replace("s",""))),V((()=>{t.before()})),r=!0,requestAnimationFrame((()=>{i||(V((()=>{t.end()})),je(),setTimeout(e._x_transitioning.finish,s+o),n=!0)}))}))}(e,{start(){a=t(e,r)},during(){l=t(e,i)},before:s,end(){a(),c=t(e,n)},after:o,cleanup(){l(),c()}})}function Ke(e,t,i){if(-1===e.indexOf(t))return i;const r=e[e.indexOf(t)+1];if(!r)return i;if("scale"===t&&isNaN(r))return i;if("duration"===t||"delay"===t){let e=r.match(/([0-9]+)ms/);if(e)return e[1]}return"origin"===t&&["top","right","left","center","bottom"].includes(e[e.indexOf(t)+2])?[r,e[e.indexOf(t)+2]].join(" "):r}be("transition",((e,{value:t,modifiers:i,expression:r},{evaluate:n})=>{"function"==typeof r&&(r=n(r)),!1!==r&&(r&&"boolean"!=typeof r?function(e,t,i){He(e,Be,"");let r={enter:t=>{e._x_transition.enter.during=t},"enter-start":t=>{e._x_transition.enter.start=t},"enter-end":t=>{e._x_transition.enter.end=t},leave:t=>{e._x_transition.leave.during=t},"leave-start":t=>{e._x_transition.leave.start=t},"leave-end":t=>{e._x_transition.leave.end=t}};r[i](t)}(e,r,t):function(e,t,i){He(e,ze);let r=!t.includes("in")&&!t.includes("out")&&!i,n=r||t.includes("in")||["enter"].includes(i),s=r||t.includes("out")||["leave"].includes(i);t.includes("in")&&!r&&(t=t.filter(((e,i)=>i<t.indexOf("out"))));t.includes("out")&&!r&&(t=t.filter(((e,i)=>i>t.indexOf("out"))));let o=!t.includes("opacity")&&!t.includes("scale"),a=o||t.includes("opacity"),l=o||t.includes("scale"),c=a?0:1,u=l?Ke(t,"scale",95)/100:1,d=Ke(t,"delay",0)/1e3,h=Ke(t,"origin","center"),p="opacity, transform",f=Ke(t,"duration",150)/1e3,m=Ke(t,"duration",75)/1e3,g="cubic-bezier(0.4, 0.0, 0.2, 1)";n&&(e._x_transition.enter.during={transformOrigin:h,transitionDelay:`${d}s`,transitionProperty:p,transitionDuration:`${f}s`,transitionTimingFunction:g},e._x_transition.enter.start={opacity:c,transform:`scale(${u})`},e._x_transition.enter.end={opacity:1,transform:"scale(1)"});s&&(e._x_transition.leave.during={transformOrigin:h,transitionDelay:`${d}s`,transitionProperty:p,transitionDuration:`${m}s`,transitionTimingFunction:g},e._x_transition.leave.start={opacity:1,transform:"scale(1)"},e._x_transition.leave.end={opacity:c,transform:`scale(${u})`})}(e,i,t))})),window.Element.prototype._x_toggleAndCascadeWithTransitions=function(e,t,i,r){const n="visible"===document.visibilityState?requestAnimationFrame:setTimeout;let s=()=>n(i);t?e._x_transition&&(e._x_transition.enter||e._x_transition.leave)?e._x_transition.enter&&(Object.entries(e._x_transition.enter.during).length||Object.entries(e._x_transition.enter.start).length||Object.entries(e._x_transition.enter.end).length)?e._x_transition.in(i):s():e._x_transition?e._x_transition.in(i):s():(e._x_hidePromise=e._x_transition?new Promise(((t,i)=>{e._x_transition.out((()=>{}),(()=>t(r))),e._x_transitioning&&e._x_transitioning.beforeCancel((()=>i({isFromCancelledTransition:!0})))})):Promise.resolve(r),queueMicrotask((()=>{let t=Ve(e);t?(t._x_hideChildren||(t._x_hideChildren=[]),t._x_hideChildren.push(e)):n((()=>{let t=e=>{let i=Promise.all([e._x_hidePromise,...(e._x_hideChildren||[]).map(t)]).then((([e])=>e()));return delete e._x_hidePromise,delete e._x_hideChildren,i};t(e).catch((e=>{if(!e.isFromCancelledTransition)throw e}))}))})))};var qe=!1;function We(e,t=(()=>{})){return(...i)=>qe?t(...i):e(...i)}var Ye=[];function Xe(e){Ye.push(e)}var Qe=!1;function Je(e){let t=n;m(((e,i)=>{let r=t(e);return s(r),()=>{}})),e(),m(t)}function Ze(e,t,i,n=[]){switch(e._x_bindings||(e._x_bindings=r({})),e._x_bindings[t]=i,t=n.includes("camel")?t.toLowerCase().replace(/-(\w)/g,((e,t)=>t.toUpperCase())):t){case"value":!function(e,t){if("radio"===e.type)void 0===e.attributes.value&&(e.value=t),window.fromModel&&(e.checked="boolean"==typeof t?it(e.value)===t:tt(e.value,t));else if("checkbox"===e.type)Number.isInteger(t)?e.value=t:Array.isArray(t)||"boolean"==typeof t||[null,void 0].includes(t)?Array.isArray(t)?e.checked=t.some((t=>tt(t,e.value))):e.checked=!!t:e.value=String(t);else if("SELECT"===e.tagName)!function(e,t){const i=[].concat(t).map((e=>e+""));Array.from(e.options).forEach((e=>{e.selected=i.includes(e.value)}))}(e,t);else{if(e.value===t)return;e.value=void 0===t?"":t}}(e,i);break;case"style":!function(e,t){e._x_undoAddedStyles&&e._x_undoAddedStyles();e._x_undoAddedStyles=ze(e,t)}(e,i);break;case"class":!function(e,t){e._x_undoAddedClasses&&e._x_undoAddedClasses();e._x_undoAddedClasses=Be(e,t)}(e,i);break;case"selected":case"checked":!function(e,t,i){et(e,t,i),function(e,t,i){e[t]!==i&&(e[t]=i)}(e,t,i)}(e,t,i);break;default:et(e,t,i)}}function et(e,t,i){[null,void 0,!1].includes(i)&&function(e){return!["aria-pressed","aria-checked","aria-expanded","aria-selected"].includes(e)}(t)?e.removeAttribute(t):(rt(t)&&(i=t),function(e,t,i){e.getAttribute(t)!=i&&e.setAttribute(t,i)}(e,t,i))}function tt(e,t){return e==t}function it(e){return!![1,"1","true","on","yes",!0].includes(e)||![0,"0","false","off","no",!1].includes(e)&&(e?Boolean(e):null)}function rt(e){return["disabled","checked","required","readonly","hidden","open","selected","autofocus","itemscope","multiple","novalidate","allowfullscreen","allowpaymentrequest","formnovalidate","autoplay","controls","loop","muted","playsinline","default","ismap","reversed","async","defer","nomodule"].includes(e)}function nt(e,t,i){let r=e.getAttribute(t);return null===r?"function"==typeof i?i():i:""===r||(rt(t)?!![t,"true"].includes(r):r)}function st(e,t){var i;return function(){var r=this,n=arguments;clearTimeout(i),i=setTimeout((function(){i=null,e.apply(r,n)}),t)}}function ot(e,t){let i;return function(){let r=this,n=arguments;i||(e.apply(r,n),i=!0,setTimeout((()=>i=!1),t))}}function at({get:e,set:t},{get:i,set:r}){let o,a,l=!0,c=n((()=>{let n=e(),s=i();if(l)r(lt(n)),l=!1;else{let e=JSON.stringify(n),i=JSON.stringify(s);e!==o?r(lt(n)):e!==i&&t(lt(s))}o=JSON.stringify(e()),a=JSON.stringify(i())}));return()=>{s(c)}}function lt(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e}var ct={},ut=!1;var dt={};function ht(e,t,i){let r=[];for(;r.length;)r.pop()();let n=Object.entries(t).map((([e,t])=>({name:e,value:t}))),s=_e(n);return n=n.map((e=>s.find((t=>t.name===e.name))?{name:`x-bind:${e.name}`,value:`"${e.value}"`}:e)),we(e,n,i).map((e=>{r.push(e.runCleanups),e()})),()=>{for(;r.length;)r.pop()()}}var pt={};var ft={get reactive(){return r},get release(){return s},get effect(){return n},get raw(){return o},version:"3.13.7",flushAndStopDeferringMutations:function(){G=!1,q(K),K=[]},dontAutoEvaluateFunctions:ce,disableEffectScheduling:function(e){f=!1,e(),f=!0},startObservingMutations:z,stopObservingMutations:$,setReactivityEngine:function(e){r=e.reactive,s=e.release,n=t=>e.effect(t,{scheduler:e=>{f?d(e):e()}}),o=e.raw},onAttributeRemoved:N,onAttributesAdded:F,closestDataStack:X,skipDuringClone:We,onlyDuringClone:function(e){return(...t)=>qe&&e(...t)},addRootSelector:k,addInitSelector:x,interceptClone:Xe,addScopeToNode:Y,deferMutations:function(){G=!0},mapAttributes:Re,evaluateLater:de,interceptInit:function(e){R.push(e)},setEvaluator:function(e){he=e},mergeProxies:Q,extractProp:function(e,t,i,r=!0){if(e._x_bindings&&void 0!==e._x_bindings[t])return e._x_bindings[t];if(e._x_inlineBindings&&void 0!==e._x_inlineBindings[t]){let i=e._x_inlineBindings[t];return i.extract=r,ce((()=>ue(e,i.expression)))}return nt(e,t,i)},findClosest:A,onElRemoved:M,closestRoot:C,destroyTree:P,interceptor:te,transition:Ge,setStyles:ze,mutateDom:V,directive:be,entangle:at,throttle:ot,debounce:st,evaluate:ue,initTree:L,nextTick:Ne,prefixed:ye,prefix:function(e){ge=e},plugin:function(e){(Array.isArray(e)?e:[e]).forEach((e=>e(ft)))},magic:ne,store:function(e,t){if(ut||(ct=r(ct),ut=!0),void 0===t)return ct[e];ct[e]=t,"object"==typeof t&&null!==t&&t.hasOwnProperty("init")&&"function"==typeof t.init&&ct[e].init(),ee(ct[e])},start:function(){var e;w&&b("Alpine has already been initialized on this page. Calling Alpine.start() more than once can cause problems."),w=!0,document.body||b("Unable to initialize. Trying to load Alpine before `<body>` is available. Did you forget to add `defer` in Alpine's `<script>` tag?"),y(document,"alpine:init"),y(document,"alpine:initializing"),z(),e=e=>L(e,v),I.push(e),M((e=>P(e))),F(((e,t)=>{we(e,t).forEach((e=>e()))})),Array.from(document.querySelectorAll(S().join(","))).filter((e=>!C(e.parentElement,!0))).forEach((e=>{L(e)})),y(document,"alpine:initialized")},clone:function(e,t){t._x_dataStack||(t._x_dataStack=e._x_dataStack),qe=!0,Qe=!0,Je((()=>{!function(e){let t=!1;L(e,((e,i)=>{v(e,((e,r)=>{if(t&&function(e){return T().some((t=>e.matches(t)))}(e))return r();t=!0,i(e,r)}))}))}(t)})),qe=!1,Qe=!1},cloneNode:function(e,t){Ye.forEach((i=>i(e,t))),qe=!0,Je((()=>{L(t,((e,t)=>{t(e,(()=>{}))}))})),qe=!1},bound:function(e,t,i){return e._x_bindings&&void 0!==e._x_bindings[t]?e._x_bindings[t]:nt(e,t,i)},$data:W,watch:g,walk:v,data:function(e,t){pt[e]=t},bind:function(e,t){let i="function"!=typeof t?()=>t:t;return e instanceof Element?ht(e,i()):(dt[e]=i,()=>{})}};function mt(e,t){const i=Object.create(null),r=e.split(",");for(let e=0;e<r.length;e++)i[r[e]]=!0;return t?e=>!!i[e.toLowerCase()]:e=>!!i[e]}var gt,yt=Object.freeze({}),vt=(Object.freeze([]),Object.prototype.hasOwnProperty),bt=(e,t)=>vt.call(e,t),wt=Array.isArray,_t=e=>"[object Map]"===kt(e),Et=e=>"symbol"==typeof e,Tt=e=>null!==e&&"object"==typeof e,St=Object.prototype.toString,kt=e=>St.call(e),xt=e=>kt(e).slice(8,-1),Ct=e=>"string"==typeof e&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,At=e=>{const t=Object.create(null);return i=>t[i]||(t[i]=e(i))},Rt=/-(\w)/g,Lt=(At((e=>e.replace(Rt,((e,t)=>t?t.toUpperCase():"")))),/\B([A-Z])/g),Pt=(At((e=>e.replace(Lt,"-$1").toLowerCase())),At((e=>e.charAt(0).toUpperCase()+e.slice(1)))),Ot=(At((e=>e?`on${Pt(e)}`:"")),(e,t)=>e!==t&&(e==e||t==t)),Dt=new WeakMap,It=[],Mt=Symbol("iterate"),Ft=Symbol("Map key iterate");var Nt=0;function jt(e){const{deps:t}=e;if(t.length){for(let i=0;i<t.length;i++)t[i].delete(e);t.length=0}}var Bt=!0,Ut=[];function zt(){const e=Ut.pop();Bt=void 0===e||e}function $t(e,t,i){if(!Bt||void 0===gt)return;let r=Dt.get(e);r||Dt.set(e,r=new Map);let n=r.get(i);n||r.set(i,n=new Set),n.has(gt)||(n.add(gt),gt.deps.push(n),gt.options.onTrack&&gt.options.onTrack({effect:gt,target:e,type:t,key:i}))}function Ht(e,t,i,r,n,s){const o=Dt.get(e);if(!o)return;const a=new Set,l=e=>{e&&e.forEach((e=>{(e!==gt||e.allowRecurse)&&a.add(e)}))};if("clear"===t)o.forEach(l);else if("length"===i&&wt(e))o.forEach(((e,t)=>{("length"===t||t>=r)&&l(e)}));else switch(void 0!==i&&l(o.get(i)),t){case"add":wt(e)?Ct(i)&&l(o.get("length")):(l(o.get(Mt)),_t(e)&&l(o.get(Ft)));break;case"delete":wt(e)||(l(o.get(Mt)),_t(e)&&l(o.get(Ft)));break;case"set":_t(e)&&l(o.get(Mt))}a.forEach((o=>{o.options.onTrigger&&o.options.onTrigger({effect:o,target:e,key:i,type:t,newValue:r,oldValue:n,oldTarget:s}),o.options.scheduler?o.options.scheduler(o):o()}))}var Vt=mt("__proto__,__v_isRef,__isVue"),Gt=new Set(Object.getOwnPropertyNames(Symbol).map((e=>Symbol[e])).filter(Et)),Kt=Xt(),qt=Xt(!0),Wt=Yt();function Yt(){const e={};return["includes","indexOf","lastIndexOf"].forEach((t=>{e[t]=function(...e){const i=Li(this);for(let e=0,t=this.length;e<t;e++)$t(i,"get",e+"");const r=i[t](...e);return-1===r||!1===r?i[t](...e.map(Li)):r}})),["push","pop","shift","unshift","splice"].forEach((t=>{e[t]=function(...e){Ut.push(Bt),Bt=!1;const i=Li(this)[t].apply(this,e);return zt(),i}})),e}function Xt(e=!1,t=!1){return function(i,r,n){if("__v_isReactive"===r)return!e;if("__v_isReadonly"===r)return e;if("__v_raw"===r&&n===(e?t?xi:ki:t?Si:Ti).get(i))return i;const s=wt(i);if(!e&&s&&bt(Wt,r))return Reflect.get(Wt,r,n);const o=Reflect.get(i,r,n);if(Et(r)?Gt.has(r):Vt(r))return o;if(e||$t(i,"get",r),t)return o;if(Pi(o)){return!s||!Ct(r)?o.value:o}return Tt(o)?e?Ai(o):Ci(o):o}}function Qt(e=!1){return function(t,i,r,n){let s=t[i];if(!e&&(r=Li(r),s=Li(s),!wt(t)&&Pi(s)&&!Pi(r)))return s.value=r,!0;const o=wt(t)&&Ct(i)?Number(i)<t.length:bt(t,i),a=Reflect.set(t,i,r,n);return t===Li(n)&&(o?Ot(r,s)&&Ht(t,"set",i,r,s):Ht(t,"add",i,r)),a}}var Jt={get:Kt,set:Qt(),deleteProperty:function(e,t){const i=bt(e,t),r=e[t],n=Reflect.deleteProperty(e,t);return n&&i&&Ht(e,"delete",t,void 0,r),n},has:function(e,t){const i=Reflect.has(e,t);return Et(t)&&Gt.has(t)||$t(e,"has",t),i},ownKeys:function(e){return $t(e,"iterate",wt(e)?"length":Mt),Reflect.ownKeys(e)}},Zt={get:qt,set:(e,t)=>(console.warn(`Set operation on key "${String(t)}" failed: target is readonly.`,e),!0),deleteProperty:(e,t)=>(console.warn(`Delete operation on key "${String(t)}" failed: target is readonly.`,e),!0)},ei=e=>Tt(e)?Ci(e):e,ti=e=>Tt(e)?Ai(e):e,ii=e=>e,ri=e=>Reflect.getPrototypeOf(e);function ni(e,t,i=!1,r=!1){const n=Li(e=e.__v_raw),s=Li(t);t!==s&&!i&&$t(n,"get",t),!i&&$t(n,"get",s);const{has:o}=ri(n),a=r?ii:i?ti:ei;return o.call(n,t)?a(e.get(t)):o.call(n,s)?a(e.get(s)):void(e!==n&&e.get(t))}function si(e,t=!1){const i=this.__v_raw,r=Li(i),n=Li(e);return e!==n&&!t&&$t(r,"has",e),!t&&$t(r,"has",n),e===n?i.has(e):i.has(e)||i.has(n)}function oi(e,t=!1){return e=e.__v_raw,!t&&$t(Li(e),"iterate",Mt),Reflect.get(e,"size",e)}function ai(e){e=Li(e);const t=Li(this);return ri(t).has.call(t,e)||(t.add(e),Ht(t,"add",e,e)),this}function li(e,t){t=Li(t);const i=Li(this),{has:r,get:n}=ri(i);let s=r.call(i,e);s?Ei(i,r,e):(e=Li(e),s=r.call(i,e));const o=n.call(i,e);return i.set(e,t),s?Ot(t,o)&&Ht(i,"set",e,t,o):Ht(i,"add",e,t),this}function ci(e){const t=Li(this),{has:i,get:r}=ri(t);let n=i.call(t,e);n?Ei(t,i,e):(e=Li(e),n=i.call(t,e));const s=r?r.call(t,e):void 0,o=t.delete(e);return n&&Ht(t,"delete",e,void 0,s),o}function ui(){const e=Li(this),t=0!==e.size,i=_t(e)?new Map(e):new Set(e),r=e.clear();return t&&Ht(e,"clear",void 0,void 0,i),r}function di(e,t){return function(i,r){const n=this,s=n.__v_raw,o=Li(s),a=t?ii:e?ti:ei;return!e&&$t(o,"iterate",Mt),s.forEach(((e,t)=>i.call(r,a(e),a(t),n)))}}function hi(e,t,i){return function(...r){const n=this.__v_raw,s=Li(n),o=_t(s),a="entries"===e||e===Symbol.iterator&&o,l="keys"===e&&o,c=n[e](...r),u=i?ii:t?ti:ei;return!t&&$t(s,"iterate",l?Ft:Mt),{next(){const{value:e,done:t}=c.next();return t?{value:e,done:t}:{value:a?[u(e[0]),u(e[1])]:u(e),done:t}},[Symbol.iterator](){return this}}}}function pi(e){return function(...t){{const i=t[0]?`on key "${t[0]}" `:"";console.warn(`${Pt(e)} operation ${i}failed: target is readonly.`,Li(this))}return"delete"!==e&&this}}function fi(){const e={get(e){return ni(this,e)},get size(){return oi(this)},has:si,add:ai,set:li,delete:ci,clear:ui,forEach:di(!1,!1)},t={get(e){return ni(this,e,!1,!0)},get size(){return oi(this)},has:si,add:ai,set:li,delete:ci,clear:ui,forEach:di(!1,!0)},i={get(e){return ni(this,e,!0)},get size(){return oi(this,!0)},has(e){return si.call(this,e,!0)},add:pi("add"),set:pi("set"),delete:pi("delete"),clear:pi("clear"),forEach:di(!0,!1)},r={get(e){return ni(this,e,!0,!0)},get size(){return oi(this,!0)},has(e){return si.call(this,e,!0)},add:pi("add"),set:pi("set"),delete:pi("delete"),clear:pi("clear"),forEach:di(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach((n=>{e[n]=hi(n,!1,!1),i[n]=hi(n,!0,!1),t[n]=hi(n,!1,!0),r[n]=hi(n,!0,!0)})),[e,i,t,r]}var[mi,gi,yi,vi]=fi();function bi(e,t){const i=t?e?vi:yi:e?gi:mi;return(t,r,n)=>"__v_isReactive"===r?!e:"__v_isReadonly"===r?e:"__v_raw"===r?t:Reflect.get(bt(i,r)&&r in t?i:t,r,n)}var wi={get:bi(!1,!1)},_i={get:bi(!0,!1)};function Ei(e,t,i){const r=Li(i);if(r!==i&&t.call(e,r)){const t=xt(e);console.warn(`Reactive ${t} contains both the raw and reactive versions of the same object${"Map"===t?" as keys":""}, which can lead to inconsistencies. Avoid differentiating between the raw and reactive versions of an object and only use the reactive version if possible.`)}}var Ti=new WeakMap,Si=new WeakMap,ki=new WeakMap,xi=new WeakMap;function Ci(e){return e&&e.__v_isReadonly?e:Ri(e,!1,Jt,wi,Ti)}function Ai(e){return Ri(e,!0,Zt,_i,ki)}function Ri(e,t,i,r,n){if(!Tt(e))return console.warn(`value cannot be made reactive: ${String(e)}`),e;if(e.__v_raw&&(!t||!e.__v_isReactive))return e;const s=n.get(e);if(s)return s;const o=(a=e).__v_skip||!Object.isExtensible(a)?0:function(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}(xt(a));var a;if(0===o)return e;const l=new Proxy(e,2===o?r:i);return n.set(e,l),l}function Li(e){return e&&Li(e.__v_raw)||e}function Pi(e){return Boolean(e&&!0===e.__v_isRef)}ne("nextTick",(()=>Ne)),ne("dispatch",(e=>y.bind(y,e))),ne("watch",((e,{evaluateLater:t,cleanup:i})=>(e,r)=>{let n=t(e),s=g((()=>{let e;return n((t=>e=t)),e}),r);i(s)})),ne("store",(function(){return ct})),ne("data",(e=>W(e))),ne("root",(e=>C(e))),ne("refs",(e=>(e._x_refs_proxy||(e._x_refs_proxy=Q(function(e){let t=[];return A(e,(e=>{e._x_refs&&t.push(e._x_refs)})),t}(e))),e._x_refs_proxy)));var Oi={};function Di(e){return Oi[e]||(Oi[e]=0),++Oi[e]}function Ii(e,t,i){ne(t,(r=>b(`You can't use [$${t}] without first installing the "${e}" plugin here: https://alpinejs.dev/plugins/${i}`,r)))}ne("id",((e,{cleanup:t})=>(i,r=null)=>function(e,t,i,r){e._x_id||(e._x_id={});if(e._x_id[t])return e._x_id[t];let n=r();return e._x_id[t]=n,i((()=>{delete e._x_id[t]})),n}(e,`${i}${r?`-${r}`:""}`,t,(()=>{let t=function(e,t){return A(e,(e=>{if(e._x_ids&&e._x_ids[t])return!0}))}(e,i),n=t?t._x_ids[i]:Di(i);return r?`${i}-${n}-${r}`:`${i}-${n}`})))),Xe(((e,t)=>{e._x_id&&(t._x_id=e._x_id)})),ne("el",(e=>e)),Ii("Focus","focus","focus"),Ii("Persist","persist","persist"),be("modelable",((e,{expression:t},{effect:i,evaluateLater:r,cleanup:n})=>{let s=r(t),o=()=>{let e;return s((t=>e=t)),e},a=r(`${t} = __placeholder`),l=e=>a((()=>{}),{scope:{__placeholder:e}}),c=o();l(c),queueMicrotask((()=>{if(!e._x_model)return;e._x_removeModelListeners.default();let t=e._x_model.get,i=e._x_model.set,r=at({get:()=>t(),set(e){i(e)}},{get:()=>o(),set(e){l(e)}});n(r)}))})),be("teleport",((e,{modifiers:t,expression:i},{cleanup:r})=>{"template"!==e.tagName.toLowerCase()&&b("x-teleport can only be used on a <template> tag",e);let n=Fi(i),s=e.content.cloneNode(!0).firstElementChild;e._x_teleport=s,s._x_teleportBack=e,e.setAttribute("data-teleport-template",!0),s.setAttribute("data-teleport-target",!0),e._x_forwardEvents&&e._x_forwardEvents.forEach((t=>{s.addEventListener(t,(t=>{t.stopPropagation(),e.dispatchEvent(new t.constructor(t.type,t))}))})),Y(s,{},e);let o=(e,t,i)=>{i.includes("prepend")?t.parentNode.insertBefore(e,t):i.includes("append")?t.parentNode.insertBefore(e,t.nextSibling):t.appendChild(e)};V((()=>{o(s,n,t),L(s),s._x_ignore=!0})),e._x_teleportPutBack=()=>{let r=Fi(i);V((()=>{o(e._x_teleport,r,t)}))},r((()=>s.remove()))}));var Mi=document.createElement("div");function Fi(e){let t=We((()=>document.querySelector(e)),(()=>Mi))();return t||b(`Cannot find x-teleport element for selector: "${e}"`),t}var Ni=()=>{};function ji(e,t,i,r){let n=e,s=e=>r(e),o={},a=(e,t)=>i=>t(e,i);if(i.includes("dot")&&(t=t.replace(/-/g,".")),i.includes("camel")&&(t=function(e){return e.toLowerCase().replace(/-(\w)/g,((e,t)=>t.toUpperCase()))}(t)),i.includes("passive")&&(o.passive=!0),i.includes("capture")&&(o.capture=!0),i.includes("window")&&(n=window),i.includes("document")&&(n=document),i.includes("debounce")){let e=i[i.indexOf("debounce")+1]||"invalid-wait",t=Bi(e.split("ms")[0])?Number(e.split("ms")[0]):250;s=st(s,t)}if(i.includes("throttle")){let e=i[i.indexOf("throttle")+1]||"invalid-wait",t=Bi(e.split("ms")[0])?Number(e.split("ms")[0]):250;s=ot(s,t)}return i.includes("prevent")&&(s=a(s,((e,t)=>{t.preventDefault(),e(t)}))),i.includes("stop")&&(s=a(s,((e,t)=>{t.stopPropagation(),e(t)}))),i.includes("self")&&(s=a(s,((t,i)=>{i.target===e&&t(i)}))),(i.includes("away")||i.includes("outside"))&&(n=document,s=a(s,((t,i)=>{e.contains(i.target)||!1!==i.target.isConnected&&(e.offsetWidth<1&&e.offsetHeight<1||!1!==e._x_isShown&&t(i))}))),i.includes("once")&&(s=a(s,((e,i)=>{e(i),n.removeEventListener(t,s,o)}))),s=a(s,((e,r)=>{(function(e){return["keydown","keyup"].includes(e)})(t)&&function(e,t){let i=t.filter((e=>!["window","document","prevent","stop","once","capture"].includes(e)));if(i.includes("debounce")){let e=i.indexOf("debounce");i.splice(e,Bi((i[e+1]||"invalid-wait").split("ms")[0])?2:1)}if(i.includes("throttle")){let e=i.indexOf("throttle");i.splice(e,Bi((i[e+1]||"invalid-wait").split("ms")[0])?2:1)}if(0===i.length)return!1;if(1===i.length&&Ui(e.key).includes(i[0]))return!1;const r=["ctrl","shift","alt","meta","cmd","super"].filter((e=>i.includes(e)));if(i=i.filter((e=>!r.includes(e))),r.length>0){if(r.filter((t=>("cmd"!==t&&"super"!==t||(t="meta"),e[`${t}Key`]))).length===r.length&&Ui(e.key).includes(i[0]))return!1}return!0}(r,i)||e(r)})),n.addEventListener(t,s,o),()=>{n.removeEventListener(t,s,o)}}function Bi(e){return!Array.isArray(e)&&!isNaN(e)}function Ui(e){if(!e)return[];var t;e=[" ","_"].includes(t=e)?t:t.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[_\s]/,"-").toLowerCase();let i={ctrl:"control",slash:"/",space:" ",spacebar:" ",cmd:"meta",esc:"escape",up:"arrow-up",down:"arrow-down",left:"arrow-left",right:"arrow-right",period:".",equal:"=",minus:"-",underscore:"_"};return i[e]=e,Object.keys(i).map((t=>{if(i[t]===e)return t})).filter((e=>e))}function zi(e){let t=e?parseFloat(e):null;return i=t,Array.isArray(i)||isNaN(i)?e:t;var i}function $i(e){return null!==e&&"object"==typeof e&&"function"==typeof e.get&&"function"==typeof e.set}Ni.inline=(e,{modifiers:t},{cleanup:i})=>{t.includes("self")?e._x_ignoreSelf=!0:e._x_ignore=!0,i((()=>{t.includes("self")?delete e._x_ignoreSelf:delete e._x_ignore}))},be("ignore",Ni),be("effect",We(((e,{expression:t},{effect:i})=>{i(de(e,t))}))),be("model",((e,{modifiers:t,expression:i},{effect:r,cleanup:n})=>{let s=e;t.includes("parent")&&(s=e.parentNode);let o,a=de(s,i);o="string"==typeof i?de(s,`${i} = __placeholder`):"function"==typeof i&&"string"==typeof i()?de(s,`${i()} = __placeholder`):()=>{};let l=()=>{let e;return a((t=>e=t)),$i(e)?e.get():e},c=e=>{let t;a((e=>t=e)),$i(t)?t.set(e):o((()=>{}),{scope:{__placeholder:e}})};"string"==typeof i&&"radio"===e.type&&V((()=>{e.hasAttribute("name")||e.setAttribute("name",i)}));var u="select"===e.tagName.toLowerCase()||["checkbox","radio"].includes(e.type)||t.includes("lazy")?"change":"input";let d=qe?()=>{}:ji(e,u,t,(i=>{c(function(e,t,i,r){return V((()=>{if(i instanceof CustomEvent&&void 0!==i.detail)return null!==i.detail&&void 0!==i.detail?i.detail:i.target.value;if("checkbox"===e.type){if(Array.isArray(r)){let e=null;return e=t.includes("number")?zi(i.target.value):t.includes("boolean")?it(i.target.value):i.target.value,i.target.checked?r.concat([e]):r.filter((t=>!(t==e)))}return i.target.checked}return"select"===e.tagName.toLowerCase()&&e.multiple?t.includes("number")?Array.from(i.target.selectedOptions).map((e=>zi(e.value||e.text))):t.includes("boolean")?Array.from(i.target.selectedOptions).map((e=>it(e.value||e.text))):Array.from(i.target.selectedOptions).map((e=>e.value||e.text)):t.includes("number")?zi(i.target.value):t.includes("boolean")?it(i.target.value):t.includes("trim")?i.target.value.trim():i.target.value}))}(e,t,i,l()))}));if(t.includes("fill")&&([void 0,null,""].includes(l())||"checkbox"===e.type&&Array.isArray(l()))&&e.dispatchEvent(new Event(u,{})),e._x_removeModelListeners||(e._x_removeModelListeners={}),e._x_removeModelListeners.default=d,n((()=>e._x_removeModelListeners.default())),e.form){let t=ji(e.form,"reset",[],(t=>{Ne((()=>e._x_model&&e._x_model.set(e.value)))}));n((()=>t()))}e._x_model={get:()=>l(),set(e){c(e)}},e._x_forceModelUpdate=t=>{void 0===t&&"string"==typeof i&&i.match(/\./)&&(t=""),window.fromModel=!0,V((()=>Ze(e,"value",t))),delete window.fromModel},r((()=>{let i=l();t.includes("unintrusive")&&document.activeElement.isSameNode(e)||e._x_forceModelUpdate(i)}))})),be("cloak",(e=>queueMicrotask((()=>V((()=>e.removeAttribute(ye("cloak")))))))),x((()=>`[${ye("init")}]`)),be("init",We(((e,{expression:t},{evaluate:i})=>"string"==typeof t?!!t.trim()&&i(t,{},!1):i(t,{},!1)))),be("text",((e,{expression:t},{effect:i,evaluateLater:r})=>{let n=r(t);i((()=>{n((t=>{V((()=>{e.textContent=t}))}))}))})),be("html",((e,{expression:t},{effect:i,evaluateLater:r})=>{let n=r(t);i((()=>{n((t=>{V((()=>{e.innerHTML=t,e._x_ignoreSelf=!0,L(e),delete e._x_ignoreSelf}))}))}))})),Re(xe(":",ye("bind:")));var Hi=(e,{value:t,modifiers:i,expression:r,original:n},{effect:s})=>{if(!t){let t={};return o=t,Object.entries(dt).forEach((([e,t])=>{Object.defineProperty(o,e,{get:()=>(...e)=>t(...e)})})),void de(e,r)((t=>{ht(e,t,n)}),{scope:t})}var o;if("key"===t)return function(e,t){e._x_keyExpression=t}(e,r);if(e._x_inlineBindings&&e._x_inlineBindings[t]&&e._x_inlineBindings[t].extract)return;let a=de(e,r);s((()=>a((n=>{void 0===n&&"string"==typeof r&&r.match(/\./)&&(n=""),V((()=>Ze(e,t,n,i)))}))))};function Vi(e,t,i,r){let n={};if(/^\[.*\]$/.test(e.item)&&Array.isArray(t)){e.item.replace("[","").replace("]","").split(",").map((e=>e.trim())).forEach(((e,i)=>{n[e]=t[i]}))}else if(/^\{.*\}$/.test(e.item)&&!Array.isArray(t)&&"object"==typeof t){e.item.replace("{","").replace("}","").split(",").map((e=>e.trim())).forEach((e=>{n[e]=t[e]}))}else n[e.item]=t;return e.index&&(n[e.index]=i),e.collection&&(n[e.collection]=r),n}function Gi(){}function Ki(e,t,i){be(t,(r=>b(`You can't use [x-${t}] without first installing the "${e}" plugin here: https://alpinejs.dev/plugins/${i}`,r)))}Hi.inline=(e,{value:t,modifiers:i,expression:r})=>{t&&(e._x_inlineBindings||(e._x_inlineBindings={}),e._x_inlineBindings[t]={expression:r,extract:!1})},be("bind",Hi),k((()=>`[${ye("data")}]`)),be("data",((e,{expression:t},{cleanup:i})=>{if(function(e){return!!qe&&(!!Qe||e.hasAttribute("data-has-alpine-state"))}(e))return;t=""===t?"{}":t;let n={};se(n,e);let s={};var o,a;o=s,a=n,Object.entries(pt).forEach((([e,t])=>{Object.defineProperty(o,e,{get:()=>(...e)=>t.bind(a)(...e),enumerable:!1})}));let l=ue(e,t,{scope:s});void 0!==l&&!0!==l||(l={}),se(l,e);let c=r(l);ee(c);let u=Y(e,c);c.init&&ue(e,c.init),i((()=>{c.destroy&&ue(e,c.destroy),u()}))})),Xe(((e,t)=>{e._x_dataStack&&(t._x_dataStack=e._x_dataStack,t.setAttribute("data-has-alpine-state",!0))})),be("show",((e,{modifiers:t,expression:i},{effect:r})=>{let n=de(e,i);e._x_doHide||(e._x_doHide=()=>{V((()=>{e.style.setProperty("display","none",t.includes("important")?"important":void 0)}))}),e._x_doShow||(e._x_doShow=()=>{V((()=>{1===e.style.length&&"none"===e.style.display?e.removeAttribute("style"):e.style.removeProperty("display")}))});let s,o=()=>{e._x_doHide(),e._x_isShown=!1},a=()=>{e._x_doShow(),e._x_isShown=!0},l=()=>setTimeout(a),c=$e((e=>e?a():o()),(t=>{"function"==typeof e._x_toggleAndCascadeWithTransitions?e._x_toggleAndCascadeWithTransitions(e,t,a,o):t?l():o()})),u=!0;r((()=>n((e=>{(u||e!==s)&&(t.includes("immediate")&&(e?l():o()),c(e),s=e,u=!1)}))))})),be("for",((e,{expression:t},{effect:i,cleanup:n})=>{let s=function(e){let t=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,i=/^\s*\(|\)\s*$/g,r=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,n=e.match(r);if(!n)return;let s={};s.items=n[2].trim();let o=n[1].replace(i,"").trim(),a=o.match(t);a?(s.item=o.replace(t,"").trim(),s.index=a[1].trim(),a[2]&&(s.collection=a[2].trim())):s.item=o;return s}(t),o=de(e,s.items),a=de(e,e._x_keyExpression||"index");e._x_prevKeys=[],e._x_lookup={},i((()=>function(e,t,i,n){let s=e=>"object"==typeof e&&!Array.isArray(e),o=e;i((i=>{var a;a=i,!Array.isArray(a)&&!isNaN(a)&&i>=0&&(i=Array.from(Array(i).keys(),(e=>e+1))),void 0===i&&(i=[]);let l=e._x_lookup,c=e._x_prevKeys,u=[],d=[];if(s(i))i=Object.entries(i).map((([r,s])=>{let o=Vi(t,s,r,i);n((t=>{d.includes(t)&&b("Duplicate key on x-for",e),d.push(t)}),{scope:{index:r,...o}}),u.push(o)}));else for(let r=0;r<i.length;r++){let s=Vi(t,i[r],r,i);n((t=>{d.includes(t)&&b("Duplicate key on x-for",e),d.push(t)}),{scope:{index:r,...s}}),u.push(s)}let p=[],f=[],m=[],g=[];for(let e=0;e<c.length;e++){let t=c[e];-1===d.indexOf(t)&&m.push(t)}c=c.filter((e=>!m.includes(e)));let y="template";for(let e=0;e<d.length;e++){let t=d[e],i=c.indexOf(t);if(-1===i)c.splice(e,0,t),p.push([y,e]);else if(i!==e){let t=c.splice(e,1)[0],r=c.splice(i-1,1)[0];c.splice(e,0,r),c.splice(i,0,t),f.push([t,r])}else g.push(t);y=t}for(let e=0;e<m.length;e++){let t=m[e];l[t]._x_effects&&l[t]._x_effects.forEach(h),l[t].remove(),l[t]=null,delete l[t]}for(let e=0;e<f.length;e++){let[t,i]=f[e],r=l[t],n=l[i],s=document.createElement("div");V((()=>{n||b('x-for ":key" is undefined or invalid',o,i,l),n.after(s),r.after(n),n._x_currentIfEl&&n.after(n._x_currentIfEl),s.before(r),r._x_currentIfEl&&r.after(r._x_currentIfEl),s.remove()})),n._x_refreshXForScope(u[d.indexOf(i)])}for(let e=0;e<p.length;e++){let[t,i]=p[e],n="template"===t?o:l[t];n._x_currentIfEl&&(n=n._x_currentIfEl);let s=u[i],a=d[i],c=document.importNode(o.content,!0).firstElementChild,h=r(s);Y(c,h,o),c._x_refreshXForScope=e=>{Object.entries(e).forEach((([e,t])=>{h[e]=t}))},V((()=>{n.after(c),We((()=>L(c)))()})),"object"==typeof a&&b("x-for key cannot be an object, it must be a string or an integer",o),l[a]=c}for(let e=0;e<g.length;e++)l[g[e]]._x_refreshXForScope(u[d.indexOf(g[e])]);o._x_prevKeys=d}))}(e,s,o,a))),n((()=>{Object.values(e._x_lookup).forEach((e=>e.remove())),delete e._x_prevKeys,delete e._x_lookup}))})),Gi.inline=(e,{expression:t},{cleanup:i})=>{let r=C(e);r._x_refs||(r._x_refs={}),r._x_refs[t]=e,i((()=>delete r._x_refs[t]))},be("ref",Gi),be("if",((e,{expression:t},{effect:i,cleanup:r})=>{"template"!==e.tagName.toLowerCase()&&b("x-if can only be used on a <template> tag",e);let n=de(e,t);i((()=>n((t=>{t?(()=>{if(e._x_currentIfEl)return e._x_currentIfEl;let t=e.content.cloneNode(!0).firstElementChild;Y(t,{},e),V((()=>{e.after(t),We((()=>L(t)))()})),e._x_currentIfEl=t,e._x_undoIf=()=>{v(t,(e=>{e._x_effects&&e._x_effects.forEach(h)})),t.remove(),delete e._x_currentIfEl}})():e._x_undoIf&&(e._x_undoIf(),delete e._x_undoIf)})))),r((()=>e._x_undoIf&&e._x_undoIf()))})),be("id",((e,{expression:t},{evaluate:i})=>{i(t).forEach((t=>function(e,t){e._x_ids||(e._x_ids={}),e._x_ids[t]||(e._x_ids[t]=Di(t))}(e,t)))})),Xe(((e,t)=>{e._x_ids&&(t._x_ids=e._x_ids)})),Re(xe("@",ye("on:"))),be("on",We(((e,{value:t,modifiers:i,expression:r},{cleanup:n})=>{let s=r?de(e,r):()=>{};"template"===e.tagName.toLowerCase()&&(e._x_forwardEvents||(e._x_forwardEvents=[]),e._x_forwardEvents.includes(t)||e._x_forwardEvents.push(t));let o=ji(e,t,i,(e=>{s((()=>{}),{scope:{$event:e},params:[e]})}));n((()=>o()))}))),Ki("Collapse","collapse","collapse"),Ki("Intersect","intersect","intersect"),Ki("Focus","trap","focus"),Ki("Mask","mask","mask"),ft.setEvaluator(pe),ft.setReactivityEngine({reactive:Ci,effect:function(e,t=yt){(function(e){return e&&!0===e._isEffect})(e)&&(e=e.raw);const i=function(e,t){const i=function(){if(!i.active)return e();if(!It.includes(i)){jt(i);try{return Ut.push(Bt),Bt=!0,It.push(i),gt=i,e()}finally{It.pop(),zt(),gt=It[It.length-1]}}};return i.id=Nt++,i.allowRecurse=!!t.allowRecurse,i._isEffect=!0,i.active=!0,i.raw=e,i.deps=[],i.options=t,i}(e,t);return t.lazy||i(),i},release:function(e){e.active&&(jt(e),e.options.onStop&&e.options.onStop(),e.active=!1)},raw:Li});var qi=ft},473:function(e){var t;"undefined"!=typeof self&&self,t=function(){return function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist/",i(i.s=9)}([function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return c}));var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function n(){}var s={trace:n,debug:n,log:n,warn:n,info:n,error:n},o=s;function a(e){for(var t=arguments.length,i=Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];i.forEach((function(t){o[t]=e[t]?e[t].bind(e):function(e){var t=self.console[e];return t?function(){for(var i=arguments.length,r=Array(i),n=0;n<i;n++)r[n]=arguments[n];r[0]&&(r[0]=function(e,t){return"["+e+"] > "+t}(e,r[0])),t.apply(self.console,r)}:n}(t)}))}var l=function(e){if(!0===e||"object"===(void 0===e?"undefined":r(e))){a(e,"debug","log","info","warn","error");try{o.log()}catch(e){o=s}}else o=s},c=s},function(e,t,i){"use strict";t.a={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return n}));var r={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",KEY_SYSTEM_ERROR:"keySystemError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},n={KEY_SYSTEM_NO_KEYS:"keySystemNoKeys",KEY_SYSTEM_NO_ACCESS:"keySystemNoAccess",KEY_SYSTEM_NO_SESSION:"keySystemNoSession",KEY_SYSTEM_LICENSE_REQUEST_FAILED:"keySystemLicenseRequestFailed",MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},function(e,t,i){var r,n,s,o,a;r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,n=/^([^\/;?#]*)(.*)$/,s=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,a={buildAbsoluteURL:function(e,t,i){if(i=i||{},e=e.trim(),!(t=t.trim())){if(!i.alwaysNormalize)return e;var r=a.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=a.normalizePath(r.path),a.buildURLFromParts(r)}var s=a.parseURL(t);if(!s)throw new Error("Error trying to parse relative URL.");if(s.scheme)return i.alwaysNormalize?(s.path=a.normalizePath(s.path),a.buildURLFromParts(s)):t;var o=a.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var l=n.exec(o.path);o.netLoc=l[1],o.path=l[2]}o.netLoc&&!o.path&&(o.path="/");var c={scheme:o.scheme,netLoc:s.netLoc,path:null,params:s.params,query:s.query,fragment:s.fragment};if(!s.netLoc&&(c.netLoc=o.netLoc,"/"!==s.path[0]))if(s.path){var u=o.path,d=u.substring(0,u.lastIndexOf("/")+1)+s.path;c.path=a.normalizePath(d)}else c.path=o.path,s.params||(c.params=o.params,s.query||(c.query=o.query));return null===c.path&&(c.path=i.alwaysNormalize?a.normalizePath(s.path):s.path),a.buildURLFromParts(c)},parseURL:function(e){var t=r.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(s,"");e.length!==(e=e.replace(o,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=a},function(e,t,i){"use strict";i.d(t,"b",(function(){return n}));var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.getID3Data=function(t,i){for(var r=i,n=0;e.isHeader(t,i);)n+=10,n+=e._readSize(t,i+6),e.isFooter(t,i+10)&&(n+=10),i+=n;if(n>0)return t.subarray(r,r+n)},e._readSize=function(e,t){var i=0;return i=(127&e[t])<<21,i|=(127&e[t+1])<<14,i|=(127&e[t+2])<<7,i|=127&e[t+3]},e.getTimeStamp=function(t){for(var i=e.getID3Frames(t),r=0;r<i.length;r++){var n=i[r];if(e.isTimeStampFrame(n))return e._readTimeStamp(n)}},e.isTimeStampFrame=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},e._getFrameData=function(t){var i=String.fromCharCode(t[0],t[1],t[2],t[3]),r=e._readSize(t,4);return{type:i,size:r,data:t.subarray(10,10+r)}},e.getID3Frames=function(t){for(var i=0,r=[];e.isHeader(t,i);){for(var n=e._readSize(t,i+6),s=(i+=10)+n;i+8<s;){var o=e._getFrameData(t.subarray(i)),a=e._decodeFrame(o);a&&r.push(a),i+=o.size+10}e.isFooter(t,i)&&(i+=10)}return r},e._decodeFrame=function(t){return"PRIV"===t.type?e._decodePrivFrame(t):"T"===t.type[0]?e._decodeTextFrame(t):"W"===t.type[0]?e._decodeURLFrame(t):void 0},e._readTimeStamp=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),i=1&t[3],r=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return r/=45,i&&(r+=47721858.84),Math.round(r)}},e._decodePrivFrame=function(t){if(!(t.size<2)){var i=e._utf8ArrayToStr(t.data,!0),r=new Uint8Array(t.data.subarray(i.length+1));return{key:t.type,info:i,data:r.buffer}}},e._decodeTextFrame=function(t){if(!(t.size<2)){if("TXXX"===t.type){var i=1,r=e._utf8ArrayToStr(t.data.subarray(i));i+=r.length+1;var n=e._utf8ArrayToStr(t.data.subarray(i));return{key:t.type,info:r,data:n}}var s=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:s}}},e._decodeURLFrame=function(t){if("WXXX"===t.type){if(t.size<2)return;var i=1,r=e._utf8ArrayToStr(t.data.subarray(i));i+=r.length+1;var n=e._utf8ArrayToStr(t.data.subarray(i));return{key:t.type,info:r,data:n}}var s=e._utf8ArrayToStr(t.data);return{key:t.type,data:s}},e._utf8ArrayToStr=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e.length,r=void 0,n=void 0,s=void 0,o="",a=0;a<i;){if(0===(r=e[a++])&&t)return o;if(0!==r&&3!==r)switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(r);break;case 12:case 13:n=e[a++],o+=String.fromCharCode((31&r)<<6|63&n);break;case 14:n=e[a++],s=e[a++],o+=String.fromCharCode((15&r)<<12|(63&n)<<6|63&s)}}return o},e}(),n=r._utf8ArrayToStr;t.a=r},function(e,t,i){"use strict";var r=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.subtle=t,this.aesIV=i}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}(),n=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.subtle=t,this.key=i}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}(),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return e.prototype.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),i=new Uint32Array(4),r=0;r<4;r++)i[r]=t.getUint32(4*r);return i},e.prototype.initTable=function(){var e=this.sBox,t=this.invSBox,i=this.subMix,r=i[0],n=i[1],s=i[2],o=i[3],a=this.invSubMix,l=a[0],c=a[1],u=a[2],d=a[3],h=new Uint32Array(256),p=0,f=0,m=0;for(m=0;m<256;m++)h[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){var g=f^f<<1^f<<2^f<<3^f<<4;g=g>>>8^255&g^99,e[p]=g,t[g]=p;var y=h[p],v=h[y],b=h[v],w=257*h[g]^16843008*g;r[p]=w<<24|w>>>8,n[p]=w<<16|w>>>16,s[p]=w<<8|w>>>24,o[p]=w,w=16843009*b^65537*v^257*y^16843008*p,l[g]=w<<24|w>>>8,c[g]=w<<16|w>>>16,u[g]=w<<8|w>>>24,d[g]=w,p?(p=y^h[h[h[b^y]]],f^=h[h[f]]):p=f=1}},e.prototype.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),i=!0,r=0;r<t.length&&i;)i=t[r]===this.key[r],r++;if(!i){this.key=t;var n=this.keySize=t.length;if(4!==n&&6!==n&&8!==n)throw new Error("Invalid aes key size="+n);var s=this.ksRows=4*(n+6+1),o=void 0,a=void 0,l=this.keySchedule=new Uint32Array(s),c=this.invKeySchedule=new Uint32Array(s),u=this.sBox,d=this.rcon,h=this.invSubMix,p=h[0],f=h[1],m=h[2],g=h[3],y=void 0,v=void 0;for(o=0;o<s;o++)o<n?y=l[o]=t[o]:(v=y,o%n==0?(v=u[(v=v<<8|v>>>24)>>>24]<<24|u[v>>>16&255]<<16|u[v>>>8&255]<<8|u[255&v],v^=d[o/n|0]<<24):n>6&&o%n==4&&(v=u[v>>>24]<<24|u[v>>>16&255]<<16|u[v>>>8&255]<<8|u[255&v]),l[o]=y=(l[o-n]^v)>>>0);for(a=0;a<s;a++)o=s-a,v=3&a?l[o]:l[o-4],c[a]=a<4||o<=4?v:p[u[v>>>24]]^f[u[v>>>16&255]]^m[u[v>>>8&255]]^g[u[255&v]],c[a]=c[a]>>>0}},e.prototype.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},e.prototype.decrypt=function(e,t,i,r){for(var n,s,o,a=this.keySize+6,l=this.invKeySchedule,c=this.invSBox,u=this.invSubMix,d=u[0],h=u[1],p=u[2],f=u[3],m=this.uint8ArrayToUint32Array_(i),g=m[0],y=m[1],v=m[2],b=m[3],w=new Int32Array(e),_=new Int32Array(w.length),E=void 0,T=void 0,S=void 0,k=void 0,x=void 0,C=void 0,A=void 0,R=void 0,L=void 0,P=void 0,O=void 0,D=void 0,I=void 0,M=void 0,F=this.networkToHostOrderSwap;t<w.length;){for(L=F(w[t]),P=F(w[t+1]),O=F(w[t+2]),D=F(w[t+3]),x=L^l[0],C=D^l[1],A=O^l[2],R=P^l[3],I=4,M=1;M<a;M++)E=d[x>>>24]^h[C>>16&255]^p[A>>8&255]^f[255&R]^l[I],T=d[C>>>24]^h[A>>16&255]^p[R>>8&255]^f[255&x]^l[I+1],S=d[A>>>24]^h[R>>16&255]^p[x>>8&255]^f[255&C]^l[I+2],k=d[R>>>24]^h[x>>16&255]^p[C>>8&255]^f[255&A]^l[I+3],x=E,C=T,A=S,R=k,I+=4;E=c[x>>>24]<<24^c[C>>16&255]<<16^c[A>>8&255]<<8^c[255&R]^l[I],T=c[C>>>24]<<24^c[A>>16&255]<<16^c[R>>8&255]<<8^c[255&x]^l[I+1],S=c[A>>>24]<<24^c[R>>16&255]<<16^c[x>>8&255]<<8^c[255&C]^l[I+2],k=c[R>>>24]<<24^c[x>>16&255]<<16^c[C>>8&255]<<8^c[255&A]^l[I+3],I+=3,_[t]=F(E^g),_[t+1]=F(k^y),_[t+2]=F(S^v),_[t+3]=F(T^b),g=L,y=P,v=O,b=D,t+=4}return r?(n=_.buffer,s=n.byteLength,(o=s&&new DataView(n).getUint8(s-1))?n.slice(0,s-o):n):_.buffer},e.prototype.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},e}(),o=i(2),a=i(0),l=function(){function e(t,i){var r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).removePKCS7Padding,n=void 0===r||r;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logEnabled=!0,this.observer=t,this.config=i,this.removePKCS7Padding=n,n)try{var s=crypto||self.crypto;this.subtle=s.subtle||s.webkitSubtle}catch(e){}this.disableWebCrypto=!this.subtle}return e.prototype.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},e.prototype.decrypt=function(e,t,i,o){var l=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(a.b.log("JS AES decrypt"),this.logEnabled=!1);var c=this.decryptor;c||(this.decryptor=c=new s),c.expandKey(t),o(c.decrypt(e,0,i,this.removePKCS7Padding))}else{this.logEnabled&&(a.b.log("WebCrypto AES decrypt"),this.logEnabled=!1);var u=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new n(u,t)),this.fastAesKey.expandKey().then((function(n){new r(u,i).decrypt(e,n).catch((function(r){l.onWebCryptoError(r,e,t,i,o)})).then((function(e){o(e)}))})).catch((function(r){l.onWebCryptoError(r,e,t,i,o)}))}},e.prototype.onWebCryptoError=function(e,t,i,r,n){this.config.enableSoftwareAES?(a.b.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,i,r,n)):(a.b.error("decrypting error : "+e.message),this.observer.trigger(Event.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},e.prototype.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)},e}();t.a=l},function(e,t){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function n(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}e.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,i,o,a,l,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||n(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}if(s(i=this._events[e]))return!1;if(r(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),i.apply(this,a)}else if(n(i))for(a=Array.prototype.slice.call(arguments,1),o=(c=i.slice()).length,l=0;l<o;l++)c[l].apply(this,a);return!0},i.prototype.addListener=function(e,t){var o;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?n(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,n(this._events[e])&&!this._events[e].warned&&(o=s(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){if(!r(t))throw TypeError("listener must be a function");var i=!1;function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}return n.listener=t,this.on(e,n),this},i.prototype.removeListener=function(e,t){var i,s,o,a;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(o=(i=this._events[e]).length,s=-1,i===t||r(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(n(i)){for(a=o;a-- >0;)if(i[a]===t||i[a].listener&&i[a].listener===t){s=a;break}if(s<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(s,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r(i=this._events[e]))this.removeListener(e,i);else if(i)for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},i.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,i){"use strict";var r=i(0),n=i(1),s=Math.pow(2,32)-1,o=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.remuxer=i}return e.prototype.resetTimeStamp=function(e){this.initPTS=e},e.prototype.resetInitSegment=function(t,i,r,s){if(t&&t.byteLength){var o=this.initData=e.parseInitSegment(t);null==i&&(i="mp4a.40.5"),null==r&&(r="avc1.42e01e");var a={};o.audio&&o.video?a.audiovideo={container:"video/mp4",codec:i+","+r,initSegment:s?t:null}:(o.audio&&(a.audio={container:"audio/mp4",codec:i,initSegment:s?t:null}),o.video&&(a.video={container:"video/mp4",codec:r,initSegment:s?t:null})),this.observer.trigger(n.a.FRAG_PARSING_INIT_SEGMENT,{tracks:a})}else i&&(this.audioCodec=i),r&&(this.videoCodec=r)},e.probe=function(t){return e.findBox({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length>0},e.bin2str=function(e){return String.fromCharCode.apply(null,e)},e.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);var i=e[t]<<8|e[t+1];return i<0?65536+i:i},e.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var i=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return i<0?4294967296+i:i},e.writeUint32=function(e,t,i){e.data&&(t+=e.start,e=e.data),e[t]=i>>24,e[t+1]=i>>16&255,e[t+2]=i>>8&255,e[t+3]=255&i},e.findBox=function(t,i){var r=[],n=void 0,s=void 0,o=void 0,a=void 0,l=void 0,c=void 0;if(t.data?(l=t.start,o=t.end,t=t.data):(l=0,o=t.byteLength),!i.length)return null;for(n=l;n<o;)c=(s=e.readUint32(t,n))>1?n+s:o,e.bin2str(t.subarray(n+4,n+8))===i[0]&&(1===i.length?r.push({data:t,start:n+8,end:c}):(a=e.findBox({data:t,start:n+8,end:c},i.slice(1))).length&&(r=r.concat(a))),n=c;return r},e.parseSegmentIndex=function(t){var i=e.findBox(t,["moov"])[0],r=i?i.end:null,n=0,s=e.findBox(t,["sidx"]),o=void 0;if(!s||!s[0])return null;o=[];var a=(s=s[0]).data[0];n=0===a?8:16;var l=e.readUint32(s,n);n+=4,n+=0===a?8:16,n+=2;var c=s.end+0,u=e.readUint16(s,n);n+=2;for(var d=0;d<u;d++){var h=n,p=e.readUint32(s,h);h+=4;var f=2147483647&p;if(1==(2147483648&p)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var m=e.readUint32(s,h);h+=4,o.push({referenceSize:f,subsegmentDuration:m,info:{duration:m/l,start:c,end:c+f-1}}),c+=f,n=h+=4}return{earliestPresentationTime:0,timescale:l,version:a,referencesCount:u,references:o,moovEndOffset:r}},e.parseInitSegment=function(t){var i=[];return e.findBox(t,["moov","trak"]).forEach((function(t){var n=e.findBox(t,["tkhd"])[0];if(n){var s=n.data[n.start],o=0===s?12:20,a=e.readUint32(n,o),l=e.findBox(t,["mdia","mdhd"])[0];if(l){o=0===(s=l.data[l.start])?12:20;var c=e.readUint32(l,o),u=e.findBox(t,["mdia","hdlr"])[0];if(u){var d={soun:"audio",vide:"video"}[e.bin2str(u.data.subarray(u.start+8,u.start+12))];if(d){var h=e.findBox(t,["mdia","minf","stbl","stsd"]);if(h.length){h=h[0];var p=e.bin2str(h.data.subarray(h.start+12,h.start+16));r.b.log("MP4Demuxer:"+d+":"+p+" found")}i[a]={timescale:c,type:d},i[d]={timescale:c,id:a}}}}}})),i},e.getStartDTS=function(t,i){var r,n,s=void 0;return s=e.findBox(i,["moof","traf"]),r=[].concat.apply([],s.map((function(i){return e.findBox(i,["tfhd"]).map((function(r){var n,s,o;return n=e.readUint32(r,4),s=t[n].timescale||9e4,o=e.findBox(i,["tfdt"]).map((function(t){var i,r=void 0;return i=t.data[t.start],r=e.readUint32(t,4),1===i&&(r*=Math.pow(2,32),r+=e.readUint32(t,8)),r}))[0],o/s}))}))),n=Math.min.apply(null,r),isFinite(n)?n:0},e.offsetStartDTS=function(t,i,r){e.findBox(i,["moof","traf"]).map((function(i){return e.findBox(i,["tfhd"]).map((function(n){var o=e.readUint32(n,4),a=t[o].timescale||9e4;e.findBox(i,["tfdt"]).map((function(t){var i=t.data[t.start],n=e.readUint32(t,4);if(0===i)e.writeUint32(t,4,n-r*a);else{n*=Math.pow(2,32),n+=e.readUint32(t,8),n-=r*a,n=Math.max(n,0);var o=Math.floor(n/(s+1)),l=Math.floor(n%(s+1));e.writeUint32(t,4,o),e.writeUint32(t,8,l)}}))}))}))},e.prototype.append=function(t,i,r,s){var o=this.initData;o||(this.resetInitSegment(t,this.audioCodec,this.videoCodec,!1),o=this.initData);var a,l=this.initPTS;if(void 0===l){var c=e.getStartDTS(o,t);this.initPTS=l=c-i,this.observer.trigger(n.a.INIT_PTS_FOUND,{initPTS:l})}e.offsetStartDTS(o,t,l),a=e.getStartDTS(o,t),this.remuxer.remux(o.audio,o.video,null,null,a,r,s,t)},e.prototype.destroy=function(){},e}();t.a=o},function(e,t,i){"use strict";var r=i(1),n=i(2),s=i(5),o=i(0);function a(e,t){return 255===e[t]&&240==(246&e[t+1])}function l(e,t){return 1&e[t+1]?7:9}function c(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function u(e,t){return!!(t+1<e.length&&a(e,t))}function d(e,t){if(t+1<e.length&&a(e,t)){var i=l(e,t);t+5<e.length&&(i=c(e,t));var r=t+i;if(r===e.length||r+1<e.length&&a(e,r))return!0}return!1}function h(e,t,i,r,s){if(!e.samplerate){var a=function(e,t,i,r){var s,a=void 0,l=void 0,c=void 0,u=void 0,d=navigator.userAgent.toLowerCase(),h=r,p=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(a=1+((192&t[i+2])>>>6),!((s=(60&t[i+2])>>>2)>p.length-1))return c=(1&t[i+2])<<2,c|=(192&t[i+3])>>>6,o.b.log("manifest codec:"+r+",ADTS data:type:"+a+",sampleingIndex:"+s+"["+p[s]+"Hz],channelConfig:"+c),/firefox/i.test(d)?s>=6?(a=5,u=new Array(4),l=s-3):(a=2,u=new Array(2),l=s):-1!==d.indexOf("android")?(a=2,u=new Array(2),l=s):(a=5,u=new Array(4),r&&(-1!==r.indexOf("mp4a.40.29")||-1!==r.indexOf("mp4a.40.5"))||!r&&s>=6?l=s-3:((r&&-1!==r.indexOf("mp4a.40.2")&&(s>=6&&1===c||/vivaldi/i.test(d))||!r&&1===c)&&(a=2,u=new Array(2)),l=s)),u[0]=a<<3,u[0]|=(14&s)>>1,u[1]|=(1&s)<<7,u[1]|=c<<3,5===a&&(u[1]|=(14&l)>>1,u[2]=(1&l)<<7,u[2]|=8,u[3]=0),{config:u,samplerate:p[s],channelCount:c,codec:"mp4a.40."+a,manifestCodec:h};e.trigger(Event.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+s})}(t,i,r,s);e.config=a.config,e.samplerate=a.samplerate,e.channelCount=a.channelCount,e.codec=a.codec,e.manifestCodec=a.manifestCodec,o.b.log("parsed codec:"+e.codec+",rate:"+a.samplerate+",nb channel:"+a.channelCount)}}function p(e){return 9216e4/e}function f(e,t,i,r,n){var s=function(e,t,i,r,n){var s,o=void 0,a=e.length;if(s=l(e,t),o=c(e,t),(o-=s)>0&&t+s+o<=a)return{headerLength:s,frameLength:o,stamp:i+r*n}}(t,i,r,n,p(e.samplerate));if(s){var o=s.stamp,a=s.headerLength,u=s.frameLength,d={unit:t.subarray(i+a,i+a+u),pts:o,dts:o};return e.samples.push(d),e.len+=u,{sample:d,length:u+a}}}var m=i(4),g=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=r,this.remuxer=i}return e.prototype.resetInitSegment=function(e,t,i,r){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:r,inputTimeScale:9e4}},e.prototype.resetTimeStamp=function(){},e.probe=function(e){if(!e)return!1;for(var t=(m.a.getID3Data(e,0)||[]).length,i=e.length;t<i;t++)if(d(e,t))return o.b.log("ADTS sync word found !"),!0;return!1},e.prototype.append=function(e,t,i,r){for(var n=this._audioTrack,s=m.a.getID3Data(e,0)||[],a=m.a.getTimeStamp(s),l=a?90*a:9e4*t,c=0,d=l,p=e.length,g=s.length,y=[{pts:d,dts:d,data:s}];g<p-1;)if(u(e,g)&&g+5<p){h(n,this.observer,e,g,n.manifestCodec);var v=f(n,e,g,l,c);if(!v){o.b.log("Unable to parse AAC frame");break}g+=v.length,d=v.sample.pts,c++}else m.a.isHeader(e,g)?(s=m.a.getID3Data(e,g),y.push({pts:d,dts:d,data:s}),g+=s.length):g++;this.remuxer.remux(n,{samples:[]},{samples:y,inputTimeScale:9e4},{samples:[]},t,i,r)},e.prototype.destroy=function(){},e}(),y=i(7),v={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,i,r,n){if(!(i+24>t.length)){var s=this.parseHeader(t,i);if(s&&i+s.frameLength<=t.length){var o=r+n*(9e4*s.samplesPerFrame/s.sampleRate),a={unit:t.subarray(i,i+s.frameLength),pts:o,dts:o};return e.config=[],e.channelCount=s.channelCount,e.samplerate=s.sampleRate,e.samples.push(a),e.len+=s.frameLength,{sample:a,length:s.frameLength}}}},parseHeader:function(e,t){var i=e[t+1]>>3&3,r=e[t+1]>>1&3,n=e[t+2]>>4&15,s=e[t+2]>>2&3,o=e[t+2]>>1&1;if(1!==i&&0!==n&&15!==n&&3!==s){var a=3===i?3-r:3===r?3:4,l=1e3*v.BitratesMap[14*a+n-1],c=3===i?0:2===i?1:2,u=v.SamplingRateMap[3*c+s],d=e[t+3]>>6==3?1:2,h=v.SamplesCoefficients[i][r],p=v.BytesInSlot[r],f=8*h*p;return{sampleRate:u,channelCount:d,frameLength:parseInt(h*l/u+o,10)*p,samplesPerFrame:f}}},isHeaderPattern:function(e,t){return!(255!==e[t]||224&~e[t+1]||!(6&e[t+1]))},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var i=this.parseHeader(e,t),r=4;i&&i.frameLength&&(r=i.frameLength);var n=t+r;if(n===e.length||n+1<e.length&&this.isHeaderPattern(e,n))return!0}return!1}},b=v,w=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}return e.prototype.loadWord=function(){var e=this.data,t=this.bytesAvailable,i=e.byteLength-t,r=new Uint8Array(4),n=Math.min(4,t);if(0===n)throw new Error("no bytes available");r.set(e.subarray(i,i+n)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=8*n,this.bytesAvailable-=n},e.prototype.skipBits=function(e){var t=void 0;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},e.prototype.readBits=function(e){var t=Math.min(this.bitsAvailable,e),i=this.word>>>32-t;return e>32&&o.b.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=e-t)>0&&this.bitsAvailable?i<<t|this.readBits(t):i},e.prototype.skipLZ=function(){var e=void 0;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},e.prototype.skipUEG=function(){this.skipBits(1+this.skipLZ())},e.prototype.skipEG=function(){this.skipBits(1+this.skipLZ())},e.prototype.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},e.prototype.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},e.prototype.readBoolean=function(){return 1===this.readBits(1)},e.prototype.readUByte=function(){return this.readBits(8)},e.prototype.readUShort=function(){return this.readBits(16)},e.prototype.readUInt=function(){return this.readBits(32)},e.prototype.skipScalingList=function(e){var t=8,i=8,r=void 0;for(r=0;r<e;r++)0!==i&&(i=(t+this.readEG()+256)%256),t=0===i?t:i},e.prototype.readSPS=function(){var e,t,i,r,n=0,s=0,o=0,a=0,l=void 0,c=void 0,u=void 0,d=this.readUByte.bind(this),h=this.readBits.bind(this),p=this.readUEG.bind(this),f=this.readBoolean.bind(this),m=this.skipBits.bind(this),g=this.skipEG.bind(this),y=this.skipUEG.bind(this),v=this.skipScalingList.bind(this);if(d(),e=d(),h(5),m(3),d(),y(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var b=p();if(3===b&&m(1),y(),y(),m(1),f())for(c=3!==b?8:12,u=0;u<c;u++)f()&&v(u<6?16:64)}y();var w=p();if(0===w)p();else if(1===w)for(m(1),g(),g(),l=p(),u=0;u<l;u++)g();y(),m(1),t=p(),i=p(),0===(r=h(1))&&m(1),m(1),f()&&(n=p(),s=p(),o=p(),a=p());var _=[1,1];if(f()&&f())switch(d()){case 1:_=[1,1];break;case 2:_=[12,11];break;case 3:_=[10,11];break;case 4:_=[16,11];break;case 5:_=[40,33];break;case 6:_=[24,11];break;case 7:_=[20,11];break;case 8:_=[32,11];break;case 9:_=[80,33];break;case 10:_=[18,11];break;case 11:_=[15,11];break;case 12:_=[64,33];break;case 13:_=[160,99];break;case 14:_=[4,3];break;case 15:_=[3,2];break;case 16:_=[2,1];break;case 255:_=[d()<<8|d(),d()<<8|d()]}return{width:Math.ceil(16*(t+1)-2*n-2*s),height:(2-r)*(i+1)*16-(r?2:4)*(o+a),pixelRatio:_}},e.prototype.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}(),_=function(){function e(t,i,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.decryptdata=r,this.discardEPB=n,this.decrypter=new s.a(t,i,{removePKCS7Padding:!1})}return e.prototype.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},e.prototype.decryptAacSample=function(e,t,i,r){var n=e[t].unit,s=n.subarray(16,n.length-n.length%16),o=s.buffer.slice(s.byteOffset,s.byteOffset+s.length),a=this;this.decryptBuffer(o,(function(s){s=new Uint8Array(s),n.set(s,16),r||a.decryptAacSamples(e,t+1,i)}))},e.prototype.decryptAacSamples=function(e,t,i){for(;;t++){if(t>=e.length)return void i();if(!(e[t].unit.length<32)){var r=this.decrypter.isSync();if(this.decryptAacSample(e,t,i,r),!r)return}}},e.prototype.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,i=new Int8Array(t),r=0,n=32;n<=e.length-16;n+=160,r+=16)i.set(e.subarray(n,n+16),r);return i},e.prototype.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var i=0,r=32;r<=e.length-16;r+=160,i+=16)e.set(t.subarray(i,i+16),r);return e},e.prototype.decryptAvcSample=function(e,t,i,r,n,s){var o=this.discardEPB(n.data),a=this.getAvcEncryptedData(o),l=this;this.decryptBuffer(a.buffer,(function(a){n.data=l.getAvcDecryptedUnit(o,a),s||l.decryptAvcSamples(e,t,i+1,r)}))},e.prototype.decryptAvcSamples=function(e,t,i,r){for(;;t++,i=0){if(t>=e.length)return void r();for(var n=e[t].units;!(i>=n.length);i++){var s=n[i];if(!(s.length<=48||1!==s.type&&5!==s.type)){var o=this.decrypter.isSync();if(this.decryptAvcSample(e,t,i,r,s,o),!o)return}}}},e}(),E={video:0,audio:1,id3:2,text:3},T=function(){function e(t,i,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=r,this.typeSupported=n,this.remuxer=i,this.sampleAes=null}return e.prototype.setDecryptData=function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new _(this.observer,this.config,e,this.discardEPB):this.sampleAes=null},e.probe=function(t){var i=e._syncOffset(t);return!(i<0||(i&&o.b.warn("MPEG2-TS detected but first sync word found @ offset "+i+", junk ahead ?"),0))},e._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),i=0;i<t;){if(71===e[i]&&71===e[i+188]&&71===e[i+376])return i;i++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:E[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:"video"===e?0:void 0,isAAC:"audio"===e||void 0,duration:"audio"===e?t:void 0}},e.prototype.resetInitSegment=function(t,i,r,n){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=e.createTrack("video",n),this._audioTrack=e.createTrack("audio",n),this._id3Track=e.createTrack("id3",n),this._txtTrack=e.createTrack("text",n),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=i,this.videoCodec=r,this._duration=n},e.prototype.resetTimeStamp=function(){},e.prototype.append=function(t,i,s,a){var l=void 0,c=t.length,u=void 0,d=void 0,h=void 0,p=void 0,f=!1;this.contiguous=s;var m=this.pmtParsed,g=this._avcTrack,y=this._audioTrack,v=this._id3Track,b=g.pid,w=y.pid,_=v.pid,E=this._pmtId,T=g.pesData,S=y.pesData,k=v.pesData,x=this._parsePAT,C=this._parsePMT,A=this._parsePES,R=this._parseAVCPES.bind(this),L=this._parseAACPES.bind(this),P=this._parseMPEGPES.bind(this),O=this._parseID3PES.bind(this),D=e._syncOffset(t);for(c-=(c+D)%188,l=D;l<c;l+=188)if(71===t[l]){if(u=!!(64&t[l+1]),d=((31&t[l+1])<<8)+t[l+2],(48&t[l+3])>>4>1){if((h=l+5+t[l+4])===l+188)continue}else h=l+4;switch(d){case b:u&&(T&&(p=A(T))&&void 0!==p.pts&&R(p,!1),T={data:[],size:0}),T&&(T.data.push(t.subarray(h,l+188)),T.size+=l+188-h);break;case w:u&&(S&&(p=A(S))&&void 0!==p.pts&&(y.isAAC?L(p):P(p)),S={data:[],size:0}),S&&(S.data.push(t.subarray(h,l+188)),S.size+=l+188-h);break;case _:u&&(k&&(p=A(k))&&void 0!==p.pts&&O(p),k={data:[],size:0}),k&&(k.data.push(t.subarray(h,l+188)),k.size+=l+188-h);break;case 0:u&&(h+=t[h]+1),E=this._pmtId=x(t,h);break;case E:u&&(h+=t[h]+1);var I=C(t,h,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(b=I.avc)>0&&(g.pid=b),(w=I.audio)>0&&(y.pid=w,y.isAAC=I.isAAC),(_=I.id3)>0&&(v.pid=_),f&&!m&&(o.b.log("reparse from beginning"),f=!1,l=D-188),m=this.pmtParsed=!0;break;case 17:case 8191:break;default:f=!0}}else this.observer.trigger(r.a.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});T&&(p=A(T))&&void 0!==p.pts?(R(p,!0),g.pesData=null):g.pesData=T,S&&(p=A(S))&&void 0!==p.pts?(y.isAAC?L(p):P(p),y.pesData=null):(S&&S.size&&o.b.log("last AAC PES packet truncated,might overlap between fragments"),y.pesData=S),k&&(p=A(k))&&void 0!==p.pts?(O(p),v.pesData=null):v.pesData=k,null==this.sampleAes?this.remuxer.remux(y,g,v,this._txtTrack,i,s,a):this.decryptAndRemux(y,g,v,this._txtTrack,i,s,a)},e.prototype.decryptAndRemux=function(e,t,i,r,n,s,o){if(e.samples&&e.isAAC){var a=this;this.sampleAes.decryptAacSamples(e.samples,0,(function(){a.decryptAndRemuxAvc(e,t,i,r,n,s,o)}))}else this.decryptAndRemuxAvc(e,t,i,r,n,s,o)},e.prototype.decryptAndRemuxAvc=function(e,t,i,r,n,s,o){if(t.samples){var a=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,(function(){a.remuxer.remux(e,t,i,r,n,s,o)}))}else this.remuxer.remux(e,t,i,r,n,s,o)},e.prototype.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},e.prototype._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},e.prototype._parsePMT=function(e,t,i,r){var n,s=void 0,a={audio:-1,avc:-1,id3:-1,isAAC:!0};for(n=t+3+((15&e[t+1])<<8|e[t+2])-4,t+=12+((15&e[t+10])<<8|e[t+11]);t<n;){switch(s=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!r){o.b.log("unkown stream type:"+e[t]);break}case 15:-1===a.audio&&(a.audio=s);break;case 21:-1===a.id3&&(a.id3=s);break;case 219:if(!r){o.b.log("unkown stream type:"+e[t]);break}case 27:-1===a.avc&&(a.avc=s);break;case 3:case 4:i?-1===a.audio&&(a.audio=s,a.isAAC=!1):o.b.log("MPEG audio found, not supported in this browser for now");break;case 36:o.b.warn("HEVC stream type found, not supported for now");break;default:o.b.log("unkown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return a},e.prototype._parsePES=function(e){var t=0,i=void 0,r=void 0,n=void 0,s=void 0,a=void 0,l=void 0,c=void 0,u=void 0,d=e.data;if(!e||0===e.size)return null;for(;d[0].length<19&&d.length>1;){var h=new Uint8Array(d[0].length+d[1].length);h.set(d[0]),h.set(d[1],d[0].length),d[0]=h,d.splice(1,1)}if(1===((i=d[0])[0]<<16)+(i[1]<<8)+i[2]){if((n=(i[4]<<8)+i[5])&&n>e.size-6)return null;192&(r=i[7])&&((l=536870912*(14&i[9])+4194304*(255&i[10])+16384*(254&i[11])+128*(255&i[12])+(254&i[13])/2)>4294967295&&(l-=8589934592),64&r?((c=536870912*(14&i[14])+4194304*(255&i[15])+16384*(254&i[16])+128*(255&i[17])+(254&i[18])/2)>4294967295&&(c-=8589934592),l-c>54e5&&(o.b.warn(Math.round((l-c)/9e4)+"s delta between PTS and DTS, align them"),l=c)):c=l),u=(s=i[8])+9,e.size-=u,a=new Uint8Array(e.size);for(var p=0,f=d.length;p<f;p++){var m=(i=d[p]).byteLength;if(u){if(u>m){u-=m;continue}i=i.subarray(u),m-=u,u=0}a.set(i,t),t+=m}return n&&(n-=s+3),{data:a,pts:l,dts:c,len:n}}return null},e.prototype.pushAccesUnit=function(e,t){if(e.units.length&&e.frame){var i=t.samples,r=i.length;!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(r||this.contiguous)?(e.id=r,i.push(e)):t.dropped++}e.debug.length&&o.b.log(e.pts+"/"+e.dts+":"+e.debug)},e.prototype._parseAVCPES=function(e,t){var i=this,r=this._avcTrack,n=this._parseAVCNALu(e.data),s=void 0,o=this.avcSample,a=void 0,l=!1,c=void 0,u=this.pushAccesUnit.bind(this),d=function(e,t,i,r){return{key:e,pts:t,dts:i,units:[],debug:r}};e.data=null,o&&n.length&&!r.audFound&&(u(o,r),o=this.avcSample=d(!1,e.pts,e.dts,"")),n.forEach((function(t){switch(t.type){case 1:a=!0,o||(o=i.avcSample=d(!0,e.pts,e.dts,"")),o.frame=!0;var n=t.data;if(l&&n.length>4){var h=new w(n).readSliceType();2!==h&&4!==h&&7!==h&&9!==h||(o.key=!0)}break;case 5:a=!0,o||(o=i.avcSample=d(!0,e.pts,e.dts,"")),o.key=!0,o.frame=!0;break;case 6:a=!0,(s=new w(i.discardEPB(t.data))).readUByte();for(var p=0,f=0,m=!1,g=0;!m&&s.bytesAvailable>1;){p=0;do{p+=g=s.readUByte()}while(255===g);f=0;do{f+=g=s.readUByte()}while(255===g);if(4===p&&0!==s.bytesAvailable){if(m=!0,181===s.readUByte()&&49===s.readUShort()&&1195456820===s.readUInt()&&3===s.readUByte()){var y=s.readUByte(),v=31&y,b=[y,s.readUByte()];for(c=0;c<v;c++)b.push(s.readUByte()),b.push(s.readUByte()),b.push(s.readUByte());i._insertSampleInOrder(i._txtTrack.samples,{type:3,pts:e.pts,bytes:b})}}else if(f<s.bytesAvailable)for(c=0;c<f;c++)s.readUByte()}break;case 7:if(a=!0,l=!0,!r.sps){var _=(s=new w(t.data)).readSPS();r.width=_.width,r.height=_.height,r.pixelRatio=_.pixelRatio,r.sps=[t.data],r.duration=i._duration;var E=t.data.subarray(1,4),T="avc1.";for(c=0;c<3;c++){var S=E[c].toString(16);S.length<2&&(S="0"+S),T+=S}r.codec=T}break;case 8:a=!0,r.pps||(r.pps=[t.data]);break;case 9:a=!1,r.audFound=!0,o&&u(o,r),o=i.avcSample=d(!1,e.pts,e.dts,"");break;case 12:a=!1;break;default:a=!1,o&&(o.debug+="unknown NAL "+t.type+" ")}o&&a&&o.units.push(t)})),t&&o&&(u(o,r),this.avcSample=null)},e.prototype._insertSampleInOrder=function(e,t){var i=e.length;if(i>0){if(t.pts>=e[i-1].pts)e.push(t);else for(var r=i-1;r>=0;r--)if(t.pts<e[r].pts){e.splice(r,0,t);break}}else e.push(t)},e.prototype._getLastNalUnit=function(){var e=this.avcSample,t=void 0;if(!e||0===e.units.length){var i=this._avcTrack.samples;e=i[i.length-1]}if(e){var r=e.units;t=r[r.length-1]}return t},e.prototype._parseAVCNALu=function(e){var t=0,i=e.byteLength,r=void 0,n=void 0,s=this._avcTrack,o=s.naluState||0,a=o,l=[],c=void 0,u=-1,d=void 0;for(-1===o&&(u=0,d=31&e[0],o=0,t=1);t<i;)if(r=e[t++],o)if(1!==o)if(r)if(1===r){if(u>=0)c={data:e.subarray(u,t-o-1),type:d},l.push(c);else{var h=this._getLastNalUnit();if(h&&(a&&t<=4-a&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-a)),(n=t-o-1)>0)){var p=new Uint8Array(h.data.byteLength+n);p.set(h.data,0),p.set(e.subarray(0,n),h.data.byteLength),h.data=p}}t<i?(u=t,d=31&e[t],o=0):o=-1}else o=0;else o=3;else o=r?0:2;else o=r?0:1;if(u>=0&&o>=0&&(c={data:e.subarray(u,i),type:d,state:o},l.push(c)),0===l.length){var f=this._getLastNalUnit();if(f){var m=new Uint8Array(f.data.byteLength+e.byteLength);m.set(f.data,0),m.set(e,f.data.byteLength),f.data=m}}return s.naluState=o,l},e.prototype.discardEPB=function(e){for(var t,i=e.byteLength,r=[],n=1,s=void 0;n<i-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(r.push(n+2),n+=2):n++;if(0===r.length)return e;t=i-r.length,s=new Uint8Array(t);var o=0;for(n=0;n<t;o++,n++)o===r[0]&&(o++,r.shift()),s[n]=e[o];return s},e.prototype._parseAACPES=function(e){var t,i,s=this._audioTrack,a=e.data,l=e.pts,c=this.aacOverFlow,d=this.aacLastPTS,m=void 0,g=void 0,y=void 0;if(c){var v=new Uint8Array(c.byteLength+a.byteLength);v.set(c,0),v.set(a,c.byteLength),a=v}for(g=0,i=a.length;g<i-1&&!u(a,g);g++);if(g){var b=void 0,w=void 0;if(g<i-1?(b="AAC PES did not start with ADTS header,offset:"+g,w=!1):(b="no ADTS header found in AAC PES",w=!0),o.b.warn("parsing error:"+b),this.observer.trigger(r.a.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_PARSING_ERROR,fatal:w,reason:b}),w)return}if(h(s,this.observer,a,g,this.audioCodec),m=0,t=p(s.samplerate),c&&d){var _=d+t;Math.abs(_-l)>1&&(o.b.log("AAC: align PTS for overlapping frames by "+Math.round((_-l)/90)),l=_)}for(;g<i;)if(u(a,g)&&g+5<i){var E=f(s,a,g,l,m);if(!E)break;g+=E.length,y=E.sample.pts,m++}else g++;c=g<i?a.subarray(g,i):null,this.aacOverFlow=c,this.aacLastPTS=y},e.prototype._parseMPEGPES=function(e){for(var t=e.data,i=t.length,r=0,n=0,s=e.pts;n<i;)if(b.isHeader(t,n)){var o=b.appendFrame(this._audioTrack,t,n,s,r);if(!o)break;n+=o.length,r++}else n++},e.prototype._parseID3PES=function(e){this._id3Track.samples.push(e)},e}(),S=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=r,this.remuxer=i}return e.prototype.resetInitSegment=function(e,t,i,r){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:r,inputTimeScale:9e4}},e.prototype.resetTimeStamp=function(){},e.probe=function(e){var t=void 0,i=void 0,r=m.a.getID3Data(e,0);if(r&&void 0!==m.a.getTimeStamp(r))for(t=r.length,i=Math.min(e.length-1,t+100);t<i;t++)if(b.probe(e,t))return o.b.log("MPEG Audio sync word found !"),!0;return!1},e.prototype.append=function(e,t,i,r){for(var n=m.a.getID3Data(e,0),s=m.a.getTimeStamp(n),o=s?90*s:9e4*t,a=n.length,l=e.length,c=0,u=0,d=this._audioTrack,h=[{pts:o,dts:o,data:n}];a<l;)if(b.isHeader(e,a)){var p=b.appendFrame(d,e,a,o,c);if(!p)break;a+=p.length,u=p.sample.pts,c++}else m.a.isHeader(e,a)?(n=m.a.getID3Data(e,a),h.push({pts:u,dts:u,data:n}),a+=n.length):a++;this.remuxer.remux(d,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},t,i,r)},e.prototype.destroy=function(){},e}(),k=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.getSilentFrame=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}(),x=Math.pow(2,32)-1,C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.init=function(){e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var t=void 0;for(t in e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var i=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:i,audio:r};var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),s=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=s,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,l,o,a),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,n))},e.box=function(e){for(var t=Array.prototype.slice.call(arguments,1),i=8,r=t.length,n=r,s=void 0;r--;)i+=t[r].byteLength;for((s=new Uint8Array(i))[0]=i>>24&255,s[1]=i>>16&255,s[2]=i>>8&255,s[3]=255&i,s.set(e,4),r=0,i=8;r<n;r++)s.set(t[r],i),i+=t[r].byteLength;return s},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,i){i*=t;var r=Math.floor(i/(x+1)),n=Math.floor(i%(x+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,i,r){return e.box(e.types.moof,e.mfhd(t),e.traf(r,i))},e.moov=function(t){for(var i=t.length,r=[];i--;)r[i]=e.trak(t[i]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(r).concat(e.mvex(t)))},e.mvex=function(t){for(var i=t.length,r=[];i--;)r[i]=e.trex(t[i]);return e.box.apply(null,[e.types.mvex].concat(r))},e.mvhd=function(t,i){i*=t;var r=Math.floor(i/(x+1)),n=Math.floor(i%(x+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,n>>24,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,s)},e.sdtp=function(t){var i=t.samples||[],r=new Uint8Array(4+i.length),n=void 0,s=void 0;for(s=0;s<i.length;s++)n=i[s].flags,r[s+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return e.box(e.types.sdtp,r)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var i=[],r=[],n=void 0,s=void 0,o=void 0;for(n=0;n<t.sps.length;n++)o=(s=t.sps[n]).byteLength,i.push(o>>>8&255),i.push(255&o),i=i.concat(Array.prototype.slice.call(s));for(n=0;n<t.pps.length;n++)o=(s=t.pps[n]).byteLength,r.push(o>>>8&255),r.push(255&o),r=r.concat(Array.prototype.slice.call(s));var a=e.box(e.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|t.sps.length].concat(i).concat([t.pps.length]).concat(r))),l=t.width,c=t.height,u=t.pixelRatio[0],d=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,c>>8&255,255&c,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,d>>24,d>>16&255,d>>8&255,255&d])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.mp4a=function(t){var i=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){var i=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]))},e.stsd=function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))},e.tkhd=function(t){var i=t.id,r=t.duration*t.timescale,n=t.width,s=t.height,o=Math.floor(r/(x+1)),a=Math.floor(r%(x+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,i>>24&255,i>>16&255,i>>8&255,255&i,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,a>>24,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,s>>8&255,255&s,0,0]))},e.traf=function(t,i){var r=e.sdtp(t),n=t.id,s=Math.floor(i/(x+1)),o=Math.floor(i%(x+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,o>>24,o>>16&255,o>>8&255,255&o])),e.trun(t,r.length+16+20+8+16+8+8),r)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var i=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,i){var r=t.samples||[],n=r.length,s=12+16*n,o=new Uint8Array(s),a=void 0,l=void 0,c=void 0,u=void 0,d=void 0,h=void 0;for(i+=8+s,o.set([0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,255&n,i>>>24&255,i>>>16&255,i>>>8&255,255&i],0),a=0;a<n;a++)c=(l=r[a]).duration,u=l.size,d=l.flags,h=l.cts,o.set([c>>>24&255,c>>>16&255,c>>>8&255,255&c,u>>>24&255,u>>>16&255,u>>>8&255,255&u,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,61440&d.degradPrio,15&d.degradPrio,h>>>24&255,h>>>16&255,h>>>8&255,255&h],12+16*a);return e.box(e.types.trun,o)},e.initSegment=function(t){e.types||e.init();var i=e.moov(t),r=void 0;return(r=new Uint8Array(e.FTYP.byteLength+i.byteLength)).set(e.FTYP),r.set(i,e.FTYP.byteLength),r},e}(),A=C,R=function(){function e(t,i,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=i,this.typeSupported=r;var s=navigator.userAgent;this.isSafari=n&&n.indexOf("Apple")>-1&&s&&!s.match("CriOS"),this.ISGenerated=!1}return e.prototype.destroy=function(){},e.prototype.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},e.prototype.resetInitSegment=function(){this.ISGenerated=!1},e.prototype.remux=function(e,t,i,n,s,a,l){if(this.ISGenerated||this.generateIS(e,t,s),this.ISGenerated){var c=e.samples.length,u=t.samples.length,d=s,h=s;if(c&&u){var p=(e.samples[0].dts-t.samples[0].dts)/t.inputTimeScale;d+=Math.max(0,p),h+=Math.max(0,-p)}if(c){e.timescale||(o.b.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,s));var f=this.remuxAudio(e,d,a,l);if(u){var m=void 0;f&&(m=f.endPTS-f.startPTS),t.timescale||(o.b.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,s)),this.remuxVideo(t,h,a,m,l)}}else if(u){var g=this.remuxVideo(t,h,a,0,l);g&&e.codec&&this.remuxEmptyAudio(e,d,a,g)}}i.samples.length&&this.remuxID3(i,s),n.samples.length&&this.remuxText(n,s),this.observer.trigger(r.a.FRAG_PARSED)},e.prototype.generateIS=function(e,t,i){var s=this.observer,a=e.samples,l=t.samples,c=this.typeSupported,u="audio/mp4",d={},h={tracks:d},p=void 0===this._initPTS,f=void 0,m=void 0;if(p&&(f=m=1/0),e.config&&a.length&&(e.timescale=e.samplerate,o.b.log("audio sampling rate : "+e.samplerate),e.isAAC||(c.mpeg?(u="audio/mpeg",e.codec=""):c.mp3&&(e.codec="mp3")),d.audio={container:u,codec:e.codec,initSegment:!e.isAAC&&c.mpeg?new Uint8Array:A.initSegment([e]),metadata:{channelCount:e.channelCount}},p&&(f=m=a[0].pts-e.inputTimeScale*i)),t.sps&&t.pps&&l.length){var g=t.inputTimeScale;t.timescale=g,d.video={container:"video/mp4",codec:t.codec,initSegment:A.initSegment([t]),metadata:{width:t.width,height:t.height}},p&&(f=Math.min(f,l[0].pts-g*i),m=Math.min(m,l[0].dts-g*i),this.observer.trigger(r.a.INIT_PTS_FOUND,{initPTS:f}))}Object.keys(d).length?(s.trigger(r.a.FRAG_PARSING_INIT_SEGMENT,h),this.ISGenerated=!0,p&&(this._initPTS=f,this._initDTS=m)):s.trigger(r.a.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},e.prototype.remuxVideo=function(e,t,i,s,a){var l,c,u,d=8,h=e.timescale,p=void 0,f=void 0,m=void 0,g=void 0,y=e.samples,v=[],b=y.length,w=this._PTSNormalize,_=this._initDTS,E=this.nextAvcDts,T=this.isSafari;if(0!==b){T&&(i|=y.length&&E&&(a&&Math.abs(t-E/h)<.1||Math.abs(y[0].pts-E-_)<h/5)),i||(E=t*h),y.forEach((function(e){e.pts=w(e.pts-_,E),e.dts=w(e.dts-_,E)})),y.sort((function(e,t){var i=e.dts-t.dts,r=e.pts-t.pts;return i||r||e.id-t.id}));var S=y.reduce((function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)}),0);if(S<0){o.b.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(S/90)+" ms to overcome this issue");for(var k=0;k<y.length;k++)y[k].dts+=S}var x=y[0];g=Math.max(x.dts,0),m=Math.max(x.pts,0);var C=Math.round((g-E)/90);i&&C&&(C>1?o.b.log("AVC:"+C+" ms hole between fragments detected,filling it"):C<-1&&o.b.log("AVC:"+-C+" ms overlapping between fragments detected"),g=E,y[0].dts=g,m=Math.max(m-C,E),y[0].pts=m,o.b.log("Video/PTS/DTS adjusted: "+Math.round(m/90)+"/"+Math.round(g/90)+",delta:"+C+" ms")),x=y[y.length-1],u=Math.max(x.dts,0),c=Math.max(x.pts,0,u),T&&(p=Math.round((u-g)/(y.length-1)));for(var R=0,L=0,P=0;P<b;P++){for(var O=y[P],D=O.units,I=D.length,M=0,F=0;F<I;F++)M+=D[F].data.length;L+=M,R+=I,O.length=M,O.dts=T?g+P*p:Math.max(O.dts,g),O.pts=Math.max(O.pts,O.dts)}var N=L+4*R+8;try{f=new Uint8Array(N)}catch(e){return void this.observer.trigger(r.a.ERROR,{type:n.b.MUX_ERROR,details:n.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:N,reason:"fail allocating video mdat "+N})}var j=new DataView(f.buffer);j.setUint32(0,N),f.set(A.types.mdat,4);for(var B=0;B<b;B++){for(var U=y[B],z=U.units,$=0,H=void 0,V=0,G=z.length;V<G;V++){var K=z[V],q=K.data,W=K.data.byteLength;j.setUint32(d,W),d+=4,f.set(q,d),d+=W,$+=4+W}if(T)H=Math.max(0,p*Math.round((U.pts-U.dts)/p));else{if(B<b-1)p=y[B+1].dts-U.dts;else{var Y=this.config,X=U.dts-y[B>0?B-1:B].dts;if(Y.stretchShortVideoTrack){var Q=Y.maxBufferHole,J=Math.floor(Q*h),Z=(s?m+s*h:this.nextAudioPts)-U.pts;Z>J?((p=Z-X)<0&&(p=X),o.b.log("It is approximately "+Z/90+" ms to the next segment; using duration "+p/90+" ms for the last video frame.")):p=X}else p=X}H=Math.round(U.pts-U.dts)}v.push({size:$,duration:p,cts:H,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:U.key?2:1,isNonSync:U.key?0:1}})}this.nextAvcDts=u+p;var ee=e.dropped;if(e.len=0,e.nbNalu=0,e.dropped=0,v.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var te=v[0].flags;te.dependsOn=2,te.isNonSync=0}e.samples=v,l=A.moof(e.sequenceNumber++,g,e),e.samples=[];var ie={data1:l,data2:f,startPTS:m/h,endPTS:(c+p)/h,startDTS:g/h,endDTS:this.nextAvcDts/h,type:"video",hasAudio:!1,hasVideo:!0,nb:v.length,dropped:ee};return this.observer.trigger(r.a.FRAG_PARSING_DATA,ie),ie}},e.prototype.remuxAudio=function(e,t,i,s){var a=e.inputTimeScale,l=e.timescale,c=a/l,u=(e.isAAC?1024:1152)*c,d=this._PTSNormalize,h=this._initDTS,p=!e.isAAC&&this.typeSupported.mpeg,f=void 0,m=void 0,g=void 0,y=void 0,v=void 0,b=void 0,w=void 0,_=e.samples,E=[],T=this.nextAudioPts;if(i|=_.length&&T&&(s&&Math.abs(t-T/a)<.1||Math.abs(_[0].pts-T-h)<20*u),_.forEach((function(e){e.pts=e.dts=d(e.pts-h,t*a)})),_=_.filter((function(e){return e.pts>=0})),0!==_.length){if(i||(T=s?t*a:_[0].pts),e.isAAC)for(var S=this.config.maxAudioFramesDrift,x=0,C=T;x<_.length;){var R,L=_[x];R=L.pts-C;var P=Math.abs(1e3*R/a);if(R<=-S*u)o.b.warn("Dropping 1 audio frame @ "+(C/a).toFixed(3)+"s due to "+Math.round(P)+" ms overlap."),_.splice(x,1),e.len-=L.unit.length;else if(R>=S*u&&P<1e4&&C){var O=Math.round(R/u);o.b.warn("Injecting "+O+" audio frame @ "+(C/a).toFixed(3)+"s due to "+Math.round(1e3*R/a)+" ms gap.");for(var D=0;D<O;D++){var I=Math.max(C,0);(g=k.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o.b.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),g=L.unit.subarray()),_.splice(x,0,{unit:g,pts:I,dts:I}),e.len+=g.length,C+=u,x++}L.pts=L.dts=C,C+=u,x++}else Math.abs(R),L.pts=L.dts=C,C+=u,x++}for(var M=0,F=_.length;M<F;M++){var N=_[M],j=N.unit,B=N.pts;if(void 0!==w)m.duration=Math.round((B-w)/c);else{var U=Math.round(1e3*(B-T)/a),z=0;if(i&&e.isAAC&&U){if(U>0&&U<1e4)z=Math.round((B-T)/u),o.b.log(U+" ms hole between AAC samples detected,filling it"),z>0&&((g=k.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(g=j.subarray()),e.len+=z*g.length);else if(U<-12){o.b.log("drop overlapping AAC sample, expected/parsed/delta:"+(T/a).toFixed(3)+"s/"+(B/a).toFixed(3)+"s/"+-U+"ms"),e.len-=j.byteLength;continue}B=T}if(b=B,!(e.len>0))return;var $=p?e.len:e.len+8;f=p?0:8;try{y=new Uint8Array($)}catch(e){return void this.observer.trigger(r.a.ERROR,{type:n.b.MUX_ERROR,details:n.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:$,reason:"fail allocating audio mdat "+$})}p||(new DataView(y.buffer).setUint32(0,$),y.set(A.types.mdat,4));for(var H=0;H<z;H++)(g=k.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o.b.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),g=j.subarray()),y.set(g,f),f+=g.byteLength,m={size:g.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},E.push(m)}y.set(j,f);var V=j.byteLength;f+=V,m={size:V,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},E.push(m),w=B}var G=0,K=E.length;if(K>=2&&(G=E[K-2].duration,m.duration=G),K){this.nextAudioPts=T=w+c*G,e.len=0,e.samples=E,v=p?new Uint8Array:A.moof(e.sequenceNumber++,b/c,e),e.samples=[];var q=b/a,W=T/a,Y={data1:v,data2:y,startPTS:q,endPTS:W,startDTS:q,endDTS:W,type:"audio",hasAudio:!0,hasVideo:!1,nb:K};return this.observer.trigger(r.a.FRAG_PARSING_DATA,Y),Y}return null}},e.prototype.remuxEmptyAudio=function(e,t,i,r){var n=e.inputTimeScale,s=n/(e.samplerate?e.samplerate:n),a=this.nextAudioPts,l=(void 0!==a?a:r.startDTS*n)+this._initDTS,c=r.endDTS*n+this._initDTS,u=1024*s,d=Math.ceil((c-l)/u),h=k.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(o.b.warn("remux empty Audio"),h){for(var p=[],f=0;f<d;f++){var m=l+f*u;p.push({unit:h,pts:m,dts:m}),e.len+=h.length}e.samples=p,this.remuxAudio(e,t,i)}else o.b.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},e.prototype.remuxID3=function(e,t){var i=e.samples.length,n=void 0,s=e.inputTimeScale,o=this._initPTS,a=this._initDTS;if(i){for(var l=0;l<i;l++)(n=e.samples[l]).pts=(n.pts-o)/s,n.dts=(n.dts-a)/s;this.observer.trigger(r.a.FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[]},e.prototype.remuxText=function(e,t){e.samples.sort((function(e,t){return e.pts-t.pts}));var i=e.samples.length,n=void 0,s=e.inputTimeScale,o=this._initPTS;if(i){for(var a=0;a<i;a++)(n=e.samples[a]).pts=(n.pts-o)/s;this.observer.trigger(r.a.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[]},e.prototype._PTSNormalize=function(e,t){var i=void 0;if(void 0===t)return e;for(i=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=i;return e},e}(),L=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t}return e.prototype.destroy=function(){},e.prototype.resetTimeStamp=function(){},e.prototype.resetInitSegment=function(){},e.prototype.remux=function(e,t,i,n,s,o,a,l){var c=this.observer,u="";e&&(u+="audio"),t&&(u+="video"),c.trigger(r.a.FRAG_PARSING_DATA,{data1:l,startPTS:s,startDTS:s,type:u,hasAudio:!!e,hasVideo:!!t,nb:1,dropped:0}),c.trigger(r.a.FRAG_PARSED)},e}(),P=function(){function e(t,i,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.typeSupported=i,this.config=r,this.vendor=n}return e.prototype.destroy=function(){var e=this.demuxer;e&&e.destroy()},e.prototype.push=function(e,t,i,n,o,a,l,c,u,d,h,p){if(e.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){var f=this.decrypter;null==f&&(f=this.decrypter=new s.a(this.observer,this.config));var m=this,g=void 0;try{g=performance.now()}catch(e){g=Date.now()}f.decrypt(e,t.key.buffer,t.iv.buffer,(function(e){var s=void 0;try{s=performance.now()}catch(e){s=Date.now()}m.observer.trigger(r.a.FRAG_DECRYPTED,{stats:{tstart:g,tdecrypt:s}}),m.pushDecrypted(new Uint8Array(e),t,new Uint8Array(i),n,o,a,l,c,u,d,h,p)}))}else this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(i),n,o,a,l,c,u,d,h,p)},e.prototype.pushDecrypted=function(e,t,i,s,o,a,l,c,u,d,h,p){var f=this.demuxer;if(!f||(l||c)&&!this.probe(e)){for(var m=this.observer,v=this.typeSupported,b=this.config,w=[{demux:T,remux:R},{demux:y.a,remux:L},{demux:g,remux:R},{demux:S,remux:R}],_=0,E=w.length;_<E;_++){var k=w[_],x=k.demux.probe;if(x(e)){var C=this.remuxer=new k.remux(m,b,v,this.vendor);f=new k.demux(m,C,b,v),this.probe=x;break}}if(!f)return void m.trigger(r.a.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=f}var A=this.remuxer;(l||c)&&(f.resetInitSegment(i,s,o,d),A.resetInitSegment()),l&&(f.resetTimeStamp(p),A.resetTimeStamp(p)),"function"==typeof f.setDecryptData&&f.setDecryptData(t),f.append(e,a,u,h)},e}();t.a=P},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={};i.d(r,"newCue",(function(){return dt}));var n=i(3),s=i.n(n),o=i(2),a=i(1),l=i(0),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=new Set(["hlsEventGeneric","hlsHandlerDestroying","hlsHandlerDestroyed"]),d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hls=t,this.onEvent=this.onEvent.bind(this);for(var i=arguments.length,r=Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];this.handledEvents=r,this.useGenericHandler=!0,this.registerListeners()}return e.prototype.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},e.prototype.onHandlerDestroying=function(){},e.prototype.onHandlerDestroyed=function(){},e.prototype.isEventHandler=function(){return"object"===c(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent},e.prototype.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){if(u.has(e))throw new Error("Forbidden event-name: "+e);this.hls.on(e,this.onEvent)}),this)},e.prototype.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){this.hls.off(e,this.onEvent)}),this)},e.prototype.onEvent=function(e,t){this.onEventGeneric(e,t)},e.prototype.onEventGeneric=function(e,t){try{(function(e,t){var i="on"+e.replace("hls","");if("function"!=typeof this[i])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+i+")");return this[i].bind(this,t)}).call(this,e,t).call()}catch(t){l.b.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.hls.trigger(a.a.ERROR,{type:o.b.OTHER_ERROR,details:o.a.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}},e}(),h=d,p=i(7),f=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),m=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.method=null,this.key=null,this.iv=null,this._uri=null}return f(e,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=s.a.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),e}(),g=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),y=function(){function e(){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[],this._elementaryStreams=((t={})[e.ElementaryStreamTypes.AUDIO]=!1,t[e.ElementaryStreamTypes.VIDEO]=!1,t)}return e.prototype.addElementaryStream=function(e){this._elementaryStreams[e]=!0},e.prototype.hasElementaryStream=function(e){return!0===this._elementaryStreams[e]},e.prototype.createInitializationVector=function(e){for(var t=new Uint8Array(16),i=12;i<16;i++)t[i]=e>>8*(15-i)&255;return t},e.prototype.fragmentDecryptdataFromLevelkey=function(e,t){var i=e;return e&&e.method&&e.uri&&!e.iv&&((i=new m).method=e.method,i.baseuri=e.baseuri,i.reluri=e.reluri,i.iv=this.createInitializationVector(t)),i},g(e,[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=s.a.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:"programDateTime",get:function(){return!this._programDateTime&&this.rawProgramDateTime&&(this._programDateTime=new Date(Date.parse(this.rawProgramDateTime))),this._programDateTime}},{key:"byteRange",get:function(){if(!this._byteRange&&!this.rawByteRange)return[];if(this._byteRange)return this._byteRange;var e=[];if(this.rawByteRange){var t=this.rawByteRange.split("@",2);if(1===t.length){var i=this.lastByteRangeEndOffset;e[0]=i||0}else e[0]=parseInt(t[1]);e[1]=parseInt(t[0])+e[0],this._byteRange=e}return e}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata}}],[{key:"ElementaryStreamTypes",get:function(){return{AUDIO:"audio",VIDEO:"video"}}}]),e}(),v=/^(\d+)x(\d+)$/,b=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,w=function(){function e(t){for(var i in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"string"==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(i)&&(this[i]=t[i])}return e.prototype.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},e.prototype.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var i=new Uint8Array(t.length/2),r=0;r<t.length/2;r++)i[r]=parseInt(t.slice(2*r,2*r+2),16);return i}return null},e.prototype.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},e.prototype.decimalFloatingPoint=function(e){return parseFloat(this[e])},e.prototype.enumeratedString=function(e){return this[e]},e.prototype.decimalResolution=function(e){var t=v.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e){var t=void 0,i={};for(b.lastIndex=0;null!==(t=b.exec(e));){var r=t[2];0===r.indexOf('"')&&r.lastIndexOf('"')===r.length-1&&(r=r.slice(1,-1)),i[t[1]]=r}return i},e}(),_={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};function E(e,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}var T=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,S=/#EXT-X-MEDIA:(.*)/g,k=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)(\S+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),x=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.findGroup=function(e,t){if(!e)return null;for(var i=null,r=0;r<e.length;r++){var n=e[r];n.id===t&&(i=n)}return i},e.convertAVC1ToAVCOTI=function(e){var t=void 0,i=e.split(".");return i.length>2?(t=i.shift()+".",t+=parseInt(i.shift()).toString(16),t+=("000"+parseInt(i.shift()).toString(16)).substr(-4)):t=e,t},e.resolve=function(e,t){return s.a.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},e.parseMasterPlaylist=function(t,i){var r=[],n=void 0;function s(e,t){["video","audio"].forEach((function(i){var r=e.filter((function(e){return function(e,t){var i=_[t];return!!i&&!0===i[e.slice(0,4)]}(e,i)}));if(r.length){var n=r.filter((function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)}));t[i+"Codec"]=n.length>0?n[0]:r[0],e=e.filter((function(e){return-1===r.indexOf(e)}))}})),t.unknownCodecs=e}for(T.lastIndex=0;null!=(n=T.exec(t));){var o={},a=o.attrs=new w(n[1]);o.url=e.resolve(n[2],i);var l=a.decimalResolution("RESOLUTION");l&&(o.width=l.width,o.height=l.height),o.bitrate=a.decimalInteger("AVERAGE-BANDWIDTH")||a.decimalInteger("BANDWIDTH"),o.name=a.NAME,s([].concat((a.CODECS||"").split(/[ ,]+/)),o),o.videoCodec&&-1!==o.videoCodec.indexOf("avc1")&&(o.videoCodec=e.convertAVC1ToAVCOTI(o.videoCodec)),r.push(o)}return r},e.parseMasterPlaylistMedia=function(t,i,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=void 0,o=[],a=0;for(S.lastIndex=0;null!==(s=S.exec(t));){var l={},c=new w(s[1]);if(c.TYPE===r){if(l.groupId=c["GROUP-ID"],l.name=c.NAME,l.type=r,l.default="YES"===c.DEFAULT,l.autoselect="YES"===c.AUTOSELECT,l.forced="YES"===c.FORCED,c.URI&&(l.url=e.resolve(c.URI,i)),l.lang=c.LANGUAGE,l.name||(l.name=l.lang),n.length){var u=e.findGroup(n,l.groupId);l.audioCodec=u?u.codec:n[0].codec}l.id=a++,o.push(l)}}return o},e.parseLevelPlaylist=function(e,t,i,r){var n=0,s=0,o={type:null,version:null,url:t,fragments:[],live:!0,startSN:0},a=new m,c=0,u=null,d=new y,h=void 0,p=void 0;for(k.lastIndex=0;null!==(h=k.exec(e));){var f=h[1];if(f){d.duration=parseFloat(f);var g=(" "+h[2]).slice(1);d.title=g||null,d.tagList.push(g?["INF",f,g]:["INF",f])}else if(h[3]){if(!isNaN(d.duration)){var v=n++;d.type=r,d.start=s,d.levelkey=a,d.sn=v,d.level=i,d.cc=c,d.baseurl=t,d.relurl=(" "+h[3]).slice(1),o.programDateTime&&(u?d.rawProgramDateTime?d.pdt=Date.parse(d.rawProgramDateTime):d.pdt=u.pdt+1e3*u.duration:d.pdt=Date.parse(o.programDateTime),d.endPdt=d.pdt+1e3*d.duration),o.fragments.push(d),u=d,s+=d.duration,d=new y}}else if(h[4]){if(d.rawByteRange=(" "+h[4]).slice(1),u){var b=u.byteRangeEndOffset;b&&(d.lastByteRangeEndOffset=b)}}else if(h[5])d.rawProgramDateTime=(" "+h[5]).slice(1),d.tagList.push(["PROGRAM-DATE-TIME",d.rawProgramDateTime]),void 0===o.programDateTime&&(o.programDateTime=new Date(new Date(Date.parse(h[5]))-1e3*s));else{for(h=h[0].match(x),p=1;p<h.length&&void 0===h[p];p++);var _=(" "+h[p+1]).slice(1),E=(" "+h[p+2]).slice(1);switch(h[p]){case"#":d.tagList.push(E?[_,E]:[_]);break;case"PLAYLIST-TYPE":o.type=_.toUpperCase();break;case"MEDIA-SEQUENCE":n=o.startSN=parseInt(_);break;case"TARGETDURATION":o.targetduration=parseFloat(_);break;case"VERSION":o.version=parseInt(_);break;case"EXTM3U":break;case"ENDLIST":o.live=!1;break;case"DIS":c++,d.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":c=parseInt(_);break;case"KEY":var T=new w(_),S=T.enumeratedString("METHOD"),C=T.URI,A=T.hexadecimalInteger("IV");S&&(a=new m,C&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(S)>=0&&(a.method=S,a.baseuri=t,a.reluri=C,a.key=null,a.iv=A));break;case"START":var R=new w(_).decimalFloatingPoint("TIME-OFFSET");isNaN(R)||(o.startTimeOffset=R);break;case"MAP":var L=new w(_);d.relurl=L.URI,d.rawByteRange=L.BYTERANGE,d.baseurl=t,d.level=i,d.type=r,d.sn="initSegment",o.initSegment=d,d=new y;break;default:l.b.warn("line parsed but not handled: "+h)}}}return(d=u)&&!d.relurl&&(o.fragments.pop(),s-=d.duration),o.totalduration=s,o.averagetargetduration=s/o.fragments.length,o.endSN=n-1,o.startCC=o.fragments[0]?o.fragments[0].cc:0,o.endCC=c,!o.initSegment&&o.fragments.length&&o.fragments.every((function(e){return e.relurl.endsWith(".mp4")}))&&(l.b.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(d=new y).relurl=o.fragments[0].relurl,d.baseurl=t,d.level=i,d.type=r,d.sn="initSegment",o.initSegment=d,o.needSidxRanges=!0),o},e}(),A=C,R=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),L={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},P={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"},O=function(e){function t(i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,a.a.MANIFEST_LOADING,a.a.LEVEL_LOADING,a.a.AUDIO_TRACK_LOADING,a.a.SUBTITLE_TRACK_LOADING));return r.loaders={},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.canHaveQualityLevels=function(e){return e!==L.AUDIO_TRACK&&e!==L.SUBTITLE_TRACK},t.mapContextToLevelType=function(e){switch(e.type){case L.AUDIO_TRACK:return P.AUDIO;case L.SUBTITLE_TRACK:return P.SUBTITLE;default:return P.MAIN}},t.getResponseUrl=function(e,t){var i=e.url;return void 0!==i&&0!==i.indexOf("data:")||(i=t.url),i},t.prototype.createInternalLoader=function(e){var t=this.hls.config,i=t.pLoader,r=t.loader,n=new(i||r)(t);return e.loader=n,this.loaders[e.type]=n,n},t.prototype.getInternalLoader=function(e){return this.loaders[e.type]},t.prototype.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},t.prototype.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},t.prototype.destroy=function(){this.destroyInternalLoaders(),e.prototype.destroy.call(this)},t.prototype.onManifestLoading=function(e){this.load(e.url,{type:L.MANIFEST})},t.prototype.onLevelLoading=function(e){this.load(e.url,{type:L.LEVEL,level:e.level,id:e.id})},t.prototype.onAudioTrackLoading=function(e){this.load(e.url,{type:L.AUDIO_TRACK,id:e.id})},t.prototype.onSubtitleTrackLoading=function(e){this.load(e.url,{type:L.SUBTITLE_TRACK,id:e.id})},t.prototype.load=function(e,t){var i=this.hls.config,r=this.getInternalLoader(t);if(r){var n=r.context;if(n&&n.url===e)return l.b.trace("playlist request ongoing"),!1;l.b.warn("aborting previous loader for type: "+t.type),r.abort()}var s,o,a=void 0,c=void 0,u=void 0,d=void 0;switch(t.type){case L.MANIFEST:a=i.manifestLoadingMaxRetry,c=i.manifestLoadingTimeOut,u=i.manifestLoadingRetryDelay,d=i.manifestLoadingMaxRetryTimeout;break;case L.LEVEL:a=0,c=i.levelLoadingTimeOut;break;default:a=i.levelLoadingMaxRetry,c=i.levelLoadingTimeOut,u=i.levelLoadingRetryDelay,d=i.levelLoadingMaxRetryTimeout,l.b.log("Playlist loader for "+t.type+" "+(t.level||t.id))}return r=this.createInternalLoader(t),t.url=e,t.responseType=t.responseType||"",s={timeout:c,maxRetry:a,retryDelay:u,maxRetryDelay:d},o={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},r.load(t,s,o),!0},t.prototype.loadsuccess=function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(i.isSidxRequest)return this._handleSidxRequest(e,i),void this._handlePlaylistLoaded(e,t,i,r);this.resetInternalLoader(i.type);var n=e.data;t.tload=performance.now(),0===n.indexOf("#EXTM3U")?n.indexOf("#EXTINF:")>0||n.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(e,t,i,r):this._handleMasterPlaylist(e,t,i,r):this._handleManifestParsingError(e,i,"no EXTM3U delimiter",r)},t.prototype.loaderror=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._handleNetworkError(t,i)},t.prototype.loadtimeout=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._handleNetworkError(t,i,!0)},t.prototype._handleMasterPlaylist=function(e,i,r,n){var s=this.hls,o=e.data,c=t.getResponseUrl(e,r),u=A.parseMasterPlaylist(o,c);if(u.length){var d=u.map((function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}})),h=A.parseMasterPlaylistMedia(o,c,"AUDIO",d),p=A.parseMasterPlaylistMedia(o,c,"SUBTITLES");if(h.length){var f=!1;h.forEach((function(e){e.url||(f=!0)})),!1===f&&u[0].audioCodec&&!u[0].attrs.AUDIO&&(l.b.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),h.unshift({type:"main",name:"main"}))}s.trigger(a.a.MANIFEST_LOADED,{levels:u,audioTracks:h,subtitles:p,url:c,stats:i,networkDetails:n})}else this._handleManifestParsingError(e,r,"no level found in manifest",n)},t.prototype._handleTrackOrLevelPlaylist=function(e,i,r,n){var s=this.hls,o=r.id,l=r.level,c=r.type,u=t.getResponseUrl(e,r),d=isNaN(l)?isNaN(o)?0:o:l,h=t.mapContextToLevelType(r),p=A.parseLevelPlaylist(e.data,u,d,h);if(p.tload=i.tload,c===L.MANIFEST){var f={url:u,details:p};s.trigger(a.a.MANIFEST_LOADED,{levels:[f],audioTracks:[],url:u,stats:i,networkDetails:n})}if(i.tparsed=performance.now(),p.needSidxRanges){var m=p.initSegment.url;this.load(m,{isSidxRequest:!0,type:c,level:l,levelDetails:p,id:o,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}else r.levelDetails=p,this._handlePlaylistLoaded(e,i,r,n)},t.prototype._handleSidxRequest=function(e,t){var i=p.a.parseSegmentIndex(new Uint8Array(e.data));i.references.forEach((function(e,i){var r=e.info,n=t.levelDetails.fragments[i];0===n.byteRange.length&&(n.rawByteRange=String(1+r.end-r.start)+"@"+String(r.start))})),t.levelDetails.initSegment.rawByteRange=String(i.moovEndOffset)+"@0"},t.prototype._handleManifestParsingError=function(e,t,i,r){this.hls.trigger(a.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:i,networkDetails:r})},t.prototype._handleNetworkError=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=void 0,n=void 0,s=this.getInternalLoader(e);switch(e.type){case L.MANIFEST:r=i?o.a.MANIFEST_LOAD_TIMEOUT:o.a.MANIFEST_LOAD_ERROR,n=!0;break;case L.LEVEL:r=i?o.a.LEVEL_LOAD_TIMEOUT:o.a.LEVEL_LOAD_ERROR,n=!1;break;case L.AUDIO_TRACK:r=i?o.a.AUDIO_TRACK_LOAD_TIMEOUT:o.a.AUDIO_TRACK_LOAD_ERROR,n=!1;break;default:n=!1}s&&(s.abort(),this.resetInternalLoader(e.type)),this.hls.trigger(a.a.ERROR,{type:o.b.NETWORK_ERROR,details:r,fatal:n,url:s.url,loader:s,context:e,networkDetails:t})},t.prototype._handlePlaylistLoaded=function(e,i,r,n){var s=r.type,o=r.level,l=r.id,c=r.levelDetails;if(c.targetduration)if(t.canHaveQualityLevels(r.type))this.hls.trigger(a.a.LEVEL_LOADED,{details:c,level:o||0,id:l||0,stats:i,networkDetails:n});else switch(s){case L.AUDIO_TRACK:this.hls.trigger(a.a.AUDIO_TRACK_LOADED,{details:c,id:l,stats:i,networkDetails:n});break;case L.SUBTITLE_TRACK:this.hls.trigger(a.a.SUBTITLE_TRACK_LOADED,{details:c,id:l,stats:i,networkDetails:n})}else this._handleManifestParsingError(e,r,"invalid target duration",n)},R(t,null,[{key:"ContextType",get:function(){return L}},{key:"LevelType",get:function(){return P}}]),t}(h),D=O,I=function(e){function t(i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,a.a.FRAG_LOADING));return r.loaders={},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.destroy=function(){var t=this.loaders;for(var i in t){var r=t[i];r&&r.destroy()}this.loaders={},e.prototype.destroy.call(this)},t.prototype.onFragLoading=function(e){var t=e.frag,i=t.type,r=this.loaders,n=this.hls.config,s=n.fLoader,o=n.loader;t.loaded=0;var a=r[i];a&&(l.b.warn("abort previous fragment loader for type: "+i),a.abort()),a=r[i]=t.loader=n.fLoader?new s(n):new o(n);var c,u,d=void 0;d={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var h=t.byteRangeStartOffset,p=t.byteRangeEndOffset;isNaN(h)||isNaN(p)||(d.rangeStart=h,d.rangeEnd=p),c={timeout:n.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:n.fragLoadingMaxRetryTimeout},u={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},a.load(d,c,u)},t.prototype.loadsuccess=function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=e.data,s=i.frag;s.loader=void 0,this.loaders[s.type]=void 0,this.hls.trigger(a.a.FRAG_LOADED,{payload:n,frag:s,stats:t,networkDetails:r})},t.prototype.loaderror=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=t.loader;r&&r.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:i})},t.prototype.loadtimeout=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=t.loader;r&&r.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:i})},t.prototype.loadprogress=function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=t.frag;n.loaded=e.loaded,this.hls.trigger(a.a.FRAG_LOAD_PROGRESS,{frag:n,stats:e,networkDetails:r})},t}(h),M=I,F=function(e){function t(i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,a.a.KEY_LOADING));return r.loaders={},r.decryptkey=null,r.decrypturl=null,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.destroy=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},h.prototype.destroy.call(this)},t.prototype.onKeyLoading=function(e){var t=e.frag,i=t.type,r=this.loaders[i],n=t.decryptdata,s=n.uri;if(s!==this.decrypturl||null===this.decryptkey){var o,c,u,d=this.hls.config;r&&(l.b.warn("abort previous key loader for type:"+i),r.abort()),t.loader=this.loaders[i]=new d.loader(d),this.decrypturl=s,this.decryptkey=null,o={url:s,frag:t,responseType:"arraybuffer"},c={timeout:d.fragLoadingTimeOut,maxRetry:d.fragLoadingMaxRetry,retryDelay:d.fragLoadingRetryDelay,maxRetryDelay:d.fragLoadingMaxRetryTimeout},u={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(o,c,u)}else this.decryptkey&&(n.key=this.decryptkey,this.hls.trigger(a.a.KEY_LOADED,{frag:t}))},t.prototype.loadsuccess=function(e,t,i){var r=i.frag;this.decryptkey=r.decryptdata.key=new Uint8Array(e.data),r.loader=void 0,this.loaders[r.type]=void 0,this.hls.trigger(a.a.KEY_LOADED,{frag:r})},t.prototype.loaderror=function(e,t){var i=t.frag,r=i.loader;r&&r.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.KEY_LOAD_ERROR,fatal:!1,frag:i,response:e})},t.prototype.loadtimeout=function(e,t){var i=t.frag,r=i.loader;r&&r.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.KEY_LOAD_TIMEOUT,fatal:!1,frag:i})},t}(h),N={search:function(e,t){for(var i=0,r=e.length-1,n=null,s=null;i<=r;){var o=t(s=e[n=(i+r)/2|0]);if(o>0)i=n+1;else{if(!(o<0))return s;r=n-1}}return null}},j={isBuffered:function(e,t){try{if(e)for(var i=e.buffered,r=0;r<i.length;r++)if(t>=i.start(r)&&t<=i.end(r))return!0}catch(e){}return!1},bufferInfo:function(e,t,i){try{if(e){var r=e.buffered,n=[],s=void 0;for(s=0;s<r.length;s++)n.push({start:r.start(s),end:r.end(s)});return this.bufferedInfo(n,t,i)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}},bufferedInfo:function(e,t,i){var r=[],n=void 0,s=void 0,o=void 0,a=void 0,l=void 0;for(e.sort((function(e,t){var i=e.start-t.start;return i||t.end-e.end})),l=0;l<e.length;l++){var c=r.length;if(c){var u=r[c-1].end;e[l].start-u<i?e[l].end>u&&(r[c-1].end=e[l].end):r.push(e[l])}else r.push(e[l])}for(l=0,n=0,s=o=t;l<r.length;l++){var d=r[l].start,h=r[l].end;if(t+i>=d&&t<h)s=d,n=(o=h)-t;else if(t+i<d){a=d;break}}return{len:n,start:s,end:o,nextStart:a}}},B=i(8),U=i(6),z=i.n(U),$=i(10),H=i.n($);function V(){if("undefined"!=typeof window)return window.MediaSource||window.WebKitMediaSource}var G=V(),K=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hls=t,this.id=i;var r=this.observer=new z.a,n=t.config;r.trigger=function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];r.emit.apply(r,[e,e].concat(i))},r.off=function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];r.removeListener.apply(r,[e].concat(i))};var s=function(e,i){(i=i||{}).frag=this.frag,i.id=this.id,t.trigger(e,i)}.bind(this);r.on(a.a.FRAG_DECRYPTED,s),r.on(a.a.FRAG_PARSING_INIT_SEGMENT,s),r.on(a.a.FRAG_PARSING_DATA,s),r.on(a.a.FRAG_PARSED,s),r.on(a.a.ERROR,s),r.on(a.a.FRAG_PARSING_METADATA,s),r.on(a.a.FRAG_PARSING_USERDATA,s),r.on(a.a.INIT_PTS_FOUND,s);var c={mp4:G.isTypeSupported("video/mp4"),mpeg:G.isTypeSupported("audio/mpeg"),mp3:G.isTypeSupported('audio/mp4; codecs="mp3"')},u=navigator.vendor;if(n.enableWorker&&"undefined"!=typeof Worker){l.b.log("demuxing in webworker");var d=void 0;try{d=this.w=H()(11),this.onwmsg=this.onWorkerMessage.bind(this),d.addEventListener("message",this.onwmsg),d.onerror=function(e){t.trigger(a.a.ERROR,{type:o.b.OTHER_ERROR,details:o.a.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})},d.postMessage({cmd:"init",typeSupported:c,vendor:u,id:i,config:JSON.stringify(n)})}catch(e){l.b.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),d&&URL.revokeObjectURL(d.objectURL),this.demuxer=new B.a(r,c,n,u),this.w=void 0}}else this.demuxer=new B.a(r,c,n,u)}return e.prototype.destroy=function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var i=this.observer;i&&(i.removeAllListeners(),this.observer=null)},e.prototype.push=function(e,t,i,r,n,s,o,a){var c=this.w,u=isNaN(n.startDTS)?n.start:n.startDTS,d=n.decryptdata,h=this.frag,p=!(h&&n.cc===h.cc),f=!(h&&n.level===h.level),m=h&&n.sn===h.sn+1,g=!f&&m;if(p&&l.b.log(this.id+":discontinuity detected"),f&&l.b.log(this.id+":switch detected"),this.frag=n,c)c.postMessage({cmd:"demux",data:e,decryptdata:d,initSegment:t,audioCodec:i,videoCodec:r,timeOffset:u,discontinuity:p,trackSwitch:f,contiguous:g,duration:s,accurateTimeOffset:o,defaultInitPTS:a},e instanceof ArrayBuffer?[e]:[]);else{var y=this.demuxer;y&&y.push(e,d,t,i,r,u,p,f,g,s,o,a)}},e.prototype.onWorkerMessage=function(e){var t=e.data,i=this.hls;switch(t.event){case"init":URL.revokeObjectURL(this.w.objectURL);break;case a.a.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,i.trigger(t.event,t.data)}},e}(),q=K,W="NOT_LOADED",Y="APPENDING",X="PARTIAL",Q="OK",J=function(e){function t(i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,a.a.BUFFER_APPENDED,a.a.FRAG_BUFFERED,a.a.FRAG_LOADED));return r.bufferPadding=.2,r.fragments=Object.create(null),r.timeRanges=Object.create(null),r.config=i.config,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.destroy=function(){this.fragments=null,this.timeRanges=null,this.config=null,h.prototype.destroy.call(this),e.prototype.destroy.call(this)},t.prototype.getBufferedFrag=function(e,t){var i=this.fragments,r=Object.keys(i).filter((function(r){var n=i[r];if(n.body.type!==t)return!1;if(!n.buffered)return!1;var s=n.body;return s.startPTS<=e&&e<=s.endPTS}));if(0===r.length)return null;var n=r.pop();return i[n].body},t.prototype.detectEvictedFragments=function(e,t){var i=this,r=void 0,n=void 0;Object.keys(this.fragments).forEach((function(s){var o=i.fragments[s];if(!0===o.buffered){var a=o.range[e];if(a){r=a.time;for(var l=0;l<r.length;l++)if(n=r[l],!1===i.isTimeBuffered(n.startPTS,n.endPTS,t)){i.removeFragment(o.body);break}}}}))},t.prototype.detectPartialFragments=function(e){var t=this,i=this.getFragmentKey(e),r=this.fragments[i];r&&(r.buffered=!0,Object.keys(this.timeRanges).forEach((function(i){if(!0===e.hasElementaryStream(i)){var n=t.timeRanges[i];r.range[i]=t.getBufferedTimes(e.startPTS,e.endPTS,n)}})))},t.prototype.getBufferedTimes=function(e,t,i){for(var r=[],n=void 0,s=void 0,o=!1,a=0;a<i.length;a++){if(n=i.start(a)-this.bufferPadding,s=i.end(a)+this.bufferPadding,e>=n&&t<=s){r.push({startPTS:Math.max(e,i.start(a)),endPTS:Math.min(t,i.end(a))});break}if(e<s&&t>n)r.push({startPTS:Math.max(e,i.start(a)),endPTS:Math.min(t,i.end(a))}),o=!0;else if(t<=n)break}return{time:r,partial:o}},t.prototype.getFragmentKey=function(e){return e.type+"_"+e.level+"_"+e.sn},t.prototype.getPartialFragment=function(e){var t=this,i=void 0,r=void 0,n=void 0,s=null,o=0;return Object.keys(this.fragments).forEach((function(a){var l=t.fragments[a];t.isPartial(l)&&(r=l.body.startPTS-t.bufferPadding,n=l.body.endPTS+t.bufferPadding,e>=r&&e<=n&&(i=Math.min(e-r,n-e),o<=i&&(s=l.body,o=i)))})),s},t.prototype.getState=function(e){var t=this.getFragmentKey(e),i=this.fragments[t],r=W;return void 0!==i&&(r=i.buffered?!0===this.isPartial(i)?X:Q:Y),r},t.prototype.isPartial=function(e){return!0===e.buffered&&(void 0!==e.range.video&&!0===e.range.video.partial||void 0!==e.range.audio&&!0===e.range.audio.partial)},t.prototype.isTimeBuffered=function(e,t,i){for(var r=void 0,n=void 0,s=0;s<i.length;s++){if(r=i.start(s)-this.bufferPadding,n=i.end(s)+this.bufferPadding,e>=r&&t<=n)return!0;if(t<=r)return!1}return!1},t.prototype.onFragLoaded=function(e){var t=e.frag;if(!isNaN(t.sn)){var i=this.getFragmentKey(t),r={body:t,range:Object.create(null),buffered:!1};this.fragments[i]=r}},t.prototype.onBufferAppended=function(e){var t=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach((function(e){var i=t.timeRanges[e];t.detectEvictedFragments(e,i)}))},t.prototype.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},t.prototype.hasFragment=function(e){var t=this.getFragmentKey(e);return void 0!==this.fragments[t]},t.prototype.removeFragment=function(e){var t=this.getFragmentKey(e);delete this.fragments[t]},t.prototype.removeAllFragments=function(){this.fragments=Object.create(null)},t}(h);function Z(e,t,i){var r=e[t],n=e[i],s=n.startPTS;isNaN(s)?n.start=i>t?r.start+r.duration:Math.max(r.start-n.duration,0):i>t?(r.duration=s-r.start,r.duration<0&&l.b.warn("negative duration computed for frag "+r.sn+",level "+r.level+", there should be some duration drift between playlist and fragment!")):(n.duration=r.start-s,n.duration<0&&l.b.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!"))}function ee(e,t,i,r,n,s){var o=i;if(!isNaN(t.startPTS)){var a=Math.abs(t.startPTS-i);isNaN(t.deltaPTS)?t.deltaPTS=a:t.deltaPTS=Math.max(a,t.deltaPTS),o=Math.max(i,t.startPTS),i=Math.min(i,t.startPTS),r=Math.max(r,t.endPTS),n=Math.min(n,t.startDTS),s=Math.max(s,t.endDTS)}var l=i-t.start;t.start=t.startPTS=i,t.maxStartPTS=o,t.endPTS=r,t.startDTS=n,t.endDTS=s,t.duration=r-i;var c=t.sn;if(!e||c<e.startSN||c>e.endSN)return 0;var u,d=void 0,h=void 0;for(u=c-e.startSN,(d=e.fragments)[u]=t,h=u;h>0;h--)Z(d,h,h-1);for(h=u;h<d.length-1;h++)Z(d,h,h+1);return e.PTSKnown=!0,l}function te(e,t){var i=Math.max(e.startSN,t.startSN)-t.startSN,r=Math.min(e.endSN,t.endSN)-t.startSN,n=t.startSN-e.startSN,s=e.fragments,o=t.fragments,a=0,c=void 0;if(t.initSegment&&e.initSegment&&(t.initSegment=e.initSegment),r<i)t.PTSKnown=!1;else{for(var u=i;u<=r;u++){var d=s[n+u],h=o[u];h&&d&&(a=d.cc-h.cc,isNaN(d.startPTS)||(h.start=h.startPTS=d.startPTS,h.endPTS=d.endPTS,h.duration=d.duration,h.backtracked=d.backtracked,h.dropped=d.dropped,c=h))}if(a)for(l.b.log("discontinuity sliding from playlist, take drift into account"),u=0;u<o.length;u++)o[u].cc+=a;if(c)ee(t,c,c.startPTS,c.endPTS,c.startDTS,c.endDTS);else if(n>=0&&n<s.length){var p=s[n].start;for(u=0;u<o.length;u++)o[u].start+=p}t.PTSKnown=e.PTSKnown}}var ie={toString:function(e){for(var t="",i=e.length,r=0;r<i;r++)t+="["+e.start(r).toFixed(3)+","+e.end(r).toFixed(3)+"]";return t}};function re(e,t){t.fragments.forEach((function(t){if(t){var i=t.start+e;t.start=t.startPTS=i,t.endPTS=i+t.duration}})),t.PTSKnown=!0}function ne(e,t,i){if(function(e,t,i){var r=!1;return t&&t.details&&i&&(i.endCC>i.startCC||e&&e.cc<i.startCC)&&(r=!0),r}(e,t,i)){var r=function(e,t){var i=e.fragments,r=t.fragments;if(r.length&&i.length){var n=function(e,t){for(var i=null,r=0;r<e.length;r+=1){var n=e[r];if(n&&n.cc===t){i=n;break}}return i}(i,r[0].cc);if(n&&(!n||n.startPTS))return n;l.b.log("No frag in previous level to align on")}else l.b.log("No fragments to align")}(t.details,i);r&&(l.b.log("Adjusting PTS using last level due to CC increase within current level"),re(r.start,i))}if(!1===i.PTSKnown&&t&&t.details&&t.details.fragments&&t.details.fragments.length){var n=t.details.programDateTime,s=(i.programDateTime-n)/1e3+t.details.fragments[0].start;isNaN(s)||(l.b.log("adjusting PTS using programDateTime delta, sliding:"+s.toFixed(3)),re(s,i))}}var se=function(e){function t(i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call.apply(e,[this,i].concat(n)));return o._tickInterval=null,o._tickCallCount=0,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.destroy=function(){this.clearInterval(),e.prototype.destroy.call(this)},t.prototype.hasInterval=function(){return null!==this._tickInterval},t.prototype.setInterval=function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return!this._tickInterval&&(this._tickInterval=setInterval(this.tick.bind(this,!1),e),!0)})),t.prototype.clearInterval=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){return!!this._tickInterval&&(clearInterval(this._tickInterval),this._tickInterval=null,!0)})),t.prototype.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&setTimeout(this.tick.bind(this),0),this._tickCallCount=0)},t.prototype.doTick=function(){throw new Error("TaskLoop is abstract and `doLoop` must be implemented")},t}(h),oe=se,ae=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),le="STOPPED",ce="IDLE",ue="KEY_LOADING",de="FRAG_LOADING",he="FRAG_LOADING_WAITING_RETRY",pe="WAITING_LEVEL",fe="PARSING",me="PARSED",ge="BUFFER_FLUSHING",ye="ENDED",ve="ERROR",be=function(e){function t(i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,a.a.MEDIA_ATTACHED,a.a.MEDIA_DETACHING,a.a.MANIFEST_LOADING,a.a.MANIFEST_PARSED,a.a.LEVEL_LOADED,a.a.KEY_LOADED,a.a.FRAG_LOADED,a.a.FRAG_LOAD_EMERGENCY_ABORTED,a.a.FRAG_PARSING_INIT_SEGMENT,a.a.FRAG_PARSING_DATA,a.a.FRAG_PARSED,a.a.ERROR,a.a.AUDIO_TRACK_SWITCHING,a.a.AUDIO_TRACK_SWITCHED,a.a.BUFFER_CREATED,a.a.BUFFER_APPENDED,a.a.BUFFER_FLUSHED));return n.fragmentTracker=r,n.config=i.config,n.audioCodecSwap=!1,n._state=le,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.onHandlerDestroying=function(){this.stopLoad()},t.prototype.onHandlerDestroyed=function(){this.state=le,this.fragmentTracker=null},t.prototype.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,i=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var r=i.startLevel;-1===r&&(r=0,this.bitrateTest=!0),this.level=i.nextLoadLevel=r,this.loadedmetadata=!1}t>0&&-1===e&&(l.b.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=ce,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=le},t.prototype.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.clearInterval(),this.state=le,this.forceStartLoad=!1},t.prototype.doTick=function(){switch(this.state){case ge:this.fragLoadError=0;break;case ce:this._doTickIdle();break;case pe:var e=this.levels[this.level];e&&e.details&&(this.state=ce);break;case he:var t=performance.now(),i=this.retryDate;(!i||t>=i||this.media&&this.media.seeking)&&(l.b.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=ce)}this._checkBuffer(),this._checkFragmentChanged()},t.prototype._doTickIdle=function(){var e=this.hls,t=e.config,i=this.media;if(void 0!==this.levelLastLoaded&&(i||!this.startFragRequested&&t.startFragPrefetch)){var r=void 0;r=this.loadedmetadata?i.currentTime:this.nextLoadPosition;var n=e.nextLoadLevel,s=this.levels[n];if(s){var o=s.bitrate,c=void 0;c=o?Math.max(8*t.maxBufferSize/o,t.maxBufferLength):t.maxBufferLength,c=Math.min(c,t.maxMaxBufferLength);var u=j.bufferInfo(this.mediaBuffer?this.mediaBuffer:i,r,t.maxBufferHole),d=u.len;if(!(d>=c)){l.b.trace("buffer length of "+d.toFixed(3)+" is below max of "+c.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=n;var h=s.details;if(void 0===h||!0===h.live&&this.levelLastLoaded!==n)this.state=pe;else{var p=this.fragPrevious;if(!h.live&&p&&!p.backtracked&&p.sn===h.endSN&&!u.nextStart&&Math.min(i.duration,p.start+p.duration)-Math.max(u.end,p.start)<=Math.max(.2,p.duration)){var f={};return this.altAudio&&(f.type="video"),this.hls.trigger(a.a.BUFFER_EOS,f),void(this.state=ye)}this._fetchPayloadOrEos(r,u,h)}}}}},t.prototype._fetchPayloadOrEos=function(e,t,i){var r=this.fragPrevious,n=this.level,s=i.fragments,o=s.length;if(0!==o){var a=s[0].start,c=s[o-1].start+s[o-1].duration,u=t.end,d=void 0;if(i.initSegment&&!i.initSegment.data)d=i.initSegment;else if(i.live){var h=this.config.initialLiveManifestSize;if(o<h)return void l.b.warn("Can not start playback of a level, reason: not enough fragments "+o+" < "+h);if(null===(d=this._ensureFragmentAtLivePoint(i,u,a,c,r,s,o)))return}else u<a&&(d=s[0]);d||(d=this._findFragment(a,r,o,s,u,c,i)),d&&this._loadFragmentOrKey(d,n,i,e,u)}},t.prototype._ensureFragmentAtLivePoint=function(e,t,i,r,n,s,o){var a=this.hls.config,c=this.media,u=void 0,d=void 0!==a.liveMaxLatencyDuration?a.liveMaxLatencyDuration:a.liveMaxLatencyDurationCount*e.targetduration;if(t<Math.max(i-a.maxFragLookUpTolerance,r-d)){var h=this.liveSyncPosition=this.computeLivePosition(i,e);l.b.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+h.toFixed(3)),t=h,c&&c.readyState&&c.duration>h&&(c.currentTime=h),this.nextLoadPosition=h}if(e.PTSKnown&&t>r&&c&&c.readyState)return null;if(this.startFragRequested&&!e.PTSKnown){if(n)if(e.programDateTime)u=this._findFragmentByPDT(s,n.endPdt+1);else{var p=n.sn+1;if(p>=e.startSN&&p<=e.endSN){var f=s[p-e.startSN];n.cc===f.cc&&(u=f,l.b.log("live playlist, switching playlist, load frag with next SN: "+u.sn))}u||(u=N.search(s,(function(e){return n.cc-e.cc})))&&l.b.log("live playlist, switching playlist, load frag with same CC: "+u.sn)}u||(u=s[Math.min(o-1,Math.round(o/2))],l.b.log("live playlist, switching playlist, unknown, load middle frag : "+u.sn))}return u},t.prototype._findFragmentByPDT=function(e,t){if(!e||void 0===t)return null;if(t<e[0].pdt)return null;if(t>=e[e.length-1].endPdt)return null;for(var i=0;i<e.length;++i){var r=e[i];if(t<r.endPdt)return r}return null},t.prototype._findFragmentBySN=function(e,t,i,r){var n=void 0,s=this.hls.config.maxFragLookUpTolerance,o=e?t[e.sn-t[0].sn+1]:void 0,a=function(e){var t=Math.min(s,e.duration+(e.deltaPTS?e.deltaPTS:0));return e.start+e.duration-t<=i?1:e.start-t>i&&e.start?-1:0};return i<r&&(i>r-s&&(s=0),n=o&&!a(o)?o:N.search(t,a)),n},t.prototype._findFragment=function(e,t,i,r,n,s,o){var a=this.hls.config,c=void 0,u=void 0;if(u=n<s?o.programDateTime?this._findFragmentByPDT(r,1e3*n+(o.programDateTime?Date.parse(o.programDateTime):0)-1e3*e):this._findFragmentBySN(t,r,n,s):r[i-1]){var d=(c=u).sn-o.startSN,h=t&&c.level===t.level,p=r[d-1],f=r[d+1];if(t&&c.sn===t.sn)if(h&&!c.backtracked)if(c.sn<o.endSN){var m=t.deltaPTS;m&&m>a.maxBufferHole&&t.dropped&&d?(c=p,l.b.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this")):(c=f,l.b.log("SN just loaded, load next one: "+c.sn))}else c=null;else c.backtracked&&(f&&f.backtracked?(l.b.warn("Already backtracked from fragment "+f.sn+", will not backtrack to fragment "+c.sn+". Loading fragment "+f.sn),c=f):(l.b.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),c.dropped=0,p?(c=p).backtracked=!0:d&&(c=null)))}return c},t.prototype._loadFragmentOrKey=function(e,t,i,r,n){if(e.decryptdata&&null!=e.decryptdata.uri&&null==e.decryptdata.key)l.b.log("Loading key for "+e.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+t),this.state=ue,this.hls.trigger(a.a.KEY_LOADING,{frag:e});else{l.b.log("Loading "+e.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+t+", currentTime:"+r.toFixed(3)+",bufferEnd:"+n.toFixed(3));var s=this.fragmentTracker.getState(e);this.fragCurrent=e,this.startFragRequested=!0,isNaN(e.sn)||e.bitrateTest||(this.nextLoadPosition=e.start+e.duration),e.backtracked||s===W?(e.autoLevel=this.hls.autoLevelEnabled,e.bitrateTest=this.bitrateTest,this.hls.trigger(a.a.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new q(this.hls,"main")),this.state=de):s===Y&&this._reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e)}},t.prototype.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,D.LevelType.MAIN)},t.prototype.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},t.prototype._checkFragmentChanged=function(){var e=void 0,t=void 0,i=this.media;if(i&&i.readyState&&!1===i.seeking&&((t=i.currentTime)>i.playbackRate*this.lastCurrentTime&&(this.lastCurrentTime=t),j.isBuffered(i,t)?e=this.getBufferedFrag(t):j.isBuffered(i,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var r=e;if(r!==this.fragPlaying){this.hls.trigger(a.a.FRAG_CHANGED,{frag:r});var n=r.level;this.fragPlaying&&this.fragPlaying.level===n||this.hls.trigger(a.a.LEVEL_SWITCHED,{level:n}),this.fragPlaying=r}}},t.prototype.immediateLevelSwitch=function(){if(l.b.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e=this.media,t=void 0;e?(t=e.paused,e.pause()):t=!0,this.previouslyPaused=t}var i=this.fragCurrent;i&&i.loader&&i.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},t.prototype.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,j.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},t.prototype.nextLevelSwitch=function(){var e=this.media;if(e&&e.readyState){var t,i=void 0,r=void 0;if((t=this.getBufferedFrag(e.currentTime))&&t.startPTS>1&&this.flushMainBuffer(0,t.startPTS-1),e.paused)i=0;else{var n=this.hls.nextLoadLevel,s=this.levels[n],o=this.fragLastKbps;i=o&&this.fragCurrent?this.fragCurrent.duration*s.bitrate/(1e3*o)+1:0}if((r=this.getBufferedFrag(e.currentTime+i))&&(r=this.followingBufferedFrag(r))){var a=this.fragCurrent;a&&a.loader&&a.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(r.maxStartPTS,Number.POSITIVE_INFINITY)}}},t.prototype.flushMainBuffer=function(e,t){this.state=ge;var i={startOffset:e,endOffset:t};this.altAudio&&(i.type="video"),this.hls.trigger(a.a.BUFFER_FLUSHING,i)},t.prototype.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var i=this.config;this.levels&&i.autoStartLoad&&this.hls.startLoad(i.startPosition)},t.prototype.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(l.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach((function(e){e.details&&e.details.fragments.forEach((function(e){e.backtracked=void 0}))})),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},t.prototype.onMediaSeeking=function(){var e=this.media,t=e?e.currentTime:void 0,i=this.config;isNaN(t)||l.b.log("media seeking to "+t.toFixed(3));var r=this.mediaBuffer?this.mediaBuffer:e,n=j.bufferInfo(r,t,this.config.maxBufferHole);if(this.state===de){var s=this.fragCurrent;if(0===n.len&&s){var o=i.maxFragLookUpTolerance,a=s.start-o,c=s.start+s.duration+o;t<a||t>c?(s.loader&&(l.b.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),s.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=ce):l.b.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===ye&&(0===n.len&&(this.fragPrevious=0),this.state=ce);e&&(this.lastCurrentTime=t),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=t),this.tick()},t.prototype.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:void 0;isNaN(t)||l.b.log("media seeked to "+t.toFixed(3)),this.tick()},t.prototype.onMediaEnded=function(){l.b.log("media ended"),this.startPosition=this.lastCurrentTime=0},t.prototype.onManifestLoading=function(){l.b.log("trigger BUFFER_RESET"),this.hls.trigger(a.a.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},t.prototype.onManifestParsed=function(e){var t=!1,i=!1,r=void 0;e.levels.forEach((function(e){(r=e.audioCodec)&&(-1!==r.indexOf("mp4a.40.2")&&(t=!0),-1!==r.indexOf("mp4a.40.5")&&(i=!0))})),this.audioCodecSwitch=t&&i,this.audioCodecSwitch&&l.b.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1;var n=this.config;(n.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(n.startPosition)},t.prototype.onLevelLoaded=function(e){var t=e.details,i=e.level,r=this.levels[this.levelLastLoaded],n=this.levels[i],s=t.totalduration,o=0;if(l.b.log("level "+i+" loaded ["+t.startSN+","+t.endSN+"],duration:"+s),t.live){var c=n.details;c&&t.fragments.length>0?(te(c,t),o=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(o,c),t.PTSKnown&&!isNaN(o)?l.b.log("live playlist sliding:"+o.toFixed(3)):(l.b.log("live playlist - outdated PTS, unknown sliding"),ne(this.fragPrevious,r,t))):(l.b.log("live playlist - first load, unknown sliding"),t.PTSKnown=!1,ne(this.fragPrevious,r,t))}else t.PTSKnown=!1;if(n.details=t,this.levelLastLoaded=i,this.hls.trigger(a.a.LEVEL_UPDATED,{details:t,level:i}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var u=t.startTimeOffset;isNaN(u)?t.live?(this.startPosition=this.computeLivePosition(o,t),l.b.log("configure startPosition to "+this.startPosition)):this.startPosition=0:(u<0&&(l.b.log("negative start time offset "+u+", count from end of last fragment"),u=o+s+u),l.b.log("start time offset found in playlist, adjust startPosition to "+u),this.startPosition=u),this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===pe&&(this.state=ce),this.tick()},t.prototype.onKeyLoaded=function(){this.state===ue&&(this.state=ce,this.tick())},t.prototype.onFragLoaded=function(e){var t=this.fragCurrent,i=e.frag;if(this.state===de&&t&&"main"===i.type&&i.level===t.level&&i.sn===t.sn){var r=e.stats,n=this.levels[t.level],s=n.details;if(l.b.log("Loaded  "+t.sn+" of ["+s.startSN+" ,"+s.endSN+"],level "+t.level),this.bitrateTest=!1,this.stats=r,!0===i.bitrateTest&&this.hls.nextLoadLevel)this.state=ce,this.startFragRequested=!1,r.tparsed=r.tbuffered=performance.now(),this.hls.trigger(a.a.FRAG_BUFFERED,{stats:r,frag:t,id:"main"}),this.tick();else if("initSegment"===i.sn)this.state=ce,r.tparsed=r.tbuffered=performance.now(),s.initSegment.data=e.payload,this.hls.trigger(a.a.FRAG_BUFFERED,{stats:r,frag:t,id:"main"}),this.tick();else{this.state=fe;var o=s.totalduration,c=t.level,u=t.sn,d=this.config.defaultAudioCodec||n.audioCodec;this.audioCodecSwap&&(l.b.log("swapping playlist audio codec"),void 0===d&&(d=this.lastAudioCodec),d&&(d=-1!==d.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),this.pendingBuffering=!0,this.appended=!1,l.b.log("Parsing "+u+" of ["+s.startSN+" ,"+s.endSN+"],level "+c+", cc "+t.cc);var h=this.demuxer;h||(h=this.demuxer=new q(this.hls,"main"));var p=this.media,f=!(p&&p.seeking)&&(s.PTSKnown||!s.live),m=s.initSegment?s.initSegment.data:[];h.push(e.payload,m,d,n.videoCodec,t,o,f,void 0)}}this.fragLoadError=0},t.prototype.onFragParsingInitSegment=function(e){var t=this.fragCurrent,i=e.frag;if(t&&"main"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===fe){var r=e.tracks,n=void 0,s=void 0;if(r.audio&&this.altAudio&&delete r.audio,s=r.audio){var o=this.levels[this.level].audioCodec,c=navigator.userAgent.toLowerCase();o&&this.audioCodecSwap&&(l.b.log("swapping playlist audio codec"),o=-1!==o.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==s.metadata.channelCount&&-1===c.indexOf("firefox")&&(o="mp4a.40.5"),-1!==c.indexOf("android")&&"audio/mpeg"!==s.container&&(o="mp4a.40.2",l.b.log("Android: force audio codec to "+o)),s.levelCodec=o,s.id=e.id}for(n in(s=r.video)&&(s.levelCodec=this.levels[this.level].videoCodec,s.id=e.id),this.hls.trigger(a.a.BUFFER_CODECS,r),r){s=r[n],l.b.log("main track:"+n+",container:"+s.container+",codecs[level/parsed]=["+s.levelCodec+"/"+s.codec+"]");var u=s.initSegment;u&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(a.a.BUFFER_APPENDING,{type:n,data:u,parent:"main",content:"initSegment"}))}this.tick()}},t.prototype.onFragParsingData=function(e){var t=this,i=this.fragCurrent,r=e.frag;if(i&&"main"===e.id&&r.sn===i.sn&&r.level===i.level&&("audio"!==e.type||!this.altAudio)&&this.state===fe){var n=this.levels[this.level],s=i;if(isNaN(e.endPTS)&&(e.endPTS=e.startPTS+i.duration,e.endDTS=e.startDTS+i.duration),!0===e.hasAudio&&s.addElementaryStream(y.ElementaryStreamTypes.AUDIO),!0===e.hasVideo&&s.addElementaryStream(y.ElementaryStreamTypes.VIDEO),l.b.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0)),"video"===e.type)if(s.dropped=e.dropped,s.dropped)if(s.backtracked)l.b.warn("Already backtracked on this fragment, appending with the gap");else{var o=n.details;if(!o||s.sn!==o.startSN)return l.b.warn("missing video frame(s), backtracking fragment"),this.fragmentTracker.removeFragment(s),s.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=ce,this.fragPrevious=s,void this.tick();l.b.warn("missing video frame(s) on first frag, appending with gap")}else s.backtracked=!1;var c=ee(n.details,s,e.startPTS,e.endPTS,e.startDTS,e.endDTS),u=this.hls;u.trigger(a.a.LEVEL_PTS_UPDATED,{details:n.details,level:this.level,drift:c,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach((function(i){i&&i.length&&t.state===fe&&(t.appended=!0,t.pendingBuffering=!0,u.trigger(a.a.BUFFER_APPENDING,{type:e.type,data:i,parent:"main",content:"data"}))})),this.tick()}},t.prototype.onFragParsed=function(e){var t=this.fragCurrent,i=e.frag;t&&"main"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===fe&&(this.stats.tparsed=performance.now(),this.state=me,this._checkAppendedParsed())},t.prototype.onAudioTrackSwitching=function(e){var t=!!e.url,i=e.id;if(!t){if(this.mediaBuffer!==this.media){l.b.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var r=this.fragCurrent;r.loader&&(l.b.log("switching to main audio track, cancel main fragment load"),r.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=ce}var n=this.hls;n.trigger(a.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),n.trigger(a.a.AUDIO_TRACK_SWITCHED,{id:i}),this.altAudio=!1}},t.prototype.onAudioTrackSwitched=function(e){var t=e.id,i=!!this.hls.audioTracks[t].url;if(i){var r=this.videoBuffer;r&&this.mediaBuffer!==r&&(l.b.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=r)}this.altAudio=i,this.tick()},t.prototype.onBufferCreated=function(e){var t=e.tracks,i=void 0,r=void 0,n=!1;for(var s in t){var o=t[s];"main"===o.id?(r=s,i=o,"video"===s&&(this.videoBuffer=t[s].buffer)):n=!0}n&&i?(l.b.log("alternate track found, use "+r+".buffered to schedule main fragment loading"),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media},t.prototype.onBufferAppended=function(e){if("main"===e.parent){var t=this.state;t!==fe&&t!==me||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},t.prototype._checkAppendedParsed=function(){if(!(this.state!==me||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;l.b.log("main buffered : "+ie.toString(t.buffered)),this.fragPrevious=e;var i=this.stats;i.tbuffered=performance.now(),this.fragLastKbps=Math.round(8*i.total/(i.tbuffered-i.tfirst)),this.hls.trigger(a.a.FRAG_BUFFERED,{stats:i,frag:e,id:"main"}),this.state=ce}this.tick()}},t.prototype.onError=function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var i=!!this.media&&j.isBuffered(this.media,this.media.currentTime)&&j.isBuffered(this.media,this.media.currentTime+.5);switch(e.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:case o.a.KEY_LOAD_ERROR:case o.a.KEY_LOAD_TIMEOUT:if(!e.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var r=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);l.b.warn("mediaController: frag loading failed, retry in "+r+" ms"),this.retryDate=performance.now()+r,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=he}else l.b.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=ve;break;case o.a.LEVEL_LOAD_ERROR:case o.a.LEVEL_LOAD_TIMEOUT:this.state!==ve&&(e.fatal?(this.state=ve,l.b.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==pe||(this.state=ce));break;case o.a.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==fe&&this.state!==me||(i?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=ce):(l.b.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},t.prototype._reduceMaxBufferLength=function(e){var t=this.config;return t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,l.b.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},t.prototype._checkBuffer=function(){var e=this.media,t=this.config;if(e&&e.readyState){var i=e.currentTime,r=(this.mediaBuffer?this.mediaBuffer:e).buffered;if(!this.loadedmetadata&&r.length){this.loadedmetadata=!0;var n=e.seeking?i:this.startPosition;i!==n&&(l.b.log("target start position not buffered, seek to buffered.start(0) "+n+" from current time"+i+" "),e.currentTime=n)}else if(this.immediateSwitch)this.immediateLevelSwitchEnd();else{var s=j.bufferInfo(e,i,t.maxBufferHole),c=!(e.paused&&e.readyState>1||e.ended||0===e.buffered.length);if(i!==this.lastCurrentTime)this.stallReported&&(l.b.warn("playback not stuck anymore @"+i+", after "+Math.round(performance.now()-this.stalled)+"ms"),this.stallReported=!1),this.stalled=void 0,this.nudgeRetry=0;else if(c){var u=performance.now(),d=this.hls;if(this.stalled){var h=u-this.stalled,p=s.len,f=this.nudgeRetry||0,m=this.fragmentTracker.getPartialFragment(i);if(null!==m)for(var g=0,y=0;y<e.buffered.length;y++){var v=e.buffered.start(y);if(i>=g&&i<v)return e.currentTime=Math.max(v,e.currentTime+.1),l.b.warn("skipping hole, adjusting currentTime from "+i+" to "+e.currentTime),this.stalled=void 0,void d.trigger(a.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+i+" to "+e.currentTime,frag:m});g=e.buffered.end(y)}if(p>.5&&h>1e3*t.highBufferWatchdogPeriod)if(this.stallReported||(this.stallReported=!0,l.b.warn("playback stalling in high buffer @"+i),d.trigger(a.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:p})),this.stalled=void 0,this.nudgeRetry=++f,f<t.nudgeMaxRetry){var b=e.currentTime,w=b+f*t.nudgeOffset;l.b.log("adjust currentTime from "+b+" to "+w),e.currentTime=w,d.trigger(a.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_NUDGE_ON_STALL,fatal:!1})}else l.b.error("still stuck in high buffer @"+i+" after "+t.nudgeMaxRetry+", raise fatal error"),d.trigger(a.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_STALLED_ERROR,fatal:!0})}else this.stalled=u,this.stallReported=!1}}}},t.prototype.onFragLoadEmergencyAborted=function(){this.state=ce,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},t.prototype.onBufferFlushed=function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;this.fragmentTracker.detectEvictedFragments(y.ElementaryStreamTypes.VIDEO,e.buffered),this.state=ce,this.fragPrevious=null},t.prototype.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},t.prototype.computeLivePosition=function(e,t){var i=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-i)},ae(t,[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,l.b.log("main stream:"+t+"->"+e),this.hls.trigger(a.a.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}]),t}(oe),we=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_e=function(e){function t(i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,a.a.MANIFEST_LOADED,a.a.LEVEL_LOADED,a.a.FRAG_LOADED,a.a.ERROR));return r.canload=!1,r.currentLevelIndex=null,r.manualLevelIndex=-1,r.timer=null,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.onHandlerDestroying=function(){this.cleanTimer(),this.manualLevelIndex=-1},t.prototype.cleanTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},t.prototype.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach((function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)})),null!==this.timer&&this.loadLevel()},t.prototype.stopLoad=function(){this.canload=!1},t.prototype.onManifestLoaded=function(e){var t=[],i=void 0,r={},n=null,s=!1,c=!1,u=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),d=[];if(e.levels.forEach((function(e){e.loadError=0,e.fragmentError=!1,s=s||!!e.videoCodec,c=c||!!e.audioCodec||!(!e.attrs||!e.attrs.AUDIO),!0===u&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),void 0===(n=r[e.bitrate])?(e.url=[e.url],e.urlId=0,r[e.bitrate]=e,t.push(e)):n.url.push(e.url)})),!0===s&&!0===c&&(t=t.filter((function(e){return!!e.videoCodec}))),t=t.filter((function(e){var t=e.audioCodec,i=e.videoCodec;return(!t||E(t))&&(!i||E(i))})),e.audioTracks&&(d=e.audioTracks.filter((function(e){return!e.audioCodec||E(e.audioCodec,"audio")}))),t.length>0){i=t[0].bitrate,t.sort((function(e,t){return e.bitrate-t.bitrate})),this._levels=t;for(var h=0;h<t.length;h++)if(t[h].bitrate===i){this._firstLevel=h,l.b.log("manifest loaded,"+t.length+" level(s) found, first bitrate:"+i);break}this.hls.trigger(a.a.MANIFEST_PARSED,{levels:t,audioTracks:d,firstLevel:this._firstLevel,stats:e.stats,audio:c,video:s,altAudio:d.length>0})}else this.hls.trigger(a.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},t.prototype.setLevelInternal=function(e){var t=this._levels,i=this.hls;if(e>=0&&e<t.length){if(this.cleanTimer(),this.currentLevelIndex!==e){l.b.log("switching to level "+e),this.currentLevelIndex=e;var r=t[e];r.level=e,i.trigger(a.a.LEVEL_SWITCHING,r)}var n=t[e],s=n.details;if(!s||!0===s.live){var c=n.urlId;i.trigger(a.a.LEVEL_LOADING,{url:n.url[c],level:e,id:c})}}else i.trigger(a.a.ERROR,{type:o.b.OTHER_ERROR,details:o.a.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},t.prototype.onError=function(e){if(!0!==e.fatal){var t=!1,i=!1,r=void 0;switch(e.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:case o.a.KEY_LOAD_ERROR:case o.a.KEY_LOAD_TIMEOUT:r=e.frag.level,i=!0;break;case o.a.LEVEL_LOAD_ERROR:case o.a.LEVEL_LOAD_TIMEOUT:r=e.context.level,t=!0;break;case o.a.REMUX_ALLOC_ERROR:r=e.level,t=!0}void 0!==r&&this.recoverLevel(e,r,t,i)}else e.type===o.b.NETWORK_ERROR&&this.cleanTimer()},t.prototype.recoverLevel=function(e,t,i,r){var n=this,s=this.hls.config,o=e.details,a=this._levels[t],c=void 0,u=void 0,d=void 0;if(a.loadError++,a.fragmentError=r,!0===i){if(!(this.levelRetryCount+1<=s.levelLoadingMaxRetry))return l.b.error("level controller, cannot recover from "+o+" error"),this.currentLevelIndex=null,this.cleanTimer(),void(e.fatal=!0);u=Math.min(Math.pow(2,this.levelRetryCount)*s.levelLoadingRetryDelay,s.levelLoadingMaxRetryTimeout),this.timer=setTimeout((function(){return n.loadLevel()}),u),e.levelRetry=!0,this.levelRetryCount++,l.b.warn("level controller, "+o+", retry in "+u+" ms, current retry count is "+this.levelRetryCount)}!0!==i&&!0!==r||((c=a.url.length)>1&&a.loadError<c?(l.b.warn("level controller, "+o+" for level "+t+": switching to redundant stream id "+a.urlId),a.urlId=(a.urlId+1)%c,a.details=void 0):-1===this.manualLevelIndex?(d=0===t?this._levels.length-1:t-1,l.b.warn("level controller, "+o+": switch to "+d),this.hls.nextAutoLevel=this.currentLevelIndex=d):!0===r&&(l.b.warn("level controller, "+o+": reload a fragment"),this.currentLevelIndex=null))},t.prototype.onFragLoaded=function(e){var t=e.frag;if(void 0!==t&&"main"===t.type){var i=this._levels[t.level];void 0!==i&&(i.fragmentError=!1,i.loadError=0,this.levelRetryCount=0)}},t.prototype.onLevelLoaded=function(e){var t=this,i=e.level;if(i===this.currentLevelIndex){var r=this._levels[i];!1===r.fragmentError&&(r.loadError=0,this.levelRetryCount=0);var n=e.details;if(n.live){var s=1e3*(n.averagetargetduration?n.averagetargetduration:n.targetduration),o=s,a=r.details;a&&n.endSN===a.endSN&&(o/=2,l.b.log("same live playlist, reload twice faster")),o-=performance.now()-e.stats.trequest,o=Math.max(s/2,Math.round(o)),l.b.log("live playlist, reload in "+Math.round(o)+" ms"),this.timer=setTimeout((function(){return t.loadLevel()}),o)}else this.cleanTimer()}},t.prototype.loadLevel=function(){var e=void 0,t=void 0;null!==this.currentLevelIndex&&!0===this.canload&&void 0!==(e=this._levels[this.currentLevelIndex])&&e.url.length>0&&(t=e.urlId,this.hls.trigger(a.a.LEVEL_LOADING,{url:e.url[t],level:this.currentLevelIndex,id:t}))},we(t,[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(e=Math.min(e,t.length-1),this.currentLevelIndex===e&&void 0!==t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}]),t}(h),Ee=i(4);function Te(e,t){var i=null;try{i=new window.Event("addtrack")}catch(e){(i=document.createEvent("Event")).initEvent("addtrack",!1,!1)}i.track=e,t.dispatchEvent(i)}function Se(e){if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}var ke=function(e){function t(i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,a.a.MEDIA_ATTACHED,a.a.MEDIA_DETACHING,a.a.FRAG_PARSING_METADATA));return r.id3Track=void 0,r.media=void 0,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.destroy=function(){h.prototype.destroy.call(this)},t.prototype.onMediaAttached=function(e){this.media=e.media,this.media},t.prototype.onMediaDetaching=function(){Se(this.id3Track),this.id3Track=void 0,this.media=void 0},t.prototype.getID3Track=function(e){for(var t=0;t<e.length;t++){var i=e[t];if("metadata"===i.kind&&"id3"===i.label)return Te(i,this.media),i}return this.media.addTextTrack("metadata","id3")},t.prototype.onFragParsingMetadata=function(e){var t=e.frag,i=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var r=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,n=0;n<i.length;n++){var s=Ee.a.getID3Frames(i[n].data);if(s){var o=i[n].pts,a=n<i.length-1?i[n+1].pts:t.endPTS;o===a&&(a+=1e-4);for(var l=0;l<s.length;l++){var c=s[l];if(!Ee.a.isTimeStampFrame(c)){var u=new r(o,a,"");u.value=c,this.id3Track.addCue(u)}}}}},t}(h),xe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=0,this.totalWeight_=0}return e.prototype.sample=function(e,t){var i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e},e.prototype.getTotalWeight=function(){return this.totalWeight_},e.prototype.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_},e}(),Ce=function(){function e(t,i,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hls=t,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new xe(i),this.fast_=new xe(r)}return e.prototype.sample=function(e,t){var i=8e3*t/(e=Math.max(e,this.minDelayMs_)),r=e/1e3;this.fast_.sample(r,i),this.slow_.sample(r,i)},e.prototype.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},e.prototype.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},e.prototype.destroy=function(){},e}(),Ae=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),Re=function(e){function t(i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,a.a.FRAG_LOADING,a.a.FRAG_LOADED,a.a.FRAG_BUFFERED,a.a.ERROR));return r.lastLoadedFragLevel=0,r._nextAutoLevel=-1,r.hls=i,r.timer=null,r._bwEstimator=null,r.onCheck=r._abandonRulesCheck.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.destroy=function(){this.clearTimer(),h.prototype.destroy.call(this)},t.prototype.onFragLoading=function(e){var t=e.frag;if("main"===t.type){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this._bwEstimator){var i=this.hls,r=e.frag.level,n=i.levels[r].details.live,s=i.config,o=void 0,a=void 0;n?(o=s.abrEwmaFastLive,a=s.abrEwmaSlowLive):(o=s.abrEwmaFastVoD,a=s.abrEwmaSlowVoD),this._bwEstimator=new Ce(i,a,o,s.abrEwmaDefaultEstimate)}this.fragCurrent=t}},t.prototype._abandonRulesCheck=function(){var e=this.hls,t=e.media,i=this.fragCurrent,r=i.loader,n=e.minAutoLevel;if(!r||r.stats&&r.stats.aborted)return l.b.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var s=r.stats;if(t&&s&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&i.autoLevel&&i.level){var o=performance.now()-s.trequest,c=Math.abs(t.playbackRate);if(o>500*i.duration/c){var u=e.levels,d=Math.max(1,s.bw?s.bw/8:1e3*s.loaded/o),h=u[i.level],p=h.realBitrate?Math.max(h.realBitrate,h.bitrate):h.bitrate,f=s.total?s.total:Math.max(s.loaded,Math.round(i.duration*p/8)),m=t.currentTime,g=(f-s.loaded)/d,y=(j.bufferInfo(t,m,e.config.maxBufferHole).end-m)/c;if(y<2*i.duration/c&&g>y){var v=void 0,b=void 0;for(b=i.level-1;b>n;b--){var w=u[b].realBitrate?Math.max(u[b].realBitrate,u[b].bitrate):u[b].bitrate;if((v=i.duration*w/(6.4*d))<y)break}v<g&&(l.b.warn("loading too slow, abort fragment loading and switch to level "+b+":fragLoadedDelay["+b+"]<fragLoadedDelay["+(i.level-1)+"];bufferStarvationDelay:"+v.toFixed(1)+"<"+g.toFixed(1)+":"+y.toFixed(1)),e.nextLoadLevel=b,this._bwEstimator.sample(o,s.loaded),r.abort(),this.clearTimer(),e.trigger(a.a.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,stats:s}))}}}},t.prototype.onFragLoaded=function(e){var t=e.frag;if("main"===t.type&&!isNaN(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var i=this.hls.levels[t.level],r=(i.loaded?i.loaded.bytes:0)+e.stats.loaded,n=(i.loaded?i.loaded.duration:0)+e.frag.duration;i.loaded={bytes:r,duration:n},i.realBitrate=Math.round(8*r/n)}if(e.frag.bitrateTest){var s=e.stats;s.tparsed=s.tbuffered=s.tload,this.onFragBuffered(e)}}},t.prototype.onFragBuffered=function(e){var t=e.stats,i=e.frag;if(!(!0===t.aborted||"main"!==i.type||isNaN(i.sn)||i.bitrateTest&&t.tload!==t.tbuffered)){var r=t.tparsed-t.trequest;l.b.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(r,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),i.bitrateTest?this.bitrateTestDelay=r/1e3:this.bitrateTestDelay=0}},t.prototype.onError=function(e){switch(e.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:this.clearTimer()}},t.prototype.clearTimer=function(){clearInterval(this.timer),this.timer=null},t.prototype._findBestLevel=function(e,t,i,r,n,s,o,a,c){for(var u=n;u>=r;u--){var d=c[u].details,h=d?d.totalduration/d.fragments.length:t,p=!!d&&d.live,f=void 0;f=u<=e?o*i:a*i;var m=c[u].realBitrate?Math.max(c[u].realBitrate,c[u].bitrate):c[u].bitrate,g=m*h/f;if(l.b.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(f)+"/"+m+"/"+h+"/"+s+"/"+g),f>m&&(!g||p&&!this.bitrateTestDelay||g<s))return u}return-1},Ae(t,[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var i=this._nextABRAutoLevel;return-1!==e&&(i=Math.min(e,i)),i},set:function(e){this._nextAutoLevel=e}},{key:"_nextABRAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,i=e.levels,r=e.config,n=e.minAutoLevel,s=e.media,o=this.lastLoadedFragLevel,a=this.fragCurrent?this.fragCurrent.duration:0,c=s?s.currentTime:0,u=s&&0!==s.playbackRate?Math.abs(s.playbackRate):1,d=this._bwEstimator?this._bwEstimator.getEstimate():r.abrEwmaDefaultEstimate,h=(j.bufferInfo(s,c,r.maxBufferHole).end-c)/u,p=this._findBestLevel(o,a,d,n,t,h,r.abrBandWidthFactor,r.abrBandWidthUpFactor,i);if(p>=0)return p;l.b.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var f=a?Math.min(a,r.maxStarvationDelay):r.maxStarvationDelay,m=r.abrBandWidthFactor,g=r.abrBandWidthUpFactor;if(0===h){var y=this.bitrateTestDelay;y&&(f=(a?Math.min(a,r.maxLoadingDelay):r.maxLoadingDelay)-y,l.b.trace("bitrate test took "+Math.round(1e3*y)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*f)+" ms"),m=g=1)}return p=this._findBestLevel(o,a,d,n,t,h+f,m,g,i),Math.max(p,0)}}]),t}(h),Le=V(),Pe=function(e){function t(i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,a.a.MEDIA_ATTACHING,a.a.MEDIA_DETACHING,a.a.MANIFEST_PARSED,a.a.BUFFER_RESET,a.a.BUFFER_APPENDING,a.a.BUFFER_CODECS,a.a.BUFFER_EOS,a.a.BUFFER_FLUSHING,a.a.LEVEL_PTS_UPDATED,a.a.LEVEL_UPDATED));return r._msDuration=null,r._levelDuration=null,r._live=null,r._objectUrl=null,r.onsbue=r.onSBUpdateEnd.bind(r),r.onsbe=r.onSBUpdateError.bind(r),r.pendingTracks={},r.tracks={},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.destroy=function(){h.prototype.destroy.call(this)},t.prototype.onLevelPtsUpdated=function(e){var t=e.type,i=this.tracks.audio;if("audio"===t&&i&&"audio/mpeg"===i.container){var r=this.sourceBuffer.audio;if(Math.abs(r.timestampOffset-e.start)>.1){var n=r.updating;try{r.abort()}catch(e){n=!0,l.b.warn("can not abort audio buffer: "+e)}n?this.audioTimestampOffset=e.start:(l.b.warn("change mpeg audio timestamp offset from "+r.timestampOffset+" to "+e.start),r.timestampOffset=e.start)}}},t.prototype.onManifestParsed=function(e){var t=e.audio,i=e.video||e.levels.length&&e.audio,r=0;e.altAudio&&(t||i)&&(r=(t?1:0)+(i?1:0),l.b.log(r+" sourceBuffer(s) expected")),this.sourceBufferNb=r},t.prototype.onMediaAttaching=function(e){var t=this.media=e.media;if(t){var i=this.mediaSource=new Le;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),i.addEventListener("sourceopen",this.onmso),i.addEventListener("sourceended",this.onmse),i.addEventListener("sourceclose",this.onmsc),t.src=URL.createObjectURL(i),this._objectUrl=t.src}},t.prototype.onMediaDetaching=function(){l.b.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){l.b.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc),this.media&&(URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):l.b.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(a.a.MEDIA_DETACHED)},t.prototype.onMediaSourceOpen=function(){l.b.log("media source opened"),this.hls.trigger(a.a.MEDIA_ATTACHED,{media:this.media});var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()},t.prototype.checkPendingTracks=function(){var e=this.pendingTracks,t=Object.keys(e).length;t&&(this.sourceBufferNb<=t||0===this.sourceBufferNb)&&(this.createSourceBuffers(e),this.pendingTracks={},this.doAppending())},t.prototype.onMediaSourceClose=function(){l.b.log("media source closed")},t.prototype.onMediaSourceEnded=function(){l.b.log("media source ended")},t.prototype.onSBUpdateEnd=function(){if(this.audioTimestampOffset){var e=this.sourceBuffer.audio;l.b.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+this.audioTimestampOffset),e.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var t=this.parent,i=this.segments.reduce((function(e,i){return i.parent===t?e+1:e}),0),r={},n=this.sourceBuffer;for(var s in n)r[s]=n[s].buffered;this.hls.trigger(a.a.BUFFER_APPENDED,{parent:t,pending:i,timeRanges:r}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration()},t.prototype.onSBUpdateError=function(e){l.b.error("sourceBuffer error:",e),this.hls.trigger(a.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_APPENDING_ERROR,fatal:!1})},t.prototype.onBufferReset=function(){var e=this.sourceBuffer;for(var t in e){var i=e[t];try{this.mediaSource.removeSourceBuffer(i),i.removeEventListener("updateend",this.onsbue),i.removeEventListener("error",this.onsbe)}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},t.prototype.onBufferCodecs=function(e){if(0===Object.keys(this.sourceBuffer).length){for(var t in e)this.pendingTracks[t]=e[t];var i=this.mediaSource;i&&"open"===i.readyState&&this.checkPendingTracks()}},t.prototype.createSourceBuffers=function(e){var t=this.sourceBuffer,i=this.mediaSource;for(var r in e)if(!t[r]){var n=e[r],s=n.levelCodec||n.codec,c=n.container+";codecs="+s;l.b.log("creating sourceBuffer("+c+")");try{var u=t[r]=i.addSourceBuffer(c);u.addEventListener("updateend",this.onsbue),u.addEventListener("error",this.onsbe),this.tracks[r]={codec:s,container:n.container},n.buffer=u}catch(e){l.b.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(a.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:c})}}this.hls.trigger(a.a.BUFFER_CREATED,{tracks:e})},t.prototype.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},t.prototype.onBufferAppendFail=function(e){l.b.error("sourceBuffer error:",e.event),this.hls.trigger(a.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_APPENDING_ERROR,fatal:!1})},t.prototype.onBufferEos=function(e){var t=this.sourceBuffer,i=e.type;for(var r in t)i&&r!==i||t[r].ended||(t[r].ended=!0,l.b.log(r+" sourceBuffer now EOS"));this.checkEos()},t.prototype.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var i in e){var r=e[i];if(!r.ended)return;if(r.updating)return void(this._needsEos=!0)}l.b.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){l.b.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},t.prototype.onBufferFlushing=function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}),this.flushBufferCounter=0,this.doFlush()},t.prototype.onLevelUpdated=function(e){var t=e.details;t.fragments.length>0&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._live=t.live,this.updateMediaElementDuration())},t.prototype.updateMediaElementDuration=function(){var e,t=this.hls.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var i in this.sourceBuffer)if(!0===this.sourceBuffer[i].updating)return;e=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===t.liveDurationInfinity?(l.b.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>e||e===1/0||isNaN(e))&&(l.b.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},t.prototype.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,i=this.sourceBuffer;try{for(var r in i)t+=i[r].buffered.length}catch(e){l.b.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(a.a.BUFFER_FLUSHED)}},t.prototype.doAppending=function(){var e=this.hls,t=this.sourceBuffer,i=this.segments;if(Object.keys(t).length){if(this.media.error)return this.segments=[],void l.b.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(i&&i.length){var r=i.shift();try{var n=t[r.type];n?n.updating?i.unshift(r):(n.ended=!1,this.parent=r.parent,n.appendBuffer(r.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(t){l.b.error("error while trying to append buffer:"+t.message),i.unshift(r);var s={type:o.b.MEDIA_ERROR,parent:r.parent};22!==t.code?(this.appendError?this.appendError++:this.appendError=1,s.details=o.a.BUFFER_APPEND_ERROR,this.appendError>e.config.appendErrorMaxRetry?(l.b.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),i=[],s.fatal=!0,e.trigger(a.a.ERROR,s)):(s.fatal=!1,e.trigger(a.a.ERROR,s))):(this.segments=[],s.details=o.a.BUFFER_FULL_ERROR,s.fatal=!1,e.trigger(a.a.ERROR,s))}}}},t.prototype.flushBuffer=function(e,t,i){var r=void 0,n=void 0,s=void 0,o=void 0,a=void 0,c=void 0,u=this.sourceBuffer;if(Object.keys(u).length){if(l.b.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+e+"/"+t),this.flushBufferCounter<this.appended){for(var d in u)if(!i||d===i){if((r=u[d]).ended=!1,r.updating)return l.b.warn("cannot flush, sb updating in progress"),!1;try{for(n=0;n<r.buffered.length;n++)if(s=r.buffered.start(n),o=r.buffered.end(n),-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&t===Number.POSITIVE_INFINITY?(a=e,c=t):(a=Math.max(s,e),c=Math.min(o,t)),Math.min(c,o)-a>.5)return this.flushBufferCounter++,l.b.log("flush "+d+" ["+a+","+c+"], of ["+s+","+o+"], pos:"+this.media.currentTime),r.remove(a,c),!1}catch(e){l.b.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else l.b.warn("abort flushing too many retries");l.b.log("buffer flushed")}return!0},t}(h),Oe=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),De=function(e){function t(i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,a.a.FPS_DROP_LEVEL_CAPPING,a.a.MEDIA_ATTACHING,a.a.MANIFEST_PARSED))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=this.restrictedLevels=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))},t.prototype.onFpsDropLevelCapping=function(e){t.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},t.prototype.onMediaAttaching=function(e){this.media=e.media instanceof HTMLVideoElement?e.media:null},t.prototype.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],t.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=e.levels,t.firstLevel=this.getMaxLevel(e.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},t.prototype.detectPlayerSize=function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},t.prototype.getMaxLevel=function(e){var i=this;if(!this.levels)return-1;var r=this.levels.filter((function(r,n){return t.isLevelAllowed(n,i.restrictedLevels)&&n<=e}));return t.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)},t.isLevelAllowed=function(e){return-1===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).indexOf(e)},t.getMaxLevelByMediaSize=function(e,t,i){if(!e||e&&!e.length)return-1;for(var r,n,s=e.length-1,o=0;o<e.length;o+=1){var a=e[o];if((a.width>=t||a.height>=i)&&(r=a,!(n=e[o+1])||r.width!==n.width||r.height!==n.height)){s=o;break}}return s},Oe(t,[{key:"mediaWidth",get:function(){var e=void 0,i=this.media;return i&&(e=i.width||i.clientWidth||i.offsetWidth,e*=t.contentScaleFactor),e}},{key:"mediaHeight",get:function(){var e=void 0,i=this.media;return i&&(e=i.height||i.clientHeight||i.offsetHeight,e*=t.contentScaleFactor),e}}],[{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}}]),t}(h),Ie=De,Me=function(e){function t(i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,a.a.MEDIA_ATTACHING))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},t.prototype.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},t.prototype.checkFPS=function(e,t,i){var r=performance.now();if(t){if(this.lastTime){var n=r-this.lastTime,s=i-this.lastDroppedFrames,o=t-this.lastDecodedFrames,c=1e3*s/n,u=this.hls;if(u.trigger(a.a.FPS_DROP,{currentDropped:s,currentDecoded:o,totalDroppedFrames:i}),c>0&&s>u.config.fpsDroppedMonitoringThreshold*o){var d=u.currentLevel;l.b.warn("drop FPS ratio greater than max allowed value for currentLevel: "+d),d>0&&(-1===u.autoLevelCapping||u.autoLevelCapping>=d)&&(d-=1,u.trigger(a.a.FPS_DROP_LEVEL_CAPPING,{level:d,droppedLevel:u.currentLevel}),u.autoLevelCapping=d,u.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=i,this.lastDecodedFrames=t}},t.prototype.checkFPSInterval=function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},t}(h),Fe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}return e.prototype.destroy=function(){this.abort(),this.loader=null},e.prototype.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},e.prototype.load=function(e,t,i){this.context=e,this.config=t,this.callbacks=i,this.stats={trequest:performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},e.prototype.loadInternal=function(){var e=void 0,t=this.context;e=this.loader=new XMLHttpRequest;var i=this.stats;i.tfirst=0,i.loaded=0;var r=this.xhrSetup;try{if(r)try{r(e,t.url)}catch(i){e.open("GET",t.url,!0),r(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(i){return void this.callbacks.onError({code:e.status,text:i.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()},e.prototype.readystatechange=function(e){var t=e.currentTarget,i=t.readyState,r=this.stats,n=this.context,s=this.config;if(!r.aborted&&i>=2)if(window.clearTimeout(this.requestTimeout),0===r.tfirst&&(r.tfirst=Math.max(performance.now(),r.trequest)),4===i){var o=t.status;if(o>=200&&o<300){r.tload=Math.max(r.tfirst,performance.now());var a=void 0,c=void 0;c="arraybuffer"===n.responseType?(a=t.response).byteLength:(a=t.responseText).length,r.loaded=r.total=c;var u={url:t.responseURL,data:a};this.callbacks.onSuccess(u,r,n,t)}else r.retry>=s.maxRetry||o>=400&&o<499?(l.b.error(o+" while loading "+n.url),this.callbacks.onError({code:o,text:t.statusText},n,t)):(l.b.warn(o+" while loading "+n.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,s.maxRetryDelay),r.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),s.timeout)},e.prototype.loadtimeout=function(){l.b.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},e.prototype.loadprogress=function(e){var t=e.currentTarget,i=this.stats;i.loaded=e.loaded,e.lengthComputable&&(i.total=e.total);var r=this.callbacks.onProgress;r&&r(i,this.context,null,t)},e}(),Ne=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),je=function(e){function t(i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,a.a.MANIFEST_LOADING,a.a.MANIFEST_PARSED,a.a.AUDIO_TRACK_LOADED,a.a.ERROR));return r.ticks=0,r.ontick=r.tick.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.destroy=function(){this.cleanTimer(),h.prototype.destroy.call(this)},t.prototype.cleanTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},t.prototype.tick=function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)},t.prototype.doTick=function(){this.updateTrack(this.trackId)},t.prototype.onError=function(e){e.fatal&&e.type===o.b.NETWORK_ERROR&&this.cleanTimer()},t.prototype.onManifestLoading=function(){this.tracks=[],this.trackId=-1},t.prototype.onManifestParsed=function(e){var t=this,i=e.audioTracks||[],r=!1;this.tracks=i,this.hls.trigger(a.a.AUDIO_TRACKS_UPDATED,{audioTracks:i});var n=0;i.forEach((function(e){if(e.default&&!r)return t.audioTrack=n,void(r=!0);n++})),!1===r&&i.length&&(l.b.log("no default audio track defined, use first audio track as default"),this.audioTrack=0)},t.prototype.onAudioTrackLoaded=function(e){e.id<this.tracks.length&&(l.b.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.timer&&(this.timer=setInterval(this.ontick,1e3*e.details.targetduration)),!e.details.live&&this.timer&&this.cleanTimer())},t.prototype.setAudioTrackInternal=function(e){if(e>=0&&e<this.tracks.length){this.cleanTimer(),this.trackId=e,l.b.log("switching to audioTrack "+e);var t=this.tracks[e],i=this.hls,r=t.type,n=t.url,s={id:e,type:r,url:n};i.trigger(a.a.AUDIO_TRACK_SWITCHING,s);var o=t.details;!n||void 0!==o&&!0!==o.live||(l.b.log("(re)loading playlist for audioTrack "+e),i.trigger(a.a.AUDIO_TRACK_LOADING,{url:n,id:e}))}},t.prototype.updateTrack=function(e){if(e>=0&&e<this.tracks.length){this.cleanTimer(),this.trackId=e,l.b.log("updating audioTrack "+e);var t=this.tracks[e],i=t.url,r=t.details;!i||void 0!==r&&!0!==r.live||(l.b.log("(re)loading playlist for audioTrack "+e),this.hls.trigger(a.a.AUDIO_TRACK_LOADING,{url:i,id:e}))}},Ne(t,[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this.trackId},set:function(e){this.trackId===e&&void 0!==this.tracks[e].details||this.setAudioTrackInternal(e)}}]),t}(h),Be=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),Ue="STOPPED",ze="STARTING",$e="IDLE",He="PAUSED",Ve="KEY_LOADING",Ge="FRAG_LOADING",Ke="FRAG_LOADING_WAITING_RETRY",qe="WAITING_TRACK",We="PARSING",Ye="PARSED",Xe="BUFFER_FLUSHING",Qe="ENDED",Je="ERROR",Ze="WAITING_INIT_PTS",et=function(e){function t(i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,a.a.MEDIA_ATTACHED,a.a.MEDIA_DETACHING,a.a.AUDIO_TRACKS_UPDATED,a.a.AUDIO_TRACK_SWITCHING,a.a.AUDIO_TRACK_LOADED,a.a.KEY_LOADED,a.a.FRAG_LOADED,a.a.FRAG_PARSING_INIT_SEGMENT,a.a.FRAG_PARSING_DATA,a.a.FRAG_PARSED,a.a.ERROR,a.a.BUFFER_RESET,a.a.BUFFER_CREATED,a.a.BUFFER_APPENDED,a.a.BUFFER_FLUSHED,a.a.INIT_PTS_FOUND));return n.fragmentTracker=r,n.config=i.config,n.audioCodecSwap=!1,n._state=Ue,n.initPTS=[],n.waitingFragment=null,n.videoTrackCC=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.onHandlerDestroying=function(){this.stopLoad()},t.prototype.onHandlerDestroyed=function(){this.state=Ue,this.fragmentTracker=null},t.prototype.onInitPtsFound=function(e){var t=e.id,i=e.frag.cc,r=e.initPTS;"main"===t&&(this.initPTS[i]=r,this.videoTrackCC=i,l.b.log("InitPTS for cc: "+i+" found from video track: "+r),this.state===Ze&&this.tick())},t.prototype.startLoad=function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,t>0&&-1===e?(l.b.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=$e):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=ze),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=Ue},t.prototype.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=Ue},t.prototype.doTick=function(){var e=void 0,t=void 0,i=void 0,r=this.hls,n=r.config;switch(this.state){case Je:case He:case Xe:break;case ze:this.state=qe,this.loadedmetadata=!1;break;case $e:var s=this.tracks;if(!s)break;if(!this.media&&(this.startFragRequested||!n.startFragPrefetch))break;if(this.loadedmetadata)e=this.media.currentTime;else if(void 0===(e=this.nextLoadPosition))break;var o=this.mediaBuffer?this.mediaBuffer:this.media,c=this.videoBuffer?this.videoBuffer:this.media,u=j.bufferInfo(o,e,n.maxBufferHole),d=j.bufferInfo(c,e,n.maxBufferHole),h=u.len,p=u.end,f=this.fragPrevious,m=Math.min(n.maxBufferLength,n.maxMaxBufferLength),g=Math.max(m,d.len),y=this.audioSwitch,v=this.trackId;if((h<g||y)&&v<s.length){if(void 0===(i=s[v].details)){this.state=qe;break}if(!y&&!i.live&&f&&f.sn===i.endSN&&!u.nextStart&&(!this.media.seeking||this.media.duration-p<f.duration/2)){this.hls.trigger(a.a.BUFFER_EOS,{type:"audio"}),this.state=Qe;break}var b=i.fragments,w=b.length,_=b[0].start,E=b[w-1].start+b[w-1].duration,T=void 0;if(y)if(i.live&&!i.PTSKnown)l.b.log("switching audiotrack, live stream, unknown PTS,load first fragment"),p=0;else if(p=e,i.PTSKnown&&e<_){if(!(u.end>_||u.nextStart))return;l.b.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=_+.05}if(i.initSegment&&!i.initSegment.data)T=i.initSegment;else if(p<=_){if(T=b[0],null!==this.videoTrackCC&&T.cc!==this.videoTrackCC&&(T=function(e,t){return N.search(e,(function(e){return e.cc<t?1:e.cc>t?-1:0}))}(b,this.videoTrackCC)),i.live&&T.loadIdx&&T.loadIdx===this.fragLoadIdx){var S=u.nextStart?u.nextStart:_;return l.b.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(S+.05)),void(this.media.currentTime=S+.05)}}else{var k=void 0,x=n.maxFragLookUpTolerance,C=f?b[f.sn-b[0].sn+1]:void 0,A=function(e){var t=Math.min(x,e.duration);return e.start+e.duration-t<=p?1:e.start-t>p&&e.start?-1:0};p<E?(p>E-x&&(x=0),k=C&&!A(C)?C:N.search(b,A)):k=b[w-1],k&&(T=k,_=k.start,f&&T.level===f.level&&T.sn===f.sn&&(T.sn<i.endSN?(T=b[T.sn+1-i.startSN],l.b.log("SN just loaded, load next one: "+T.sn)):T=null))}T&&(T.decryptdata&&null!=T.decryptdata.uri&&null==T.decryptdata.key?(l.b.log("Loading key for "+T.sn+" of ["+i.startSN+" ,"+i.endSN+"],track "+v),this.state=Ve,r.trigger(a.a.KEY_LOADING,{frag:T})):(l.b.log("Loading "+T.sn+", cc: "+T.cc+" of ["+i.startSN+" ,"+i.endSN+"],track "+v+", currentTime:"+e+",bufferEnd:"+p.toFixed(3)),this.fragmentTracker.getState(T)===W&&(this.fragCurrent=T,this.startFragRequested=!0,isNaN(T.sn)||(this.nextLoadPosition=T.start+T.duration),r.trigger(a.a.FRAG_LOADING,{frag:T}),this.state=Ge)))}break;case qe:(t=this.tracks[this.trackId])&&t.details&&(this.state=$e);break;case Ke:var R=performance.now(),L=this.retryDate,P=(o=this.media)&&o.seeking;(!L||R>=L||P)&&(l.b.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=$e);break;case Ze:var O=this.videoTrackCC;if(void 0===this.initPTS[O])break;var D=this.waitingFragment;if(D){var I=D.frag.cc;O!==I?(t=this.tracks[this.trackId]).details&&t.details.live&&(l.b.warn("Waiting fragment CC ("+I+") does not match video track CC ("+O+")"),this.waitingFragment=null,this.state=$e):(this.state=Ge,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=$e}},t.prototype.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var i=this.config;this.tracks&&i.autoStartLoad&&this.startLoad(i.startPosition)},t.prototype.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(l.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.stopLoad()},t.prototype.onMediaSeeking=function(){this.state===Qe&&(this.state=$e),this.media&&(this.lastCurrentTime=this.media.currentTime),this.tick()},t.prototype.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},t.prototype.onAudioTracksUpdated=function(e){l.b.log("audio tracks updated"),this.tracks=e.audioTracks},t.prototype.onAudioTrackSwitching=function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.state=He,this.waitingFragment=null,t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=$e),this.tick()},t.prototype.onAudioTrackLoaded=function(e){var t=e.details,i=e.id,r=this.tracks[i],n=t.totalduration,s=0;if(l.b.log("track "+i+" loaded ["+t.startSN+","+t.endSN+"],duration:"+n),t.live){var o=r.details;o&&t.fragments.length>0?(te(o,t),s=t.fragments[0].start,t.PTSKnown?l.b.log("live audio playlist sliding:"+s.toFixed(3)):l.b.log("live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,l.b.log("live audio playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(r.details=t,!this.startFragRequested){if(-1===this.startPosition){var a=t.startTimeOffset;isNaN(a)?this.startPosition=0:(l.b.log("start time offset found in playlist, adjust startPosition to "+a),this.startPosition=a)}this.nextLoadPosition=this.startPosition}this.state===qe&&(this.state=$e),this.tick()},t.prototype.onKeyLoaded=function(){this.state===Ve&&(this.state=$e,this.tick())},t.prototype.onFragLoaded=function(e){var t=this.fragCurrent,i=e.frag;if(this.state===Ge&&t&&"audio"===i.type&&i.level===t.level&&i.sn===t.sn){var r=this.tracks[this.trackId],n=r.details,s=n.totalduration,o=t.level,c=t.sn,u=t.cc,d=this.config.defaultAudioCodec||r.audioCodec||"mp4a.40.2",h=this.stats=e.stats;if("initSegment"===c)this.state=$e,h.tparsed=h.tbuffered=performance.now(),n.initSegment.data=e.payload,this.hls.trigger(a.a.FRAG_BUFFERED,{stats:h,frag:t,id:"audio"}),this.tick();else{this.state=We,this.appended=!1,this.demuxer||(this.demuxer=new q(this.hls,"audio"));var p=this.initPTS[u],f=n.initSegment?n.initSegment.data:[];n.initSegment||void 0!==p?(this.pendingBuffering=!0,l.b.log("Demuxing "+c+" of ["+n.startSN+" ,"+n.endSN+"],track "+o),this.demuxer.push(e.payload,f,d,null,t,s,!1,p)):(l.b.log("unknown video PTS for continuity counter "+u+", waiting for video PTS before demuxing audio frag "+c+" of ["+n.startSN+" ,"+n.endSN+"],track "+o),this.waitingFragment=e,this.state=Ze)}}this.fragLoadError=0},t.prototype.onFragParsingInitSegment=function(e){var t=this.fragCurrent,i=e.frag;if(t&&"audio"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===We){var r=e.tracks,n=void 0;if(r.video&&delete r.video,n=r.audio){n.levelCodec=n.codec,n.id=e.id,this.hls.trigger(a.a.BUFFER_CODECS,r),l.b.log("audio track:audio,container:"+n.container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]");var s=n.initSegment;if(s){var o={type:"audio",data:s,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[o]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(a.a.BUFFER_APPENDING,o))}this.tick()}}},t.prototype.onFragParsingData=function(e){var t=this,i=this.fragCurrent,r=e.frag;if(i&&"audio"===e.id&&"audio"===e.type&&r.sn===i.sn&&r.level===i.level&&this.state===We){var n=this.trackId,s=this.tracks[n],c=this.hls;isNaN(e.endPTS)&&(e.endPTS=e.startPTS+i.duration,e.endDTS=e.startDTS+i.duration),i.addElementaryStream(y.ElementaryStreamTypes.AUDIO),l.b.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb),ee(s.details,i,e.startPTS,e.endPTS);var u=this.audioSwitch,d=this.media,h=!1;if(u&&d)if(d.readyState){var p=d.currentTime;l.b.log("switching audio track : currentTime:"+p),p>=e.startPTS&&(l.b.log("switching audio track : flushing all audio"),this.state=Xe,c.trigger(a.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),h=!0,this.audioSwitch=!1,c.trigger(a.a.AUDIO_TRACK_SWITCHED,{id:n}))}else this.audioSwitch=!1,c.trigger(a.a.AUDIO_TRACK_SWITCHED,{id:n});var f=this.pendingData;if(!f)return console.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void c.trigger(a.a.ERROR,{type:o.b.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([e.data1,e.data2].forEach((function(t){t&&t.length&&f.push({type:e.type,data:t,parent:"audio",content:"data"})})),!h&&f.length&&(f.forEach((function(e){t.state===We&&(t.pendingBuffering=!0,t.hls.trigger(a.a.BUFFER_APPENDING,e))})),this.pendingData=[],this.appended=!0)),this.tick()}},t.prototype.onFragParsed=function(e){var t=this.fragCurrent,i=e.frag;t&&"audio"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===We&&(this.stats.tparsed=performance.now(),this.state=Ye,this._checkAppendedParsed())},t.prototype.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},t.prototype.onBufferCreated=function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},t.prototype.onBufferAppended=function(e){if("audio"===e.parent){var t=this.state;t!==We&&t!==Ye||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},t.prototype._checkAppendedParsed=function(){if(!(this.state!==Ye||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,i=this.hls;if(e){this.fragPrevious=e,t.tbuffered=performance.now(),i.trigger(a.a.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var r=this.mediaBuffer?this.mediaBuffer:this.media;l.b.log("audio buffered : "+ie.toString(r.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,i.trigger(a.a.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=$e}this.tick()}},t.prototype.onError=function(e){var t=e.frag;if(!t||"audio"===t.type)switch(e.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:if(!e.fatal){var i=this.fragLoadError;i?i++:i=1;var r=this.config;if(i<=r.fragLoadingMaxRetry){this.fragLoadError=i;var n=Math.min(Math.pow(2,i-1)*r.fragLoadingRetryDelay,r.fragLoadingMaxRetryTimeout);l.b.warn("audioStreamController: frag loading failed, retry in "+n+" ms"),this.retryDate=performance.now()+n,this.state=Ke}else l.b.error("audioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=Je}break;case o.a.AUDIO_TRACK_LOAD_ERROR:case o.a.AUDIO_TRACK_LOAD_TIMEOUT:case o.a.KEY_LOAD_ERROR:case o.a.KEY_LOAD_TIMEOUT:this.state!==Je&&(this.state=e.fatal?Je:$e,l.b.warn("audioStreamController: "+e.details+" while loading frag,switch to "+this.state+" state ..."));break;case o.a.BUFFER_FULL_ERROR:if("audio"===e.parent&&(this.state===We||this.state===Ye)){var s=this.mediaBuffer,c=this.media.currentTime;if(s&&j.isBuffered(s,c)&&j.isBuffered(s,c+.5)){var u=this.config;u.maxMaxBufferLength>=u.maxBufferLength&&(u.maxMaxBufferLength/=2,l.b.warn("audio:reduce max buffer length to "+u.maxMaxBufferLength+"s")),this.state=$e}else l.b.warn("buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=Xe,this.hls.trigger(a.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}},t.prototype.onBufferFlushed=function(){var e=this,t=this.pendingData;t&&t.length?(l.b.log("appending pending audio data on Buffer Flushed"),t.forEach((function(t){e.hls.trigger(a.a.BUFFER_APPENDING,t)})),this.appended=!0,this.pendingData=[],this.state=Ye):(this.state=$e,this.fragPrevious=null,this.tick())},Be(t,[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,l.b.log("audio stream:"+t+"->"+e)}},get:function(){return this._state}}]),t}(oe),tt=function(){if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var e={"":!0,lr:!0,rl:!0},t={start:!0,middle:!0,end:!0,left:!0,right:!0};function i(e){return"string"==typeof e&&!!t[e.toLowerCase()]&&e.toLowerCase()}function r(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)e[r]=i[r]}return e}function n(t,n,s){var o=this,a=function(){if("undefined"!=typeof navigator)return/MSIE\s8\.0/.test(navigator.userAgent)}(),l={};a?o=document.createElement("custom"):l.enumerable=!0,o.hasBeenReset=!1;var c="",u=!1,d=t,h=n,p=s,f=null,m="",g=!0,y="auto",v="start",b=50,w="middle",_=50,E="middle";if(Object.defineProperty(o,"id",r({},l,{get:function(){return c},set:function(e){c=""+e}})),Object.defineProperty(o,"pauseOnExit",r({},l,{get:function(){return u},set:function(e){u=!!e}})),Object.defineProperty(o,"startTime",r({},l,{get:function(){return d},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",r({},l,{get:function(){return h},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",r({},l,{get:function(){return p},set:function(e){p=""+e,this.hasBeenReset=!0}})),Object.defineProperty(o,"region",r({},l,{get:function(){return f},set:function(e){f=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",r({},l,{get:function(){return m},set:function(t){var i=function(t){return"string"==typeof t&&!!e[t.toLowerCase()]&&t.toLowerCase()}(t);if(!1===i)throw new SyntaxError("An invalid or illegal string was specified.");m=i,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",r({},l,{get:function(){return g},set:function(e){g=!!e,this.hasBeenReset=!0}})),Object.defineProperty(o,"line",r({},l,{get:function(){return y},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",r({},l,{get:function(){return v},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",r({},l,{get:function(){return b},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");b=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",r({},l,{get:function(){return w},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");w=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",r({},l,{get:function(){return _},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");_=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",r({},l,{get:function(){return E},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");E=t,this.hasBeenReset=!0}})),o.displayState=void 0,a)return o}return n.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},n}(),it=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}};function rt(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new it,this.regionList=[]}function nt(){this.values=Object.create(null)}function st(e,t,i,r){var n=r?e.split(r):[e];for(var s in n)if("string"==typeof n[s]){var o=n[s].split(i);2===o.length&&t(o[0],o[1])}}nt.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,i){for(var r=0;r<i.length;++r)if(t===i[r]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var ot=new tt(0,0,0),at="middle"===ot.align?"middle":"center";function lt(e,t,i){var r=e;function n(){var t=function(e){function t(e,t,i,r){return 3600*(0|e)+60*(0|t)+(0|i)+(0|r)/1e3}var i=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return i?i[3]?t(i[1],i[2],i[3].replace(":",""),i[4]):i[1]>59?t(i[1],i[2],0,i[4]):t(0,i[1],i[2],i[4]):null}(e);if(null===t)throw new Error("Malformed timestamp: "+r);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function s(){e=e.replace(/^\s+/,"")}if(s(),t.startTime=n(),s(),"--\x3e"!==e.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);e=e.substr(3),s(),t.endTime=n(),s(),function(e,t){var r=new nt;st(e,(function(e,t){switch(e){case"region":for(var n=i.length-1;n>=0;n--)if(i[n].id===t){r.set(e,i[n].region);break}break;case"vertical":r.alt(e,t,["rl","lr"]);break;case"line":var s=t.split(","),o=s[0];r.integer(e,o),r.percent(e,o)&&r.set("snapToLines",!1),r.alt(e,o,["auto"]),2===s.length&&r.alt("lineAlign",s[1],["start",at,"end"]);break;case"position":s=t.split(","),r.percent(e,s[0]),2===s.length&&r.alt("positionAlign",s[1],["start",at,"end","line-left","line-right","auto"]);break;case"size":r.percent(e,t);break;case"align":r.alt(e,t,["start",at,"end","left","right"])}}),/:/,/\s/),t.region=r.get("region",null),t.vertical=r.get("vertical","");var n=r.get("line","auto");"auto"===n&&-1===ot.line&&(n=-1),t.line=n,t.lineAlign=r.get("lineAlign","start"),t.snapToLines=r.get("snapToLines",!0),t.size=r.get("size",100),t.align=r.get("align",at);var s=r.get("position","auto");"auto"===s&&50===ot.position&&(s="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=s}(e,t)}function ct(e){return e.replace(/<br(?: \/)?>/gi,"\n")}rt.prototype={parse:function(e){var t=this;function i(){var e=t.buffer,i=0;for(e=ct(e);i<e.length&&"\r"!==e[i]&&"\n"!==e[i];)++i;var r=e.substr(0,i);return"\r"===e[i]&&++i,"\n"===e[i]&&++i,t.buffer=e.substr(i),r}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var r=void 0;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var n=(r=i()).match(/^()?WEBVTT([ \t].*)?$/);if(!n||!n[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var s=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(s?s=!1:r=i(),t.state){case"HEADER":/:/.test(r)?st(r,(function(e,t){"Region"===e&&console.log("parse region",t)}),/:/):r||(t.state="ID");continue;case"NOTE":r||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){t.state="NOTE";break}if(!r)continue;if(t.cue=new tt(0,0,""),t.state="CUE",-1===r.indexOf("--\x3e")){t.cue.id=r;continue}case"CUE":try{lt(r,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var o=-1!==r.indexOf("--\x3e");if(!r||o&&(s=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=r;continue;case"BADCUE":r||(t.state="ID");continue}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var e=this;try{if(e.buffer+=e.decoder.decode(),(e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return e.onflush&&e.onflush(),this}};var ut=rt;function dt(e,t,i,r){for(var n=void 0,s=void 0,o=void 0,a=void 0,l=void 0,c=window.VTTCue||window.TextTrackCue,u=0;u<r.rows.length;u++)if(o=!0,a=0,l="",!(n=r.rows[u]).isEmpty()){for(var d=0;d<n.chars.length;d++)n.chars[d].uchar.match(/\s/)&&o?a++:(l+=n.chars[d].uchar,o=!1);n.cueStartTime=t,t===i&&(i+=1e-4),s=new c(t,i,ct(l.trim())),a>=16?a--:a++,navigator.userAgent.match(/Firefox\//)?s.line=u+1:s.line=u>7?u-2:u+1,s.align="left",s.position=Math.max(0,Math.min(100,a/32*100+(navigator.userAgent.match(/Firefox\//)?50:0))),e.addCue(s)}}function ht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var pt={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},ft=function(e){var t=e;return pt.hasOwnProperty(e)&&(t=pt[e]),String.fromCharCode(t)},mt=15,gt=100,yt={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},vt={17:2,18:4,21:6,22:8,23:10,19:13,20:15},bt={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},wt={25:2,26:4,29:6,30:8,31:10,27:13,28:15},_t=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],Et={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var i=this.verboseFilter[e];this.verboseLevel>=i&&console.log(this.time+" ["+e+"] "+t)}},Tt=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].toString(16));return t},St=function(){function e(t,i,r,n,s){ht(this,e),this.foreground=t||"white",this.underline=i||!1,this.italics=r||!1,this.background=n||"black",this.flash=s||!1}return e.prototype.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},e.prototype.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],i=0;i<t.length;i++){var r=t[i];e.hasOwnProperty(r)&&(this[r]=e[r])}},e.prototype.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},e.prototype.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},e.prototype.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},e.prototype.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),kt=function(){function e(t,i,r,n,s,o){ht(this,e),this.uchar=t||" ",this.penState=new St(i,r,n,s,o)}return e.prototype.reset=function(){this.uchar=" ",this.penState.reset()},e.prototype.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},e.prototype.setPenState=function(e){this.penState.copy(e)},e.prototype.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},e.prototype.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},e.prototype.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),xt=function(){function e(){ht(this,e),this.chars=[];for(var t=0;t<gt;t++)this.chars.push(new kt);this.pos=0,this.currPenState=new St}return e.prototype.equals=function(e){for(var t=!0,i=0;i<gt;i++)if(!this.chars[i].equals(e.chars[i])){t=!1;break}return t},e.prototype.copy=function(e){for(var t=0;t<gt;t++)this.chars[t].copy(e.chars[t])},e.prototype.isEmpty=function(){for(var e=!0,t=0;t<gt;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},e.prototype.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(Et.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>gt&&(Et.log("ERROR","Too large cursor position "+this.pos),this.pos=gt)},e.prototype.moveCursor=function(e){var t=this.pos+e;if(e>1)for(var i=this.pos+1;i<t+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(t)},e.prototype.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},e.prototype.insertChar=function(e){e>=144&&this.backSpace();var t=ft(e);this.pos>=gt?Et.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},e.prototype.clearFromPos=function(e){var t=void 0;for(t=e;t<gt;t++)this.chars[t].reset()},e.prototype.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},e.prototype.clearToEndOfRow=function(){this.clearFromPos(this.pos)},e.prototype.getTextString=function(){for(var e=[],t=!0,i=0;i<gt;i++){var r=this.chars[i].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")},e.prototype.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),Ct=function(){function e(){ht(this,e),this.rows=[];for(var t=0;t<mt;t++)this.rows.push(new xt);this.currRow=14,this.nrRollUpRows=null,this.reset()}return e.prototype.reset=function(){for(var e=0;e<mt;e++)this.rows[e].clear();this.currRow=14},e.prototype.equals=function(e){for(var t=!0,i=0;i<mt;i++)if(!this.rows[i].equals(e.rows[i])){t=!1;break}return t},e.prototype.copy=function(e){for(var t=0;t<mt;t++)this.rows[t].copy(e.rows[t])},e.prototype.isEmpty=function(){for(var e=!0,t=0;t<mt;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},e.prototype.backSpace=function(){this.rows[this.currRow].backSpace()},e.prototype.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},e.prototype.insertChar=function(e){this.rows[this.currRow].insertChar(e)},e.prototype.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},e.prototype.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},e.prototype.setCursor=function(e){Et.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},e.prototype.setPAC=function(e){Et.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var i=0;i<mt;i++)this.rows[i].clear();var r=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){var s=n.rows[r].cueStartTime;if(s&&s<Et.time)for(var o=0;o<this.nrRollUpRows;o++)this.rows[t-this.nrRollUpRows+o+1].copy(n.rows[r+o])}}this.currRow=t;var a=this.rows[this.currRow];if(null!==e.indent){var l=e.indent,c=Math.max(l-1,0);a.setCursor(e.indent),e.color=a.chars[c].penState.foreground}var u={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(u)},e.prototype.setBkgData=function(e){Et.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},e.prototype.setRollUpRows=function(e){this.nrRollUpRows=e},e.prototype.rollUp=function(){if(null!==this.nrRollUpRows){Et.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),Et.log("INFO","Rolling up")}else Et.log("DEBUG","roll_up but nrRollUpRows not set yet")},e.prototype.getDisplayText=function(e){e=e||!1;for(var t=[],i="",r=-1,n=0;n<mt;n++){var s=this.rows[n].getTextString();s&&(r=n+1,e?t.push("Row "+r+": '"+s+"'"):t.push(s.trim()))}return t.length>0&&(i=e?"["+t.join(" | ")+"]":t.join("\n")),i},e.prototype.getTextAndFormat=function(){return this.rows},e}(),At=function(){function e(t,i){ht(this,e),this.chNr=t,this.outputFilter=i,this.mode=null,this.verbose=0,this.displayedMemory=new Ct,this.nonDisplayedMemory=new Ct,this.lastOutputScreen=new Ct,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}return e.prototype.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},e.prototype.getHandler=function(){return this.outputFilter},e.prototype.setHandler=function(e){this.outputFilter=e},e.prototype.setPAC=function(e){this.writeScreen.setPAC(e)},e.prototype.setBkgData=function(e){this.writeScreen.setBkgData(e)},e.prototype.setMode=function(e){e!==this.mode&&(this.mode=e,Et.log("INFO","MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},e.prototype.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var i=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";Et.log("INFO",i+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(Et.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},e.prototype.ccRCL=function(){Et.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},e.prototype.ccBS=function(){Et.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},e.prototype.ccAOF=function(){},e.prototype.ccAON=function(){},e.prototype.ccDER=function(){Et.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},e.prototype.ccRU=function(e){Et.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},e.prototype.ccFON=function(){Et.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},e.prototype.ccRDC=function(){Et.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},e.prototype.ccTR=function(){Et.log("INFO","TR"),this.setMode("MODE_TEXT")},e.prototype.ccRTD=function(){Et.log("INFO","RTD"),this.setMode("MODE_TEXT")},e.prototype.ccEDM=function(){Et.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},e.prototype.ccCR=function(){Et.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},e.prototype.ccENM=function(){Et.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},e.prototype.ccEOC=function(){if(Et.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,Et.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},e.prototype.ccTO=function(e){Et.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},e.prototype.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var i=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][i]}Et.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},e.prototype.outputDataUpdate=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Et.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),!0===e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue()),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},e.prototype.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}(),Rt=function(){function e(t,i,r){ht(this,e),this.field=t||1,this.outputs=[i,r],this.channels=[new At(1,i),new At(2,r)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}return e.prototype.getHandler=function(e){return this.channels[e].getHandler()},e.prototype.setHandler=function(e,t){this.channels[e].setHandler(t)},e.prototype.addData=function(e,t){var i=void 0,r=void 0,n=void 0,s=!1;this.lastTime=e,Et.setTime(e);for(var o=0;o<t.length;o+=2)r=127&t[o],n=127&t[o+1],0!==r||0!==n?(Et.log("DATA","["+Tt([t[o],t[o+1]])+"] -> ("+Tt([r,n])+")"),(i=this.parseCmd(r,n))||(i=this.parseMidrow(r,n)),i||(i=this.parsePAC(r,n)),i||(i=this.parseBackgroundAttributes(r,n)),i||(s=this.parseChars(r,n))&&(this.currChNr&&this.currChNr>=0?this.channels[this.currChNr-1].insertChars(s):Et.log("WARNING","No channel found yet. TEXT-MODE?")),i?this.dataCounters.cmd+=2:s?this.dataCounters.char+=2:(this.dataCounters.other+=2,Et.log("WARNING","Couldn't parse cleaned data "+Tt([r,n])+" orig: "+Tt([t[o],t[o+1]])))):this.dataCounters.padding+=2},e.prototype.parseCmd=function(e,t){var i=null;if(!((20===e||28===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=33&&t<=35))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,Et.log("DEBUG","Repeated command ("+Tt([e,t])+") is dropped"),!0;i=20===e||23===e?1:2;var r=this.channels[i-1];return 20===e||28===e?32===t?r.ccRCL():33===t?r.ccBS():34===t?r.ccAOF():35===t?r.ccAON():36===t?r.ccDER():37===t?r.ccRU(2):38===t?r.ccRU(3):39===t?r.ccRU(4):40===t?r.ccFON():41===t?r.ccRDC():42===t?r.ccTR():43===t?r.ccRTD():44===t?r.ccEDM():45===t?r.ccCR():46===t?r.ccENM():47===t&&r.ccEOC():r.ccTO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=i,!0},e.prototype.parseMidrow=function(e,t){var i=null;return(17===e||25===e)&&t>=32&&t<=47&&((i=17===e?1:2)!==this.currChNr?(Et.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[i-1].ccMIDROW(t),Et.log("DEBUG","MIDROW ("+Tt([e,t])+")"),!0))},e.prototype.parsePAC=function(e,t){var i,r=null;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127||(16===e||24===e)&&t>=64&&t<=95))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;i=e<=23?1:2,r=t>=64&&t<=95?1===i?yt[e]:bt[e]:1===i?vt[e]:wt[e];var n=this.interpretPAC(r,t);return this.channels[i-1].setPAC(n),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=i,!0},e.prototype.interpretPAC=function(e,t){var i=t,r={color:null,italics:!1,indent:null,underline:!1,row:e};return i=t>95?t-96:t-64,r.underline=!(1&~i),i<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((i-16)/2),r},e.prototype.parseChars=function(e,t){var i=null,r=null,n=null;if(e>=25?(i=2,n=e-8):(i=1,n=e),n>=17&&n<=19){var s=t;s=17===n?t+80:18===n?t+112:t+144,Et.log("INFO","Special char '"+ft(s)+"' in channel "+i),r=[s]}else e>=32&&e<=127&&(r=0===t?[e]:[e,t]);if(r){var o=Tt(r);Et.log("DEBUG","Char codes =  "+o.join(",")),this.lastCmdA=null,this.lastCmdB=null}return r},e.prototype.parseBackgroundAttributes=function(e,t){var i,r=void 0,n=void 0;return((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47)&&(r={},16===e||24===e?(n=Math.floor((t-32)/2),r.background=_t[n],t%2==1&&(r.background=r.background+"_semi")):45===t?r.background="transparent":(r.foreground="black",47===t&&(r.underline=!0)),i=e<24?1:2,this.channels[i-1].setBkgData(r),this.lastCmdA=null,this.lastCmdB=null,!0)},e.prototype.reset=function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},e.prototype.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)},e}(),Lt=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timelineController=t,this.track=i,this.startTime=null,this.endTime=null,this.screen=null}return e.prototype.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues("textTrack"+this.track,this.startTime,this.endTime,this.screen),this.startTime=null)},e.prototype.newCue=function(e,t,i){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=i,this.timelineController.createCaptionsTrack(this.track)},e}(),Pt=function(e,t,i){return e.substr(i||0,t.length)===t},Ot=function(e){for(var t=5381,i=e.length;i;)t=33*t^e.charCodeAt(--i);return(t>>>0).toString()},Dt={parse:function(e,t,i,r,n,s){var o=Object(Ee.b)(new Uint8Array(e)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),a="00:00.000",l=0,c=0,u=0,d=[],h=void 0,p=!0,f=new ut;f.oncue=function(e){var t=i[r],n=i.ccOffset;t&&t.new&&(void 0!==c?n=i.ccOffset=t.start:function(e,t,i){var r=e[t],n=e[r.prevCC];if(!n||!n.new&&r.new)return e.ccOffset=e.presentationOffset=r.start,void(r.new=!1);for(;n&&n.new;)e.ccOffset+=r.start-n.start,r.new=!1,n=e[(r=n).prevCC];e.presentationOffset=i}(i,r,u)),u&&(n=u+i.ccOffset-i.presentationOffset),e.startTime+=n-c,e.endTime+=n-c,e.id=Ot(e.startTime.toString())+Ot(e.endTime.toString())+Ot(e.text),e.text=decodeURIComponent(encodeURIComponent(e.text)),e.endTime>0&&d.push(e)},f.onparsingerror=function(e){h=e},f.onflush=function(){h&&s?s(h):n(d)},o.forEach((function(e){if(p){if(Pt(e,"X-TIMESTAMP-MAP=")){p=!1,e.substr(16).split(",").forEach((function(e){Pt(e,"LOCAL:")?a=e.substr(6):Pt(e,"MPEGTS:")&&(l=parseInt(e.substr(7)))}));try{l-=t=t<0?t+8589934592:t,i=a,r=parseInt(i.substr(-3)),n=parseInt(i.substr(-6,2)),s=parseInt(i.substr(-9,2)),o=i.length>9?parseInt(i.substr(0,i.indexOf(":"))):0,c=(isNaN(r)||isNaN(n)||isNaN(s)||isNaN(o)?-1:(r+=1e3*n,r+=6e4*s,r+=36e5*o))/1e3,u=l/9e4,-1===c&&(h=new Error("Malformed X-TIMESTAMP-MAP: "+e))}catch(t){h=new Error("Malformed X-TIMESTAMP-MAP: "+e)}return}""===e&&(p=!1)}var i,r,n,s,o;f.parse(e+"\n")})),f.flush()}},It=function(e){function t(i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,a.a.MEDIA_ATTACHING,a.a.MEDIA_DETACHING,a.a.FRAG_PARSING_USERDATA,a.a.FRAG_DECRYPTED,a.a.MANIFEST_LOADING,a.a.MANIFEST_LOADED,a.a.FRAG_LOADED,a.a.LEVEL_SWITCHING,a.a.INIT_PTS_FOUND));if(r.hls=i,r.config=i.config,r.enabled=!0,r.Cues=i.config.cueHandler,r.textTracks=[],r.tracks=[],r.unparsedVttFrags=[],r.initPTS=void 0,r.cueRanges=[],r.config.enableCEA708Captions){var n=new Lt(r,1),s=new Lt(r,2);r.cea608Parser=new Rt(0,n,s)}return r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.addCues=function(e,t,i,r){for(var n,s,o,a,l=this.cueRanges,c=!1,u=l.length;u--;){var d=l[u],h=(n=d[0],s=d[1],o=t,a=i,Math.min(s,a)-Math.max(n,o));if(h>=0&&(d[0]=Math.min(d[0],t),d[1]=Math.max(d[1],i),c=!0,h/(i-t)>.5))return}c||l.push([t,i]),this.Cues.newCue(this[e],t,i,r)},t.prototype.onInitPtsFound=function(e){var t=this;void 0===this.initPTS&&(this.initPTS=e.initPTS),this.unparsedVttFrags.length&&(this.unparsedVttFrags.forEach((function(e){t.onFragLoaded(e)})),this.unparsedVttFrags=[])},t.prototype.getExistingTrack=function(e){var t=this.media;if(t)for(var i=0;i<t.textTracks.length;i++){var r=t.textTracks[i];if(!0===r["textTrack"+e])return r}return null},t.prototype.createCaptionsTrack=function(e){var t="textTrack"+e;if(!this[t]){var i=this.getExistingTrack(e);if(i)this[t]=i,Se(this[t]),Te(this[t],this.media);else{var r=this.createTextTrack("captions",this.config["captionsTextTrack"+e+"Label"],this.config["captionsTextTrack"+e+"LanguageCode"]);r&&(r[t]=!0,this[t]=r)}}},t.prototype.createTextTrack=function(e,t,i){var r=this.media;if(r)return r.addTextTrack(e,t,i)},t.prototype.destroy=function(){h.prototype.destroy.call(this)},t.prototype.onMediaAttaching=function(e){this.media=e.media,this._cleanTracks()},t.prototype.onMediaDetaching=function(){Se(this.textTrack1),Se(this.textTrack2)},t.prototype.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0},this._cleanTracks()},t.prototype._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var i=0;i<t.length;i++)Se(t[i])}},t.prototype.onManifestLoaded=function(e){var t=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=void 0,this.cueRanges=[],this.config.enableWebVTT){this.tracks=e.subtitles||[];var i=this.media?this.media.textTracks:[];this.tracks.forEach((function(e,r){var n=void 0;if(r<i.length){var s=i[r];(function(e,t){return e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)})(s,e)&&(n=s)}n||(n=t.createTextTrack("subtitles",e.name,e.lang)),e.default?n.mode=t.hls.subtitleDisplay?"showing":"hidden":n.mode="disabled",t.textTracks.push(n)}))}},t.prototype.onLevelSwitching=function(){this.enabled="NONE"!==this.hls.currentLevel.closedCaptions},t.prototype.onFragLoaded=function(e){var t=e.frag,i=e.payload;if("main"===t.type){var r=t.sn;if(r!==this.lastSn+1){var n=this.cea608Parser;n&&n.reset()}this.lastSn=r}else if("subtitle"===t.type)if(i.byteLength){if(void 0===this.initPTS)return void this.unparsedVttFrags.push(e);var s=t.decryptdata;null!=s&&null!=s.key&&"AES-128"===s.method||this._parseVTTs(t,i)}else this.hls.trigger(a.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},t.prototype._parseVTTs=function(e,t){var i=this.vttCCs;i[e.cc]||(i[e.cc]={start:e.start,prevCC:this.prevCC,new:!0},this.prevCC=e.cc);var r=this.textTracks,n=this.hls;Dt.parse(t,this.initPTS,i,e.cc,(function(t){var i=r[e.trackId];"disabled"!==i.mode?(t.forEach((function(e){if(!i.cues.getCueById(e.id))try{i.addCue(e)}catch(r){var t=new window.TextTrackCue(e.startTime,e.endTime,e.text);t.id=e.id,i.addCue(t)}})),n.trigger(a.a.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})):n.trigger(a.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})}),(function(t){l.b.log("Failed to parse VTT cue: "+t),n.trigger(a.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})}))},t.prototype.onFragDecrypted=function(e){var t=e.payload,i=e.frag;if("subtitle"===i.type){if(void 0===this.initPTS)return void this.unparsedVttFrags.push(e);this._parseVTTs(i,t)}},t.prototype.onFragParsingUserdata=function(e){if(this.enabled&&this.config.enableCEA708Captions)for(var t=0;t<e.samples.length;t++){var i=this.extractCea608Data(e.samples[t].bytes);this.cea608Parser.addData(e.samples[t].pts,i)}},t.prototype.extractCea608Data=function(e){for(var t=31&e[0],i=2,r=void 0,n=void 0,s=void 0,o=[],a=0;a<t;a++)r=e[i++],n=127&e[i++],s=127&e[i++],0===n&&0===s||4&r&&!(3&r)&&(o.push(n),o.push(s));return o},t}(h),Mt=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}();function Ft(e){for(var t=[],i=0;i<e.length;i++)"subtitles"===e[i].kind&&t.push(e[i]);return t}var Nt=function(e){function t(i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,a.a.MEDIA_ATTACHED,a.a.MEDIA_DETACHING,a.a.MANIFEST_LOADING,a.a.MANIFEST_LOADED,a.a.SUBTITLE_TRACK_LOADED));return r.tracks=[],r.trackId=-1,r.media=void 0,r.subtitleDisplay=!1,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype._onTextTracksChanged=function(){if(this.media){for(var e=-1,t=Ft(this.media.textTracks),i=0;i<t.length;i++)if("hidden"===t[i].mode)e=i;else if("showing"===t[i].mode){e=i;break}this.subtitleTrack=e}},t.prototype.destroy=function(){h.prototype.destroy.call(this)},t.prototype.onMediaAttached=function(e){var t=this;this.media=e.media,this.media&&(void 0!==this.queuedDefaultTrack&&(this.subtitleTrack=this.queuedDefaultTrack,delete this.queuedDefaultTrack),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval((function(){t.trackChangeListener()}),500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},t.prototype.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.media=void 0)},t.prototype.onManifestLoading=function(){this.tracks=[],this.trackId=-1},t.prototype.onManifestLoaded=function(e){var t=this,i=e.subtitles||[];this.tracks=i,this.trackId=-1,this.hls.trigger(a.a.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:i}),i.forEach((function(e){e.default&&(t.media?t.subtitleTrack=e.id:t.queuedDefaultTrack=e.id)}))},t.prototype.onTick=function(){var e=this.trackId,t=this.tracks[e];if(t){var i=t.details;void 0!==i&&!0!==i.live||(l.b.log("(re)loading playlist for subtitle track "+e),this.hls.trigger(a.a.SUBTITLE_TRACK_LOADING,{url:t.url,id:e}))}},t.prototype.onSubtitleTrackLoaded=function(e){var t=this;e.id<this.tracks.length&&(l.b.log("subtitle track "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.timer&&(this.timer=setInterval((function(){t.onTick()}),1e3*e.details.targetduration,this)),!e.details.live&&this.timer&&(clearInterval(this.timer),this.timer=null))},t.prototype.setSubtitleTrackInternal=function(e){if(!(e<-1||e>=this.tracks.length)){this.timer&&(clearInterval(this.timer),this.timer=null);var t=Ft(this.media.textTracks);if(-1!==this.trackId&&(t[this.trackId].mode="disabled"),this.trackId=e,l.b.log("switching to subtitle track "+e),this.hls.trigger(a.a.SUBTITLE_TRACK_SWITCH,{id:e}),-1!==e){var i=this.tracks[e];e<t.length&&(t[e].mode=this.subtitleDisplay?"showing":"hidden");var r=i.details;void 0!==r&&!0!==r.live||(l.b.log("(re)loading playlist for subtitle track "+e),this.hls.trigger(a.a.SUBTITLE_TRACK_LOADING,{url:i.url,id:e}))}}},Mt(t,[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.trackId!==e&&this.setSubtitleTrackInternal(e)}}]),t}(h),jt=i(5),Bt="STOPPED",Ut="IDLE",zt="KEY_LOADING",$t="FRAG_LOADING",Ht=function(e){function t(i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,a.a.MEDIA_ATTACHED,a.a.ERROR,a.a.KEY_LOADED,a.a.FRAG_LOADED,a.a.SUBTITLE_TRACKS_UPDATED,a.a.SUBTITLE_TRACK_SWITCH,a.a.SUBTITLE_TRACK_LOADED,a.a.SUBTITLE_FRAG_PROCESSED));return r.config=i.config,r.vttFragSNsProcessed={},r.vttFragQueues=void 0,r.currentlyProcessing=null,r.state=Bt,r.currentTrackId=-1,r.decrypter=new jt.a(i.observer,i.config),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.onHandlerDestroyed=function(){this.state=Bt},t.prototype.clearVttFragQueues=function(){var e=this;this.vttFragQueues={},this.tracks.forEach((function(t){e.vttFragQueues[t.id]=[]}))},t.prototype.nextFrag=function(){if(null===this.currentlyProcessing&&this.currentTrackId>-1&&this.vttFragQueues[this.currentTrackId].length){var e=this.currentlyProcessing=this.vttFragQueues[this.currentTrackId].shift();this.fragCurrent=e,this.hls.trigger(a.a.FRAG_LOADING,{frag:e}),this.state=$t}},t.prototype.onSubtitleFragProcessed=function(e){e.success&&this.vttFragSNsProcessed[e.frag.trackId].push(e.frag.sn),this.currentlyProcessing=null,this.state=Ut,this.nextFrag()},t.prototype.onMediaAttached=function(){this.state=Ut},t.prototype.onError=function(e){var t=e.frag;t&&"subtitle"!==t.type||this.currentlyProcessing&&(this.currentlyProcessing=null,this.nextFrag())},t.prototype.doTick=function(){var e=this;switch(this.state){case Ut:var t,i=this.tracks,r=this.currentTrackId,n=this.vttFragSNsProcessed[r],s=this.vttFragQueues[r],o=this.currentlyProcessing?this.currentlyProcessing.sn:-1;if(!i)break;if(r<i.length&&(t=i[r].details),void 0===t)break;t.fragments.forEach((function(t){(function(e){return n.indexOf(e.sn)>-1})(t)||t.sn===o||function(e){return s.some((function(t){return t.sn===e.sn}))}(t)||(t.decryptdata&&null!=t.decryptdata.uri&&null==t.decryptdata.key?(l.b.log("Loading key for "+t.sn),e.state=zt,e.hls.trigger(a.a.KEY_LOADING,{frag:t})):(t.trackId=r,s.push(t),e.nextFrag()))}))}},t.prototype.onSubtitleTracksUpdated=function(e){var t=this;l.b.log("subtitle tracks updated"),this.tracks=e.subtitleTracks,this.clearVttFragQueues(),this.vttFragSNsProcessed={},this.tracks.forEach((function(e){t.vttFragSNsProcessed[e.id]=[]}))},t.prototype.onSubtitleTrackSwitch=function(e){this.currentTrackId=e.id,-1!==this.currentTrackId&&void 0!==this.tracks[this.currentTrackId].details&&this.tick()},t.prototype.onSubtitleTrackLoaded=function(){this.tick()},t.prototype.onKeyLoaded=function(){this.state===zt&&(this.state=Ut,this.tick())},t.prototype.onFragLoaded=function(e){var t=this.fragCurrent,i=e.frag.decryptdata,r=e.frag,n=this.hls;if(this.state===$t&&t&&"subtitle"===e.frag.type&&t.sn===e.frag.sn&&e.payload.byteLength>0&&null!=i&&null!=i.key&&"AES-128"===i.method){var s=void 0;try{s=performance.now()}catch(e){s=Date.now()}this.decrypter.decrypt(e.payload,i.key.buffer,i.iv.buffer,(function(e){var t=void 0;try{t=performance.now()}catch(e){t=Date.now()}n.trigger(a.a.FRAG_DECRYPTED,{frag:r,payload:e,stats:{tstart:s,tdecrypt:t}})}))}},t}(oe),Vt=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),Gt="com.widevine.alpha",Kt="com.microsoft.playready",qt=function(e){function t(i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,a.a.MEDIA_ATTACHED,a.a.MANIFEST_PARSED));return r._widevineLicenseUrl=i.config.widevineLicenseUrl,r._licenseXhrSetup=i.config.licenseXhrSetup,r._emeEnabled=i.config.emeEnabled,r._requestMediaKeySystemAccess=i.config.requestMediaKeySystemAccessFunc,r._mediaKeysList=[],r._media=null,r._hasSetMediaKeys=!1,r._isMediaEncrypted=!1,r._requestLicenseFailureCount=0,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getLicenseServerUrl=function(e){var t=void 0;return(t=e===Gt?this._widevineLicenseUrl:null)||(l.b.error('No license server URL configured for key-system "'+e+'"'),this.hls.trigger(a.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})),t},t.prototype._attemptKeySystemAccess=function(e,t,i){var r=this,n=function(e,t,i){if(e===Gt)return function(e,t,i){var r={videoCapabilities:[]};return t.forEach((function(e){r.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"'})})),[r]}(0,i);throw Error("Unknown key-system: "+e)}(e,0,i);n?(l.b.log("Requesting encrypted media key-system access"),this.requestMediaKeySystemAccess(e,n).then((function(t){r._onMediaKeySystemAccessObtained(e,t)})).catch((function(t){l.b.error('Failed to obtain key-system "'+e+'" access:',t)}))):l.b.warn("Can not create config for key-system (maybe because platform is not supported):",e)},t.prototype._onMediaKeySystemAccessObtained=function(e,t){var i=this;l.b.log('Access for key-system "'+e+'" obtained');var r={mediaKeys:null,mediaKeysSession:null,mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:e};this._mediaKeysList.push(r),t.createMediaKeys().then((function(t){r.mediaKeys=t,l.b.log('Media-keys created for key-system "'+e+'"'),i._onMediaKeysCreated()})).catch((function(e){l.b.error("Failed to create media-keys:",e)}))},t.prototype._onMediaKeysCreated=function(){var e=this;this._mediaKeysList.forEach((function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),e._onNewMediaKeySession(t.mediaKeysSession))}))},t.prototype._onNewMediaKeySession=function(e){var t=this;l.b.log("New key-system session "+e.sessionId),e.addEventListener("message",(function(i){t._onKeySessionMessage(e,i.message)}),!1)},t.prototype._onKeySessionMessage=function(e,t){l.b.log("Got EME message event, creating license request"),this._requestLicense(t,(function(t){l.b.log("Received license data, updating key-session"),e.update(t)}))},t.prototype._onMediaEncrypted=function(e,t){l.b.log('Media is encrypted using "'+e+'" init data type'),this._isMediaEncrypted=!0,this._mediaEncryptionInitDataType=e,this._mediaEncryptionInitData=t,this._attemptSetMediaKeys(),this._generateRequestWithPreferredKeySession()},t.prototype._attemptSetMediaKeys=function(){if(!this._hasSetMediaKeys){var e=this._mediaKeysList[0];if(!e||!e.mediaKeys)return l.b.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(a.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_KEYS,fatal:!0});l.b.log("Setting keys for encrypted media"),this._media.setMediaKeys(e.mediaKeys),this._hasSetMediaKeys=!0}},t.prototype._generateRequestWithPreferredKeySession=function(){var e=this,t=this._mediaKeysList[0];if(!t)return l.b.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(a.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(t.mediaKeysSessionInitialized)l.b.warn("Key-Session already initialized but requested again");else{var i=t.mediaKeysSession;i||(l.b.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(a.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_SESSION,fatal:!0}));var r=this._mediaEncryptionInitDataType,n=this._mediaEncryptionInitData;l.b.log('Generating key-session request for "'+r+'" init data type'),t.mediaKeysSessionInitialized=!0,i.generateRequest(r,n).then((function(){l.b.debug("Key-session generation succeeded")})).catch((function(t){l.b.error("Error generating key-session request:",t),e.hls.trigger(a.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_SESSION,fatal:!1})}))}},t.prototype._createLicenseXhr=function(e,t,i){var r=new XMLHttpRequest,n=this._licenseXhrSetup;try{if(n)try{n(r,e)}catch(t){r.open("POST",e,!0),n(r,e)}r.readyState||r.open("POST",e,!0)}catch(e){return l.b.error("Error setting up key-system license XHR",e),void this.hls.trigger(a.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}return r.responseType="arraybuffer",r.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,r,e,t,i),r},t.prototype._onLicenseRequestReadyStageChange=function(e,t,i,r){if(4===e.readyState)if(200===e.status)this._requestLicenseFailureCount=0,l.b.log("License request succeeded"),r(e.response);else{if(l.b.error("License Request XHR failed ("+t+"). Status: "+e.status+" ("+e.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount<=3){var n=3-this._requestLicenseFailureCount+1;return l.b.warn("Retrying license request, "+n+" attempts left"),void this._requestLicense(i,r)}this.hls.trigger(a.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},t.prototype._generateLicenseRequestChallenge=function(e,t){var i=void 0;return e.mediaKeySystemDomain===Kt?l.b.error("PlayReady is not supported (yet)"):e.mediaKeySystemDomain===Gt?i=t:l.b.error("Unsupported key-system:",e.mediaKeySystemDomain),i},t.prototype._requestLicense=function(e,t){l.b.log("Requesting content license for key-system");var i=this._mediaKeysList[0];if(!i)return l.b.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(a.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});var r=this.getLicenseServerUrl(i.mediaKeySystemDomain),n=this._createLicenseXhr(r,e,t);l.b.log("Sending license request to URL: "+r),n.send(this._generateLicenseRequestChallenge(i,e))},t.prototype.onMediaAttached=function(e){var t=this;if(this._emeEnabled){var i=e.media;this._media=i,i.addEventListener("encrypted",(function(e){t._onMediaEncrypted(e.initDataType,e.initData)}))}},t.prototype.onManifestParsed=function(e){if(this._emeEnabled){var t=e.levels.map((function(e){return e.audioCodec})),i=e.levels.map((function(e){return e.videoCodec}));this._attemptKeySystemAccess(Gt,t,i)}},Vt(t,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),t}(h),Wt={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Fe,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:Re,bufferController:Pe,capLevelController:Ie,fpsController:Me,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,requestMediaKeySystemAccessFunc:window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null};Wt.subtitleStreamController=Ht,Wt.subtitleTrackController=Nt,Wt.timelineController=It,Wt.cueHandler=r,Wt.enableCEA708Captions=!0,Wt.enableWebVTT=!0,Wt.captionsTextTrack1Label="English",Wt.captionsTextTrack1LanguageCode="en",Wt.captionsTextTrack2Label="Spanish",Wt.captionsTextTrack2LanguageCode="es",Wt.audioStreamController=et,Wt.audioTrackController=je,Wt.emeController=qt;var Yt=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}();i(12);var Xt=function(){function e(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=e.DefaultConfig;if((i.liveSyncDurationCount||i.liveMaxLatencyDurationCount)&&(i.liveSyncDuration||i.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var n in r)n in i||(i[n]=r[n]);if(void 0!==i.liveMaxLatencyDurationCount&&i.liveMaxLatencyDurationCount<=i.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==i.liveMaxLatencyDuration&&(i.liveMaxLatencyDuration<=i.liveSyncDuration||void 0===i.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(l.a)(i.debug),this.config=i,this._autoLevelCapping=-1;var s=this.observer=new z.a;s.trigger=function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];s.emit.apply(s,[e,e].concat(i))},s.off=function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];s.removeListener.apply(s,[e].concat(i))},this.on=s.on.bind(s),this.off=s.off.bind(s),this.trigger=s.trigger.bind(s);var o=this.abrController=new i.abrController(this),a=new i.bufferController(this),c=new i.capLevelController(this),u=new i.fpsController(this),d=new D(this),h=new M(this),p=new F(this),f=new ke(this),m=this.levelController=new _e(this),g=new J(this),y=[m,this.streamController=new be(this,g)],v=i.audioStreamController;v&&y.push(new v(this,g)),this.networkControllers=y;var b=[d,h,p,o,a,c,u,f,g];if(v=i.audioTrackController){var w=new v(this);this.audioTrackController=w,b.push(w)}if(v=i.subtitleTrackController){var _=new v(this);this.subtitleTrackController=_,b.push(_)}if(v=i.emeController){var E=new v(this);this.emeController=E,b.push(E)}[i.subtitleStreamController,i.timelineController].forEach((function(e){e&&b.push(new e(t))})),this.coreComponents=b}return e.isSupported=function(){return e=V(),t=window.SourceBuffer||window.WebKitSourceBuffer,i=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),r=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove,!!i&&!!r;var e,t,i,r},Yt(e,null,[{key:"version",get:function(){return"0.9.1"}},{key:"Events",get:function(){return a.a}},{key:"ErrorTypes",get:function(){return o.b}},{key:"ErrorDetails",get:function(){return o.a}},{key:"DefaultConfig",get:function(){return e.defaultConfig?e.defaultConfig:Wt},set:function(t){e.defaultConfig=t}}]),e.prototype.destroy=function(){l.b.log("destroy"),this.trigger(a.a.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach((function(e){e.destroy()})),this.url=null,this.observer.removeAllListeners(),this._autoLevelCapping=-1},e.prototype.attachMedia=function(e){l.b.log("attachMedia"),this.media=e,this.trigger(a.a.MEDIA_ATTACHING,{media:e})},e.prototype.detachMedia=function(){l.b.log("detachMedia"),this.trigger(a.a.MEDIA_DETACHING),this.media=null},e.prototype.loadSource=function(e){e=s.a.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),l.b.log("loadSource:"+e),this.url=e,this.trigger(a.a.MANIFEST_LOADING,{url:e})},e.prototype.startLoad=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;l.b.log("startLoad("+e+")"),this.networkControllers.forEach((function(t){t.startLoad(e)}))},e.prototype.stopLoad=function(){l.b.log("stopLoad"),this.networkControllers.forEach((function(e){e.stopLoad()}))},e.prototype.swapAudioCodec=function(){l.b.log("swapAudioCodec"),this.streamController.swapAudioCodec()},e.prototype.recoverMediaError=function(){l.b.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)},Yt(e,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){l.b.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){l.b.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){l.b.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){l.b.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){l.b.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){l.b.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,i=e?e.length:0,r=0;r<i;r++)if((e[r].realBitrate?Math.max(e[r].realBitrate,e[r].bitrate):e[r].bitrate)>t)return r;return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:"nextAutoLevel",get:function(){var e=this;return Math.min(Math.max(e.abrController.nextAutoLevel,e.minAutoLevel),e.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}}]),e}();t.default=Xt},function(e,t,i){function r(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.i=function(e){return e},i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i.oe=function(e){throw console.error(e),e};var r=i(i.s=ENTRY_MODULE);return r.default||r}var n="[\\.|\\-|\\+|\\w|/|@]+",s="\\((/\\*.*?\\*/)?s?.*?("+n+").*?\\)";function o(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function a(e,t,r){var a={};a[r]=[];var l=t.toString(),c=l.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!c)return a;for(var u,d=c[1],h=new RegExp("(\\\\n|\\W)"+o(d)+s,"g");u=h.exec(l);)"dll-reference"!==u[3]&&a[r].push(u[3]);for(h=new RegExp("\\("+o(d)+'\\("(dll-reference\\s('+n+'))"\\)\\)'+s,"g");u=h.exec(l);)e[u[2]]||(a[r].push(u[1]),e[u[2]]=i(u[1]).m),a[u[2]]=a[u[2]]||[],a[u[2]].push(u[4]);return a}function l(e){return Object.keys(e).reduce((function(t,i){return t||e[i].length>0}),!1)}e.exports=function(e,t){t=t||{};var n={main:i.m},s=t.all?{main:Object.keys(n)}:function(e,t){for(var i={main:[t]},r={main:[]},n={main:{}};l(i);)for(var s=Object.keys(i),o=0;o<s.length;o++){var c=s[o],u=i[c].pop();if(n[c]=n[c]||{},!n[c][u]&&e[c][u]){n[c][u]=!0,r[c]=r[c]||[],r[c].push(u);for(var d=a(e,e[c][u],c),h=Object.keys(d),p=0;p<h.length;p++)i[h[p]]=i[h[p]]||[],i[h[p]]=i[h[p]].concat(d[h[p]])}}return r}(n,e),o="";Object.keys(s).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;s[e][t];)t++;s[e].push(t),n[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",o=o+"var "+e+" = ("+r.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+s[e].map((function(t){return JSON.stringify(t)+": "+n[e][t].toString()})).join(",")+"});\n"})),o=o+"("+r.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+s.main.map((function(e){return JSON.stringify(e)+": "+n.main[e].toString()})).join(",")+"})(self);";var c=new window.Blob([o],{type:"text/javascript"});if(t.bare)return c;var u=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(c),d=new window.Worker(u);return d.objectURL=u,d}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(8),n=i(1),s=i(0),o=i(6),a=i.n(o);t.default=function(e){var t=new a.a;t.trigger=function(e){for(var i=arguments.length,r=Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];t.emit.apply(t,[e,e].concat(r))},t.off=function(e){for(var i=arguments.length,r=Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];t.removeListener.apply(t,[e].concat(r))};var i=function(t,i){e.postMessage({event:t,data:i})};e.addEventListener("message",(function(n){var o=n.data;switch(o.cmd){case"init":var a=JSON.parse(o.config);e.demuxer=new r.a(t,o.typeSupported,a,o.vendor);try{Object(s.a)(!0===a.debug)}catch(e){console.warn("demuxerWorker: unable to enable logs")}i("init",null);break;case"demux":e.demuxer.push(o.data,o.decryptdata,o.initSegment,o.audioCodec,o.videoCodec,o.timeOffset,o.discontinuity,o.trackSwitch,o.contiguous,o.duration,o.accurateTimeOffset,o.defaultInitPTS)}})),t.on(n.a.FRAG_DECRYPTED,i),t.on(n.a.FRAG_PARSING_INIT_SEGMENT,i),t.on(n.a.FRAG_PARSED,i),t.on(n.a.ERROR,i),t.on(n.a.FRAG_PARSING_METADATA,i),t.on(n.a.FRAG_PARSING_USERDATA,i),t.on(n.a.INIT_PTS_FOUND,i),t.on(n.a.FRAG_PARSING_DATA,(function(t,i){var r=[],n={event:t,data:i};i.data1&&(n.data1=i.data1.buffer,r.push(i.data1.buffer),delete i.data1),i.data2&&(n.data2=i.data2.buffer,r.push(i.data2.buffer),delete i.data2),e.postMessage(n,r)}))}},function(e,t){
/*! http://mths.be/endswith v0.2.0 by @mathias */
String.prototype.endsWith||function(){"use strict";var e=function(){try{var e={},t=Object.defineProperty,i=t(e,e,e)&&t}catch(e){}return i}(),t={}.toString,i=function(e){if(null==this)throw TypeError();var i=String(this);if(e&&"[object RegExp]"==t.call(e))throw TypeError();var r=i.length,n=String(e),s=n.length,o=r;if(arguments.length>1){var a=arguments[1];void 0!==a&&(o=a?Number(a):0)!=o&&(o=0)}var l=Math.min(Math.max(o,0),r)-s;if(l<0)return!1;for(var c=-1;++c<s;)if(i.charCodeAt(l+c)!=n.charCodeAt(c))return!1;return!0};e?e(String.prototype,"endsWith",{value:i,configurable:!0,writable:!0}):String.prototype.endsWith=i}()}]).default},e.exports=t()},879:e=>{!function(t,i){var r=function(e,t,i){"use strict";var r,n;if(function(){var t,i={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",fastLoadedClass:"ls-is-cached",iframeLoadMode:0,srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:!0,expFactor:1.5,hFac:.8,loadMode:2,loadHidden:!0,ricTimeout:0,throttleDelay:125};for(t in n=e.lazySizesConfig||e.lazysizesConfig||{},i)t in n||(n[t]=i[t])}(),!t||!t.getElementsByClassName)return{init:function(){},cfg:n,noSupport:!0};var s=t.documentElement,o=e.HTMLPictureElement,a="addEventListener",l="getAttribute",c=e[a].bind(e),u=e.setTimeout,d=e.requestAnimationFrame||u,h=e.requestIdleCallback,p=/^picture$/i,f=["load","error","lazyincluded","_lazyloaded"],m={},g=Array.prototype.forEach,y=function(e,t){return m[t]||(m[t]=new RegExp("(\\s|^)"+t+"(\\s|$)")),m[t].test(e[l]("class")||"")&&m[t]},v=function(e,t){y(e,t)||e.setAttribute("class",(e[l]("class")||"").trim()+" "+t)},b=function(e,t){var i;(i=y(e,t))&&e.setAttribute("class",(e[l]("class")||"").replace(i," "))},w=function(e,t,i){var r=i?a:"removeEventListener";i&&w(e,t),f.forEach((function(i){e[r](i,t)}))},_=function(e,i,n,s,o){var a=t.createEvent("Event");return n||(n={}),n.instance=r,a.initEvent(i,!s,!o),a.detail=n,e.dispatchEvent(a),a},E=function(t,i){var r;!o&&(r=e.picturefill||n.pf)?(i&&i.src&&!t[l]("srcset")&&t.setAttribute("srcset",i.src),r({reevaluate:!0,elements:[t]})):i&&i.src&&(t.src=i.src)},T=function(e,t){return(getComputedStyle(e,null)||{})[t]},S=function(e,t,i){for(i=i||e.offsetWidth;i<n.minSize&&t&&!e._lazysizesWidth;)i=t.offsetWidth,t=t.parentNode;return i},k=(ve=[],be=[],we=ve,_e=function(){var e=we;for(we=ve.length?be:ve,ge=!0,ye=!1;e.length;)e.shift()();ge=!1},Ee=function(e,i){ge&&!i?e.apply(this,arguments):(we.push(e),ye||(ye=!0,(t.hidden?u:d)(_e)))},Ee._lsFlush=_e,Ee),x=function(e,t){return t?function(){k(e)}:function(){var t=this,i=arguments;k((function(){e.apply(t,i)}))}},C=function(e){var t,r=0,s=n.throttleDelay,o=n.ricTimeout,a=function(){t=!1,r=i.now(),e()},l=h&&o>49?function(){h(a,{timeout:o}),o!==n.ricTimeout&&(o=n.ricTimeout)}:x((function(){u(a)}),!0);return function(e){var n;(e=!0===e)&&(o=33),t||(t=!0,(n=s-(i.now()-r))<0&&(n=0),e||n<9?l():u(l,n))}},A=function(e){var t,r,n=99,s=function(){t=null,e()},o=function(){var e=i.now()-r;e<n?u(o,n-e):(h||s)(s)};return function(){r=i.now(),t||(t=u(o,n))}},R=(W=/^img$/i,Y=/^iframe$/i,X="onscroll"in e&&!/(gle|ing)bot/.test(navigator.userAgent),Q=0,J=0,Z=0,ee=-1,te=function(e){Z--,(!e||Z<0||!e.target)&&(Z=0)},ie=function(e){return null==q&&(q="hidden"==T(t.body,"visibility")),q||!("hidden"==T(e.parentNode,"visibility")&&"hidden"==T(e,"visibility"))},re=function(e,i){var r,n=e,o=ie(e);for(H-=i,K+=i,V-=i,G+=i;o&&(n=n.offsetParent)&&n!=t.body&&n!=s;)(o=(T(n,"opacity")||1)>0)&&"visible"!=T(n,"overflow")&&(r=n.getBoundingClientRect(),o=G>r.left&&V<r.right&&K>r.top-1&&H<r.bottom+1);return o},ne=function(){var e,i,o,a,c,u,d,h,p,f,m,g,y=r.elements;if((B=n.loadMode)&&Z<8&&(e=y.length)){for(i=0,ee++;i<e;i++)if(y[i]&&!y[i]._lazyRace)if(!X||r.prematureUnveil&&r.prematureUnveil(y[i]))he(y[i]);else if((h=y[i][l]("data-expand"))&&(u=1*h)||(u=J),f||(f=!n.expand||n.expand<1?s.clientHeight>500&&s.clientWidth>500?500:370:n.expand,r._defEx=f,m=f*n.expFactor,g=n.hFac,q=null,J<m&&Z<1&&ee>2&&B>2&&!t.hidden?(J=m,ee=0):J=B>1&&ee>1&&Z<6?f:Q),p!==u&&(z=innerWidth+u*g,$=innerHeight+u,d=-1*u,p=u),o=y[i].getBoundingClientRect(),(K=o.bottom)>=d&&(H=o.top)<=$&&(G=o.right)>=d*g&&(V=o.left)<=z&&(K||G||V||H)&&(n.loadHidden||ie(y[i]))&&(N&&Z<3&&!h&&(B<3||ee<4)||re(y[i],u))){if(he(y[i]),c=!0,Z>9)break}else!c&&N&&!a&&Z<4&&ee<4&&B>2&&(F[0]||n.preloadAfterLoad)&&(F[0]||!h&&(K||G||V||H||"auto"!=y[i][l](n.sizesAttr)))&&(a=F[0]||y[i]);a&&!c&&he(a)}},se=C(ne),oe=function(e){var t=e.target;t._lazyCache?delete t._lazyCache:(te(e),v(t,n.loadedClass),b(t,n.loadingClass),w(t,le),_(t,"lazyloaded"))},ae=x(oe),le=function(e){ae({target:e.target})},ce=function(e,t){var i=e.getAttribute("data-load-mode")||n.iframeLoadMode;0==i?e.contentWindow.location.replace(t):1==i&&(e.src=t)},ue=function(e){var t,i=e[l](n.srcsetAttr);(t=n.customMedia[e[l]("data-media")||e[l]("media")])&&e.setAttribute("media",t),i&&e.setAttribute("srcset",i)},de=x((function(e,t,i,r,s){var o,a,c,d,h,f;(h=_(e,"lazybeforeunveil",t)).defaultPrevented||(r&&(i?v(e,n.autosizesClass):e.setAttribute("sizes",r)),a=e[l](n.srcsetAttr),o=e[l](n.srcAttr),s&&(d=(c=e.parentNode)&&p.test(c.nodeName||"")),f=t.firesLoad||"src"in e&&(a||o||d),h={target:e},v(e,n.loadingClass),f&&(clearTimeout(j),j=u(te,2500),w(e,le,!0)),d&&g.call(c.getElementsByTagName("source"),ue),a?e.setAttribute("srcset",a):o&&!d&&(Y.test(e.nodeName)?ce(e,o):e.src=o),s&&(a||d)&&E(e,{src:o})),e._lazyRace&&delete e._lazyRace,b(e,n.lazyClass),k((function(){var t=e.complete&&e.naturalWidth>1;f&&!t||(t&&v(e,n.fastLoadedClass),oe(h),e._lazyCache=!0,u((function(){"_lazyCache"in e&&delete e._lazyCache}),9)),"lazy"==e.loading&&Z--}),!0)})),he=function(e){if(!e._lazyRace){var t,i=W.test(e.nodeName),r=i&&(e[l](n.sizesAttr)||e[l]("sizes")),s="auto"==r;(!s&&N||!i||!e[l]("src")&&!e.srcset||e.complete||y(e,n.errorClass)||!y(e,n.lazyClass))&&(t=_(e,"lazyunveilread").detail,s&&L.updateElem(e,!0,e.offsetWidth),e._lazyRace=!0,Z++,de(e,t,s,r,i))}},pe=A((function(){n.loadMode=3,se()})),fe=function(){3==n.loadMode&&(n.loadMode=2),pe()},me=function(){N||(i.now()-U<999?u(me,999):(N=!0,n.loadMode=3,se(),c("scroll",fe,!0)))},{_:function(){U=i.now(),r.elements=t.getElementsByClassName(n.lazyClass),F=t.getElementsByClassName(n.lazyClass+" "+n.preloadClass),c("scroll",se,!0),c("resize",se,!0),c("pageshow",(function(e){if(e.persisted){var i=t.querySelectorAll("."+n.loadingClass);i.length&&i.forEach&&d((function(){i.forEach((function(e){e.complete&&he(e)}))}))}})),e.MutationObserver?new MutationObserver(se).observe(s,{childList:!0,subtree:!0,attributes:!0}):(s[a]("DOMNodeInserted",se,!0),s[a]("DOMAttrModified",se,!0),setInterval(se,999)),c("hashchange",se,!0),["focus","mouseover","click","load","transitionend","animationend"].forEach((function(e){t[a](e,se,!0)})),/d$|^c/.test(t.readyState)?me():(c("load",me),t[a]("DOMContentLoaded",se),u(me,2e4)),r.elements.length?(ne(),k._lsFlush()):se()},checkElems:se,unveil:he,_aLSL:fe}),L=(D=x((function(e,t,i,r){var n,s,o;if(e._lazysizesWidth=r,r+="px",e.setAttribute("sizes",r),p.test(t.nodeName||""))for(s=0,o=(n=t.getElementsByTagName("source")).length;s<o;s++)n[s].setAttribute("sizes",r);i.detail.dataAttr||E(e,i.detail)})),I=function(e,t,i){var r,n=e.parentNode;n&&(i=S(e,n,i),(r=_(e,"lazybeforesizes",{width:i,dataAttr:!!t})).defaultPrevented||(i=r.detail.width)&&i!==e._lazysizesWidth&&D(e,n,r,i))},M=A((function(){var e,t=O.length;if(t)for(e=0;e<t;e++)I(O[e])})),{_:function(){O=t.getElementsByClassName(n.autosizesClass),c("resize",M)},checkElems:M,updateElem:I}),P=function(){!P.i&&t.getElementsByClassName&&(P.i=!0,L._(),R._())};var O,D,I,M;var F,N,j,B,U,z,$,H,V,G,K,q,W,Y,X,Q,J,Z,ee,te,ie,re,ne,se,oe,ae,le,ce,ue,de,he,pe,fe,me;var ge,ye,ve,be,we,_e,Ee;return u((function(){n.init&&P()})),r={cfg:n,autoSizer:L,loader:R,init:P,uP:E,aC:v,rC:b,hC:y,fire:_,gW:S,rAF:k}}(t,t.document,Date);t.lazySizes=r,e.exports&&(e.exports=r)}("undefined"!=typeof window?window:{})},330:function(e,t,i){"object"==typeof navigator&&(e.exports=function(){"use strict";function e(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function t(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function n(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(Object(i),!0).forEach((function(t){r(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var o={addCSS:!0,thumbWidth:15,watch:!0},a=function(e){return null!=e?e.constructor:null},l=function(e,t){return!!(e&&t&&e instanceof t)},c=function(e){return null==e},u=function(e){return a(e)===Object},d=function(e){return a(e)===String},h=function(e){return Array.isArray(e)},p=function(e){return l(e,NodeList)},f={nullOrUndefined:c,object:u,number:function(e){return a(e)===Number&&!Number.isNaN(e)},string:d,boolean:function(e){return a(e)===Boolean},function:function(e){return a(e)===Function},array:h,nodeList:p,element:function(e){return l(e,Element)},event:function(e){return l(e,Event)},empty:function(e){return c(e)||(d(e)||h(e)||p(e))&&!e.length||u(e)&&!Object.keys(e).length}};function m(e,t){if(1>t){var i=function(e){var t="".concat(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0}(t);return parseFloat(e.toFixed(i))}return Math.round(e/t)*t}var g=function(){function e(t,i){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),f.element(t)?this.element=t:f.string(t)&&(this.element=document.querySelector(t)),f.element(this.element)&&f.empty(this.element.rangeTouch)&&(this.config=s({},o,{},i),this.init())}return function(e,i,r){i&&t(e.prototype,i),r&&t(e,r)}(e,[{key:"init",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="none",this.element.style.webKitUserSelect="none",this.element.style.touchAction="manipulation"),this.listeners(!0),this.element.rangeTouch=this)}},{key:"destroy",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="",this.element.style.webKitUserSelect="",this.element.style.touchAction=""),this.listeners(!1),this.element.rangeTouch=null)}},{key:"listeners",value:function(e){var t=this,i=e?"addEventListener":"removeEventListener";["touchstart","touchmove","touchend"].forEach((function(e){t.element[i](e,(function(e){return t.set(e)}),!1)}))}},{key:"get",value:function(t){if(!e.enabled||!f.event(t))return null;var i,r=t.target,n=t.changedTouches[0],s=parseFloat(r.getAttribute("min"))||0,o=parseFloat(r.getAttribute("max"))||100,a=parseFloat(r.getAttribute("step"))||1,l=r.getBoundingClientRect(),c=100/l.width*(this.config.thumbWidth/2)/100;return 0>(i=100/l.width*(n.clientX-l.left))?i=0:100<i&&(i=100),50>i?i-=(100-2*i)*c:50<i&&(i+=2*(i-50)*c),s+m(i/100*(o-s),a)}},{key:"set",value:function(t){e.enabled&&f.event(t)&&!t.target.disabled&&(t.preventDefault(),t.target.value=this.get(t),function(e,t){if(e&&t){var i=new Event(t,{bubbles:!0});e.dispatchEvent(i)}}(t.target,"touchend"===t.type?"change":"input"))}}],[{key:"setup",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=null;if(f.empty(t)||f.string(t)?r=Array.from(document.querySelectorAll(f.string(t)?t:'input[type="range"]')):f.element(t)?r=[t]:f.nodeList(t)?r=Array.from(t):f.array(t)&&(r=t.filter(f.element)),f.empty(r))return null;var n=s({},o,{},i);if(f.string(t)&&n.watch){var a=new MutationObserver((function(i){Array.from(i).forEach((function(i){Array.from(i.addedNodes).forEach((function(i){f.element(i)&&function(e,t){return function(){return Array.from(document.querySelectorAll(t)).includes(this)}.call(e,t)}(i,t)&&new e(i,n)}))}))}));a.observe(document.body,{childList:!0,subtree:!0})}return r.map((function(t){return new e(t,i)}))}},{key:"enabled",get:function(){return"ontouchstart"in document.documentElement}}]),e}();const y=e=>null!=e?e.constructor:null,v=(e,t)=>Boolean(e&&t&&e instanceof t),b=e=>null==e,w=e=>y(e)===Object,_=e=>y(e)===String,E=e=>"function"==typeof e,T=e=>Array.isArray(e),S=e=>v(e,NodeList),k=e=>b(e)||(_(e)||T(e)||S(e))&&!e.length||w(e)&&!Object.keys(e).length;var x={nullOrUndefined:b,object:w,number:e=>y(e)===Number&&!Number.isNaN(e),string:_,boolean:e=>y(e)===Boolean,function:E,array:T,weakMap:e=>v(e,WeakMap),nodeList:S,element:e=>null!==e&&"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument,textNode:e=>y(e)===Text,event:e=>v(e,Event),keyboardEvent:e=>v(e,KeyboardEvent),cue:e=>v(e,window.TextTrackCue)||v(e,window.VTTCue),track:e=>v(e,TextTrack)||!b(e)&&_(e.kind),promise:e=>v(e,Promise)&&E(e.then),url:e=>{if(v(e,window.URL))return!0;if(!_(e))return!1;let t=e;e.startsWith("http://")&&e.startsWith("https://")||(t=`http://${e}`);try{return!k(new URL(t).hostname)}catch(e){return!1}},empty:k};const C=(()=>{const e=document.createElement("span"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},i=Object.keys(t).find((t=>void 0!==e.style[t]));return!!x.string(i)&&t[i]})();function A(e,t){setTimeout((()=>{try{e.hidden=!0,e.offsetHeight,e.hidden=!1}catch(e){}}),t)}var R={isIE:Boolean(window.document.documentMode),isEdge:/Edge/g.test(navigator.userAgent),isWebKit:"WebkitAppearance"in document.documentElement.style&&!/Edge/g.test(navigator.userAgent),isIPhone:/iPhone|iPod/gi.test(navigator.userAgent)&&navigator.maxTouchPoints>1,isIPadOS:"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,isIos:/iPad|iPhone|iPod/gi.test(navigator.userAgent)&&navigator.maxTouchPoints>1};function L(e,t){return t.split(".").reduce(((e,t)=>e&&e[t]),e)}function P(e={},...t){if(!t.length)return e;const i=t.shift();return x.object(i)?(Object.keys(i).forEach((t=>{x.object(i[t])?(Object.keys(e).includes(t)||Object.assign(e,{[t]:{}}),P(e[t],i[t])):Object.assign(e,{[t]:i[t]})})),P(e,...t)):e}function O(e,t){const i=e.length?e:[e];Array.from(i).reverse().forEach(((e,i)=>{const r=i>0?t.cloneNode(!0):t,n=e.parentNode,s=e.nextSibling;r.appendChild(e),s?n.insertBefore(r,s):n.appendChild(r)}))}function D(e,t){x.element(e)&&!x.empty(t)&&Object.entries(t).filter((([,e])=>!x.nullOrUndefined(e))).forEach((([t,i])=>e.setAttribute(t,i)))}function I(e,t,i){const r=document.createElement(e);return x.object(t)&&D(r,t),x.string(i)&&(r.innerText=i),r}function M(e,t,i,r){x.element(t)&&t.appendChild(I(e,i,r))}function F(e){x.nodeList(e)||x.array(e)?Array.from(e).forEach(F):x.element(e)&&x.element(e.parentNode)&&e.parentNode.removeChild(e)}function N(e){if(!x.element(e))return;let{length:t}=e.childNodes;for(;t>0;)e.removeChild(e.lastChild),t-=1}function j(e,t){return x.element(t)&&x.element(t.parentNode)&&x.element(e)?(t.parentNode.replaceChild(e,t),e):null}function B(e,t){if(!x.string(e)||x.empty(e))return{};const i={},r=P({},t);return e.split(",").forEach((e=>{const t=e.trim(),n=t.replace(".",""),s=t.replace(/[[\]]/g,"").split("="),[o]=s,a=s.length>1?s[1].replace(/["']/g,""):"";switch(t.charAt(0)){case".":x.string(r.class)?i.class=`${r.class} ${n}`:i.class=n;break;case"#":i.id=t.replace("#","");break;case"[":i[o]=a}})),P(r,i)}function U(e,t){if(!x.element(e))return;let i=t;x.boolean(i)||(i=!e.hidden),e.hidden=i}function z(e,t,i){if(x.nodeList(e))return Array.from(e).map((e=>z(e,t,i)));if(x.element(e)){let r="toggle";return void 0!==i&&(r=i?"add":"remove"),e.classList[r](t),e.classList.contains(t)}return!1}function $(e,t){return x.element(e)&&e.classList.contains(t)}function H(e,t){const{prototype:i}=Element;return(i.matches||i.webkitMatchesSelector||i.mozMatchesSelector||i.msMatchesSelector||function(){return Array.from(document.querySelectorAll(t)).includes(this)}).call(e,t)}function V(e){return this.elements.container.querySelectorAll(e)}function G(e){return this.elements.container.querySelector(e)}function K(e=null,t=!1){x.element(e)&&e.focus({preventScroll:!0,focusVisible:t})}const q={"audio/ogg":"vorbis","audio/wav":"1","video/webm":"vp8, vorbis","video/mp4":"avc1.42E01E, mp4a.40.2","video/ogg":"theora"},W={audio:"canPlayType"in document.createElement("audio"),video:"canPlayType"in document.createElement("video"),check(e,t){const i=W[e]||"html5"!==t;return{api:i,ui:i&&W.rangeInput}},pip:!(R.isIPhone||!x.function(I("video").webkitSetPresentationMode)&&(!document.pictureInPictureEnabled||I("video").disablePictureInPicture)),airplay:x.function(window.WebKitPlaybackTargetAvailabilityEvent),playsinline:"playsInline"in document.createElement("video"),mime(e){if(x.empty(e))return!1;const[t]=e.split("/");let i=e;if(!this.isHTML5||t!==this.type)return!1;Object.keys(q).includes(i)&&(i+=`; codecs="${q[e]}"`);try{return Boolean(i&&this.media.canPlayType(i).replace(/no/,""))}catch(e){return!1}},textTracks:"textTracks"in document.createElement("video"),rangeInput:(()=>{const e=document.createElement("input");return e.type="range","range"===e.type})(),touch:"ontouchstart"in document.documentElement,transitions:!1!==C,reducedMotion:"matchMedia"in window&&window.matchMedia("(prefers-reduced-motion)").matches},Y=(()=>{let e=!1;try{const t=Object.defineProperty({},"passive",{get:()=>(e=!0,null)});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(e){}return e})();function X(e,t,i,r=!1,n=!0,s=!1){if(!e||!("addEventListener"in e)||x.empty(t)||!x.function(i))return;const o=t.split(" ");let a=s;Y&&(a={passive:n,capture:s}),o.forEach((t=>{this&&this.eventListeners&&r&&this.eventListeners.push({element:e,type:t,callback:i,options:a}),e[r?"addEventListener":"removeEventListener"](t,i,a)}))}function Q(e,t="",i,r=!0,n=!1){X.call(this,e,t,i,!0,r,n)}function J(e,t="",i,r=!0,n=!1){X.call(this,e,t,i,!1,r,n)}function Z(e,t="",i,r=!0,n=!1){const s=(...o)=>{J(e,t,s,r,n),i.apply(this,o)};X.call(this,e,t,s,!0,r,n)}function ee(e,t="",i=!1,r={}){if(!x.element(e)||x.empty(t))return;const n=new CustomEvent(t,{bubbles:i,detail:{...r,plyr:this}});e.dispatchEvent(n)}function te(){this&&this.eventListeners&&(this.eventListeners.forEach((e=>{const{element:t,type:i,callback:r,options:n}=e;t.removeEventListener(i,r,n)})),this.eventListeners=[])}function ie(){return new Promise((e=>this.ready?setTimeout(e,0):Q.call(this,this.elements.container,"ready",e))).then((()=>{}))}function re(e){x.promise(e)&&e.then(null,(()=>{}))}function ne(e){return x.array(e)?e.filter(((t,i)=>e.indexOf(t)===i)):e}function se(e,t){return x.array(e)&&e.length?e.reduce(((e,i)=>Math.abs(i-t)<Math.abs(e-t)?i:e)):null}function oe(e){return!(!window||!window.CSS)&&window.CSS.supports(e)}const ae=[[1,1],[4,3],[3,4],[5,4],[4,5],[3,2],[2,3],[16,10],[10,16],[16,9],[9,16],[21,9],[9,21],[32,9],[9,32]].reduce(((e,[t,i])=>({...e,[t/i]:[t,i]})),{});function le(e){return!!(x.array(e)||x.string(e)&&e.includes(":"))&&(x.array(e)?e:e.split(":")).map(Number).every(x.number)}function ce(e){if(!x.array(e)||!e.every(x.number))return null;const[t,i]=e,r=(e,t)=>0===t?e:r(t,e%t),n=r(t,i);return[t/n,i/n]}function ue(e){const t=e=>le(e)?e.split(":").map(Number):null;let i=t(e);if(null===i&&(i=t(this.config.ratio)),null===i&&!x.empty(this.embed)&&x.array(this.embed.ratio)&&({ratio:i}=this.embed),null===i&&this.isHTML5){const{videoWidth:e,videoHeight:t}=this.media;i=[e,t]}return ce(i)}function de(e){if(!this.isVideo)return{};const{wrapper:t}=this.elements,i=ue.call(this,e);if(!x.array(i))return{};const[r,n]=ce(i),s=100/r*n;if(oe(`aspect-ratio: ${r}/${n}`)?t.style.aspectRatio=`${r}/${n}`:t.style.paddingBottom=`${s}%`,this.isVimeo&&!this.config.vimeo.premium&&this.supported.ui){const e=100/this.media.offsetWidth*parseInt(window.getComputedStyle(this.media).paddingBottom,10),i=(e-s)/(e/50);this.fullscreen.active?t.style.paddingBottom=null:this.media.style.transform=`translateY(-${i}%)`}else this.isHTML5&&t.classList.add(this.config.classNames.videoFixedRatio);return{padding:s,ratio:i}}function he(e,t,i=.05){const r=e/t,n=se(Object.keys(ae),r);return Math.abs(n-r)<=i?ae[n]:[e,t]}const pe={getSources(){return this.isHTML5?Array.from(this.media.querySelectorAll("source")).filter((e=>{const t=e.getAttribute("type");return!!x.empty(t)||W.mime.call(this,t)})):[]},getQualityOptions(){return this.config.quality.forced?this.config.quality.options:pe.getSources.call(this).map((e=>Number(e.getAttribute("size")))).filter(Boolean)},setup(){if(!this.isHTML5)return;const e=this;e.options.speed=e.config.speed.options,x.empty(this.config.ratio)||de.call(e),Object.defineProperty(e.media,"quality",{get(){const t=pe.getSources.call(e).find((t=>t.getAttribute("src")===e.source));return t&&Number(t.getAttribute("size"))},set(t){if(e.quality!==t){if(e.config.quality.forced&&x.function(e.config.quality.onChange))e.config.quality.onChange(t);else{const i=pe.getSources.call(e).find((e=>Number(e.getAttribute("size"))===t));if(!i)return;const{currentTime:r,paused:n,preload:s,readyState:o,playbackRate:a}=e.media;e.media.src=i.getAttribute("src"),("none"!==s||o)&&(e.once("loadedmetadata",(()=>{e.speed=a,e.currentTime=r,n||re(e.play())})),e.media.load())}ee.call(e,e.media,"qualitychange",!1,{quality:t})}}})},cancelRequests(){this.isHTML5&&(F(pe.getSources.call(this)),this.media.setAttribute("src",this.config.blankVideo),this.media.load(),this.debug.log("Cancelled network requests"))}};function fe(e,...t){return x.empty(e)?e:e.toString().replace(/{(\d+)}/g,((e,i)=>t[i].toString()))}const me=(e="",t="",i="")=>e.replace(new RegExp(t.toString().replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),"g"),i.toString()),ge=(e="")=>e.toString().replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()));function ye(e=""){let t=e.toString();return t=function(e=""){let t=e.toString();return t=me(t,"-"," "),t=me(t,"_"," "),t=ge(t),me(t," ","")}(t),t.charAt(0).toLowerCase()+t.slice(1)}function ve(e){const t=document.createElement("div");return t.appendChild(e),t.innerHTML}const be={pip:"PIP",airplay:"AirPlay",html5:"HTML5",vimeo:"Vimeo",youtube:"YouTube"},we={get(e="",t={}){if(x.empty(e)||x.empty(t))return"";let i=L(t.i18n,e);if(x.empty(i))return Object.keys(be).includes(e)?be[e]:"";const r={"{seektime}":t.seekTime,"{title}":t.title};return Object.entries(r).forEach((([e,t])=>{i=me(i,e,t)})),i}};class _e{constructor(t){e(this,"get",(e=>{if(!_e.supported||!this.enabled)return null;const t=window.localStorage.getItem(this.key);if(x.empty(t))return null;const i=JSON.parse(t);return x.string(e)&&e.length?i[e]:i})),e(this,"set",(e=>{if(!_e.supported||!this.enabled)return;if(!x.object(e))return;let t=this.get();x.empty(t)&&(t={}),P(t,e);try{window.localStorage.setItem(this.key,JSON.stringify(t))}catch(e){}})),this.enabled=t.config.storage.enabled,this.key=t.config.storage.key}static get supported(){try{if(!("localStorage"in window))return!1;const e="___test";return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch(e){return!1}}}function Ee(e,t="text"){return new Promise(((i,r)=>{try{const r=new XMLHttpRequest;if(!("withCredentials"in r))return;r.addEventListener("load",(()=>{if("text"===t)try{i(JSON.parse(r.responseText))}catch(e){i(r.responseText)}else i(r.response)})),r.addEventListener("error",(()=>{throw new Error(r.status)})),r.open("GET",e,!0),r.responseType=t,r.send()}catch(e){r(e)}}))}function Te(e,t){if(!x.string(e))return;const i="cache",r=x.string(t);let n=!1;const s=()=>null!==document.getElementById(t),o=(e,t)=>{e.innerHTML=t,r&&s()||document.body.insertAdjacentElement("afterbegin",e)};if(!r||!s()){const s=_e.supported,a=document.createElement("div");if(a.setAttribute("hidden",""),r&&a.setAttribute("id",t),s){const e=window.localStorage.getItem(`${i}-${t}`);if(n=null!==e,n){const t=JSON.parse(e);o(a,t.content)}}Ee(e).then((e=>{if(!x.empty(e)){if(s)try{window.localStorage.setItem(`${i}-${t}`,JSON.stringify({content:e}))}catch(e){}o(a,e)}})).catch((()=>{}))}}const Se=e=>Math.trunc(e/60/60%60,10),ke=e=>Math.trunc(e/60%60,10),xe=e=>Math.trunc(e%60,10);function Ce(e=0,t=!1,i=!1){if(!x.number(e))return Ce(void 0,t,i);const r=e=>`0${e}`.slice(-2);let n=Se(e);const s=ke(e),o=xe(e);return n=t||n>0?`${n}:`:"",`${i&&e>0?"-":""}${n}${r(s)}:${r(o)}`}const Ae={getIconUrl(){const e=new URL(this.config.iconUrl,window.location),t=window.location.host?window.location.host:window.top.location.host,i=e.host!==t||R.isIE&&!window.svg4everybody;return{url:this.config.iconUrl,cors:i}},findElements(){try{return this.elements.controls=G.call(this,this.config.selectors.controls.wrapper),this.elements.buttons={play:V.call(this,this.config.selectors.buttons.play),pause:G.call(this,this.config.selectors.buttons.pause),restart:G.call(this,this.config.selectors.buttons.restart),rewind:G.call(this,this.config.selectors.buttons.rewind),fastForward:G.call(this,this.config.selectors.buttons.fastForward),mute:G.call(this,this.config.selectors.buttons.mute),pip:G.call(this,this.config.selectors.buttons.pip),airplay:G.call(this,this.config.selectors.buttons.airplay),settings:G.call(this,this.config.selectors.buttons.settings),captions:G.call(this,this.config.selectors.buttons.captions),fullscreen:G.call(this,this.config.selectors.buttons.fullscreen)},this.elements.progress=G.call(this,this.config.selectors.progress),this.elements.inputs={seek:G.call(this,this.config.selectors.inputs.seek),volume:G.call(this,this.config.selectors.inputs.volume)},this.elements.display={buffer:G.call(this,this.config.selectors.display.buffer),currentTime:G.call(this,this.config.selectors.display.currentTime),duration:G.call(this,this.config.selectors.display.duration)},x.element(this.elements.progress)&&(this.elements.display.seekTooltip=this.elements.progress.querySelector(`.${this.config.classNames.tooltip}`)),!0}catch(e){return this.debug.warn("It looks like there is a problem with your custom controls HTML",e),this.toggleNativeControls(!0),!1}},createIcon(e,t){const i="http://www.w3.org/2000/svg",r=Ae.getIconUrl.call(this),n=`${r.cors?"":r.url}#${this.config.iconPrefix}`,s=document.createElementNS(i,"svg");D(s,P(t,{"aria-hidden":"true",focusable:"false"}));const o=document.createElementNS(i,"use"),a=`${n}-${e}`;return"href"in o&&o.setAttributeNS("http://www.w3.org/1999/xlink","href",a),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a),s.appendChild(o),s},createLabel(e,t={}){const i=we.get(e,this.config);return I("span",{...t,class:[t.class,this.config.classNames.hidden].filter(Boolean).join(" ")},i)},createBadge(e){if(x.empty(e))return null;const t=I("span",{class:this.config.classNames.menu.value});return t.appendChild(I("span",{class:this.config.classNames.menu.badge},e)),t},createButton(e,t){const i=P({},t);let r=ye(e);const n={element:"button",toggle:!1,label:null,icon:null,labelPressed:null,iconPressed:null};switch(["element","icon","label"].forEach((e=>{Object.keys(i).includes(e)&&(n[e]=i[e],delete i[e])})),"button"!==n.element||Object.keys(i).includes("type")||(i.type="button"),Object.keys(i).includes("class")?i.class.split(" ").some((e=>e===this.config.classNames.control))||P(i,{class:`${i.class} ${this.config.classNames.control}`}):i.class=this.config.classNames.control,e){case"play":n.toggle=!0,n.label="play",n.labelPressed="pause",n.icon="play",n.iconPressed="pause";break;case"mute":n.toggle=!0,n.label="mute",n.labelPressed="unmute",n.icon="volume",n.iconPressed="muted";break;case"captions":n.toggle=!0,n.label="enableCaptions",n.labelPressed="disableCaptions",n.icon="captions-off",n.iconPressed="captions-on";break;case"fullscreen":n.toggle=!0,n.label="enterFullscreen",n.labelPressed="exitFullscreen",n.icon="enter-fullscreen",n.iconPressed="exit-fullscreen";break;case"play-large":i.class+=` ${this.config.classNames.control}--overlaid`,r="play",n.label="play",n.icon="play";break;default:x.empty(n.label)&&(n.label=r),x.empty(n.icon)&&(n.icon=e)}const s=I(n.element);return n.toggle?(s.appendChild(Ae.createIcon.call(this,n.iconPressed,{class:"icon--pressed"})),s.appendChild(Ae.createIcon.call(this,n.icon,{class:"icon--not-pressed"})),s.appendChild(Ae.createLabel.call(this,n.labelPressed,{class:"label--pressed"})),s.appendChild(Ae.createLabel.call(this,n.label,{class:"label--not-pressed"}))):(s.appendChild(Ae.createIcon.call(this,n.icon)),s.appendChild(Ae.createLabel.call(this,n.label))),P(i,B(this.config.selectors.buttons[r],i)),D(s,i),"play"===r?(x.array(this.elements.buttons[r])||(this.elements.buttons[r]=[]),this.elements.buttons[r].push(s)):this.elements.buttons[r]=s,s},createRange(e,t){const i=I("input",P(B(this.config.selectors.inputs[e]),{type:"range",min:0,max:100,step:.01,value:0,autocomplete:"off",role:"slider","aria-label":we.get(e,this.config),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":0},t));return this.elements.inputs[e]=i,Ae.updateRangeFill.call(this,i),g.setup(i),i},createProgress(e,t){const i=I("progress",P(B(this.config.selectors.display[e]),{min:0,max:100,value:0,role:"progressbar","aria-hidden":!0},t));if("volume"!==e){i.appendChild(I("span",null,"0"));const t={played:"played",buffer:"buffered"}[e],r=t?we.get(t,this.config):"";i.innerText=`% ${r.toLowerCase()}`}return this.elements.display[e]=i,i},createTime(e,t){const i=B(this.config.selectors.display[e],t),r=I("div",P(i,{class:`${i.class?i.class:""} ${this.config.classNames.display.time} `.trim(),"aria-label":we.get(e,this.config),role:"timer"}),"00:00");return this.elements.display[e]=r,r},bindMenuItemShortcuts(e,t){Q.call(this,e,"keydown keyup",(i=>{if(![" ","ArrowUp","ArrowDown","ArrowRight"].includes(i.key))return;if(i.preventDefault(),i.stopPropagation(),"keydown"===i.type)return;const r=H(e,'[role="menuitemradio"]');if(!r&&[" ","ArrowRight"].includes(i.key))Ae.showMenuPanel.call(this,t,!0);else{let t;" "!==i.key&&("ArrowDown"===i.key||r&&"ArrowRight"===i.key?(t=e.nextElementSibling,x.element(t)||(t=e.parentNode.firstElementChild)):(t=e.previousElementSibling,x.element(t)||(t=e.parentNode.lastElementChild)),K.call(this,t,!0))}}),!1),Q.call(this,e,"keyup",(e=>{"Return"===e.key&&Ae.focusFirstMenuItem.call(this,null,!0)}))},createMenuItem({value:e,list:t,type:i,title:r,badge:n=null,checked:s=!1}){const o=B(this.config.selectors.inputs[i]),a=I("button",P(o,{type:"button",role:"menuitemradio",class:`${this.config.classNames.control} ${o.class?o.class:""}`.trim(),"aria-checked":s,value:e})),l=I("span");l.innerHTML=r,x.element(n)&&l.appendChild(n),a.appendChild(l),Object.defineProperty(a,"checked",{enumerable:!0,get:()=>"true"===a.getAttribute("aria-checked"),set(e){e&&Array.from(a.parentNode.children).filter((e=>H(e,'[role="menuitemradio"]'))).forEach((e=>e.setAttribute("aria-checked","false"))),a.setAttribute("aria-checked",e?"true":"false")}}),this.listeners.bind(a,"click keyup",(t=>{if(!x.keyboardEvent(t)||" "===t.key){switch(t.preventDefault(),t.stopPropagation(),a.checked=!0,i){case"language":this.currentTrack=Number(e);break;case"quality":this.quality=e;break;case"speed":this.speed=parseFloat(e)}Ae.showMenuPanel.call(this,"home",x.keyboardEvent(t))}}),i,!1),Ae.bindMenuItemShortcuts.call(this,a,i),t.appendChild(a)},formatTime(e=0,t=!1){return x.number(e)?Ce(e,Se(this.duration)>0,t):e},updateTimeDisplay(e=null,t=0,i=!1){x.element(e)&&x.number(t)&&(e.innerText=Ae.formatTime(t,i))},updateVolume(){this.supported.ui&&(x.element(this.elements.inputs.volume)&&Ae.setRange.call(this,this.elements.inputs.volume,this.muted?0:this.volume),x.element(this.elements.buttons.mute)&&(this.elements.buttons.mute.pressed=this.muted||0===this.volume))},setRange(e,t=0){x.element(e)&&(e.value=t,Ae.updateRangeFill.call(this,e))},updateProgress(e){if(!this.supported.ui||!x.event(e))return;let t=0;const i=(e,t)=>{const i=x.number(t)?t:0,r=x.element(e)?e:this.elements.display.buffer;if(x.element(r)){r.value=i;const e=r.getElementsByTagName("span")[0];x.element(e)&&(e.childNodes[0].nodeValue=i)}};if(e)switch(e.type){case"timeupdate":case"seeking":case"seeked":r=this.currentTime,n=this.duration,t=0===r||0===n||Number.isNaN(r)||Number.isNaN(n)?0:(r/n*100).toFixed(2),"timeupdate"===e.type&&Ae.setRange.call(this,this.elements.inputs.seek,t);break;case"playing":case"progress":i(this.elements.display.buffer,100*this.buffered)}var r,n},updateRangeFill(e){const t=x.event(e)?e.target:e;if(x.element(t)&&"range"===t.getAttribute("type")){if(H(t,this.config.selectors.inputs.seek)){t.setAttribute("aria-valuenow",this.currentTime);const e=Ae.formatTime(this.currentTime),i=Ae.formatTime(this.duration),r=we.get("seekLabel",this.config);t.setAttribute("aria-valuetext",r.replace("{currentTime}",e).replace("{duration}",i))}else if(H(t,this.config.selectors.inputs.volume)){const e=100*t.value;t.setAttribute("aria-valuenow",e),t.setAttribute("aria-valuetext",`${e.toFixed(1)}%`)}else t.setAttribute("aria-valuenow",t.value);(R.isWebKit||R.isIPadOS)&&t.style.setProperty("--value",t.value/t.max*100+"%")}},updateSeekTooltip(e){var t,i;if(!this.config.tooltips.seek||!x.element(this.elements.inputs.seek)||!x.element(this.elements.display.seekTooltip)||0===this.duration)return;const r=this.elements.display.seekTooltip,n=`${this.config.classNames.tooltip}--visible`,s=e=>z(r,n,e);if(this.touch)return void s(!1);let o=0;const a=this.elements.progress.getBoundingClientRect();if(x.event(e))o=100/a.width*(e.pageX-a.left);else{if(!$(r,n))return;o=parseFloat(r.style.left,10)}o<0?o=0:o>100&&(o=100);const l=this.duration/100*o;r.innerText=Ae.formatTime(l);const c=null===(t=this.config.markers)||void 0===t||null===(i=t.points)||void 0===i?void 0:i.find((({time:e})=>e===Math.round(l)));c&&r.insertAdjacentHTML("afterbegin",`${c.label}<br>`),r.style.left=`${o}%`,x.event(e)&&["mouseenter","mouseleave"].includes(e.type)&&s("mouseenter"===e.type)},timeUpdate(e){const t=!x.element(this.elements.display.duration)&&this.config.invertTime;Ae.updateTimeDisplay.call(this,this.elements.display.currentTime,t?this.duration-this.currentTime:this.currentTime,t),e&&"timeupdate"===e.type&&this.media.seeking||Ae.updateProgress.call(this,e)},durationUpdate(){if(!this.supported.ui||!this.config.invertTime&&this.currentTime)return;if(this.duration>=2**32)return U(this.elements.display.currentTime,!0),void U(this.elements.progress,!0);x.element(this.elements.inputs.seek)&&this.elements.inputs.seek.setAttribute("aria-valuemax",this.duration);const e=x.element(this.elements.display.duration);!e&&this.config.displayDuration&&this.paused&&Ae.updateTimeDisplay.call(this,this.elements.display.currentTime,this.duration),e&&Ae.updateTimeDisplay.call(this,this.elements.display.duration,this.duration),this.config.markers.enabled&&Ae.setMarkers.call(this),Ae.updateSeekTooltip.call(this)},toggleMenuButton(e,t){U(this.elements.settings.buttons[e],!t)},updateSetting(e,t,i){const r=this.elements.settings.panels[e];let n=null,s=t;if("captions"===e)n=this.currentTrack;else{if(n=x.empty(i)?this[e]:i,x.empty(n)&&(n=this.config[e].default),!x.empty(this.options[e])&&!this.options[e].includes(n))return void this.debug.warn(`Unsupported value of '${n}' for ${e}`);if(!this.config[e].options.includes(n))return void this.debug.warn(`Disabled value of '${n}' for ${e}`)}if(x.element(s)||(s=r&&r.querySelector('[role="menu"]')),!x.element(s))return;this.elements.settings.buttons[e].querySelector(`.${this.config.classNames.menu.value}`).innerHTML=Ae.getLabel.call(this,e,n);const o=s&&s.querySelector(`[value="${n}"]`);x.element(o)&&(o.checked=!0)},getLabel(e,t){switch(e){case"speed":return 1===t?we.get("normal",this.config):`${t}&times;`;case"quality":if(x.number(t)){const e=we.get(`qualityLabel.${t}`,this.config);return e.length?e:`${t}p`}return ge(t);case"captions":return Pe.getLabel.call(this);default:return null}},setQualityMenu(e){if(!x.element(this.elements.settings.panels.quality))return;const t="quality",i=this.elements.settings.panels.quality.querySelector('[role="menu"]');x.array(e)&&(this.options.quality=ne(e).filter((e=>this.config.quality.options.includes(e))));const r=!x.empty(this.options.quality)&&this.options.quality.length>1;if(Ae.toggleMenuButton.call(this,t,r),N(i),Ae.checkMenu.call(this),!r)return;const n=e=>{const t=we.get(`qualityBadge.${e}`,this.config);return t.length?Ae.createBadge.call(this,t):null};this.options.quality.sort(((e,t)=>{const i=this.config.quality.options;return i.indexOf(e)>i.indexOf(t)?1:-1})).forEach((e=>{Ae.createMenuItem.call(this,{value:e,list:i,type:t,title:Ae.getLabel.call(this,"quality",e),badge:n(e)})})),Ae.updateSetting.call(this,t,i)},setCaptionsMenu(){if(!x.element(this.elements.settings.panels.captions))return;const e="captions",t=this.elements.settings.panels.captions.querySelector('[role="menu"]'),i=Pe.getTracks.call(this),r=Boolean(i.length);if(Ae.toggleMenuButton.call(this,e,r),N(t),Ae.checkMenu.call(this),!r)return;const n=i.map(((e,i)=>({value:i,checked:this.captions.toggled&&this.currentTrack===i,title:Pe.getLabel.call(this,e),badge:e.language&&Ae.createBadge.call(this,e.language.toUpperCase()),list:t,type:"language"})));n.unshift({value:-1,checked:!this.captions.toggled,title:we.get("disabled",this.config),list:t,type:"language"}),n.forEach(Ae.createMenuItem.bind(this)),Ae.updateSetting.call(this,e,t)},setSpeedMenu(){if(!x.element(this.elements.settings.panels.speed))return;const e="speed",t=this.elements.settings.panels.speed.querySelector('[role="menu"]');this.options.speed=this.options.speed.filter((e=>e>=this.minimumSpeed&&e<=this.maximumSpeed));const i=!x.empty(this.options.speed)&&this.options.speed.length>1;Ae.toggleMenuButton.call(this,e,i),N(t),Ae.checkMenu.call(this),i&&(this.options.speed.forEach((i=>{Ae.createMenuItem.call(this,{value:i,list:t,type:e,title:Ae.getLabel.call(this,"speed",i)})})),Ae.updateSetting.call(this,e,t))},checkMenu(){const{buttons:e}=this.elements.settings,t=!x.empty(e)&&Object.values(e).some((e=>!e.hidden));U(this.elements.settings.menu,!t)},focusFirstMenuItem(e,t=!1){if(this.elements.settings.popup.hidden)return;let i=e;x.element(i)||(i=Object.values(this.elements.settings.panels).find((e=>!e.hidden)));const r=i.querySelector('[role^="menuitem"]');K.call(this,r,t)},toggleMenu(e){const{popup:t}=this.elements.settings,i=this.elements.buttons.settings;if(!x.element(t)||!x.element(i))return;const{hidden:r}=t;let n=r;if(x.boolean(e))n=e;else if(x.keyboardEvent(e)&&"Escape"===e.key)n=!1;else if(x.event(e)){const r=x.function(e.composedPath)?e.composedPath()[0]:e.target,s=t.contains(r);if(s||!s&&e.target!==i&&n)return}i.setAttribute("aria-expanded",n),U(t,!n),z(this.elements.container,this.config.classNames.menu.open,n),n&&x.keyboardEvent(e)?Ae.focusFirstMenuItem.call(this,null,!0):n||r||K.call(this,i,x.keyboardEvent(e))},getMenuSize(e){const t=e.cloneNode(!0);t.style.position="absolute",t.style.opacity=0,t.removeAttribute("hidden"),e.parentNode.appendChild(t);const i=t.scrollWidth,r=t.scrollHeight;return F(t),{width:i,height:r}},showMenuPanel(e="",t=!1){const i=this.elements.container.querySelector(`#plyr-settings-${this.id}-${e}`);if(!x.element(i))return;const r=i.parentNode,n=Array.from(r.children).find((e=>!e.hidden));if(W.transitions&&!W.reducedMotion){r.style.width=`${n.scrollWidth}px`,r.style.height=`${n.scrollHeight}px`;const e=Ae.getMenuSize.call(this,i),t=e=>{e.target===r&&["width","height"].includes(e.propertyName)&&(r.style.width="",r.style.height="",J.call(this,r,C,t))};Q.call(this,r,C,t),r.style.width=`${e.width}px`,r.style.height=`${e.height}px`}U(n,!0),U(i,!1),Ae.focusFirstMenuItem.call(this,i,t)},setDownloadUrl(){const e=this.elements.buttons.download;x.element(e)&&e.setAttribute("href",this.download)},create(e){const{bindMenuItemShortcuts:t,createButton:i,createProgress:r,createRange:n,createTime:s,setQualityMenu:o,setSpeedMenu:a,showMenuPanel:l}=Ae;this.elements.controls=null,x.array(this.config.controls)&&this.config.controls.includes("play-large")&&this.elements.container.appendChild(i.call(this,"play-large"));const c=I("div",B(this.config.selectors.controls.wrapper));this.elements.controls=c;const u={class:"plyr__controls__item"};return ne(x.array(this.config.controls)?this.config.controls:[]).forEach((o=>{if("restart"===o&&c.appendChild(i.call(this,"restart",u)),"rewind"===o&&c.appendChild(i.call(this,"rewind",u)),"play"===o&&c.appendChild(i.call(this,"play",u)),"fast-forward"===o&&c.appendChild(i.call(this,"fast-forward",u)),"progress"===o){const t=I("div",{class:`${u.class} plyr__progress__container`}),i=I("div",B(this.config.selectors.progress));if(i.appendChild(n.call(this,"seek",{id:`plyr-seek-${e.id}`})),i.appendChild(r.call(this,"buffer")),this.config.tooltips.seek){const e=I("span",{class:this.config.classNames.tooltip},"00:00");i.appendChild(e),this.elements.display.seekTooltip=e}this.elements.progress=i,t.appendChild(this.elements.progress),c.appendChild(t)}if("current-time"===o&&c.appendChild(s.call(this,"currentTime",u)),"duration"===o&&c.appendChild(s.call(this,"duration",u)),"mute"===o||"volume"===o){let{volume:t}=this.elements;if(x.element(t)&&c.contains(t)||(t=I("div",P({},u,{class:`${u.class} plyr__volume`.trim()})),this.elements.volume=t,c.appendChild(t)),"mute"===o&&t.appendChild(i.call(this,"mute")),"volume"===o&&!R.isIos&&!R.isIPadOS){const i={max:1,step:.05,value:this.config.volume};t.appendChild(n.call(this,"volume",P(i,{id:`plyr-volume-${e.id}`})))}}if("captions"===o&&c.appendChild(i.call(this,"captions",u)),"settings"===o&&!x.empty(this.config.settings)){const r=I("div",P({},u,{class:`${u.class} plyr__menu`.trim(),hidden:""}));r.appendChild(i.call(this,"settings",{"aria-haspopup":!0,"aria-controls":`plyr-settings-${e.id}`,"aria-expanded":!1}));const n=I("div",{class:"plyr__menu__container",id:`plyr-settings-${e.id}`,hidden:""}),s=I("div"),o=I("div",{id:`plyr-settings-${e.id}-home`}),a=I("div",{role:"menu"});o.appendChild(a),s.appendChild(o),this.elements.settings.panels.home=o,this.config.settings.forEach((i=>{const r=I("button",P(B(this.config.selectors.buttons.settings),{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--forward`,role:"menuitem","aria-haspopup":!0,hidden:""}));t.call(this,r,i),Q.call(this,r,"click",(()=>{l.call(this,i,!1)}));const n=I("span",null,we.get(i,this.config)),o=I("span",{class:this.config.classNames.menu.value});o.innerHTML=e[i],n.appendChild(o),r.appendChild(n),a.appendChild(r);const c=I("div",{id:`plyr-settings-${e.id}-${i}`,hidden:""}),u=I("button",{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--back`});u.appendChild(I("span",{"aria-hidden":!0},we.get(i,this.config))),u.appendChild(I("span",{class:this.config.classNames.hidden},we.get("menuBack",this.config))),Q.call(this,c,"keydown",(e=>{"ArrowLeft"===e.key&&(e.preventDefault(),e.stopPropagation(),l.call(this,"home",!0))}),!1),Q.call(this,u,"click",(()=>{l.call(this,"home",!1)})),c.appendChild(u),c.appendChild(I("div",{role:"menu"})),s.appendChild(c),this.elements.settings.buttons[i]=r,this.elements.settings.panels[i]=c})),n.appendChild(s),r.appendChild(n),c.appendChild(r),this.elements.settings.popup=n,this.elements.settings.menu=r}if("pip"===o&&W.pip&&c.appendChild(i.call(this,"pip",u)),"airplay"===o&&W.airplay&&c.appendChild(i.call(this,"airplay",u)),"download"===o){const e=P({},u,{element:"a",href:this.download,target:"_blank"});this.isHTML5&&(e.download="");const{download:t}=this.config.urls;!x.url(t)&&this.isEmbed&&P(e,{icon:`logo-${this.provider}`,label:this.provider}),c.appendChild(i.call(this,"download",e))}"fullscreen"===o&&c.appendChild(i.call(this,"fullscreen",u))})),this.isHTML5&&o.call(this,pe.getQualityOptions.call(this)),a.call(this),c},inject(){if(this.config.loadSprite){const e=Ae.getIconUrl.call(this);e.cors&&Te(e.url,"sprite-plyr")}this.id=Math.floor(1e4*Math.random());let e=null;this.elements.controls=null;const t={id:this.id,seektime:this.config.seekTime,title:this.config.title};let i,r=!0;if(x.function(this.config.controls)&&(this.config.controls=this.config.controls.call(this,t)),this.config.controls||(this.config.controls=[]),x.element(this.config.controls)||x.string(this.config.controls)?e=this.config.controls:(e=Ae.create.call(this,{id:this.id,seektime:this.config.seekTime,speed:this.speed,quality:this.quality,captions:Pe.getLabel.call(this)}),r=!1),r&&x.string(this.config.controls)&&(e=(e=>{let i=e;return Object.entries(t).forEach((([e,t])=>{i=me(i,`{${e}}`,t)})),i})(e)),x.string(this.config.selectors.controls.container)&&(i=document.querySelector(this.config.selectors.controls.container)),x.element(i)||(i=this.elements.container),i[x.element(e)?"insertAdjacentElement":"insertAdjacentHTML"]("afterbegin",e),x.element(this.elements.controls)||Ae.findElements.call(this),!x.empty(this.elements.buttons)){const e=e=>{const t=this.config.classNames.controlPressed;e.setAttribute("aria-pressed","false"),Object.defineProperty(e,"pressed",{configurable:!0,enumerable:!0,get:()=>$(e,t),set(i=!1){z(e,t,i),e.setAttribute("aria-pressed",i?"true":"false")}})};Object.values(this.elements.buttons).filter(Boolean).forEach((t=>{x.array(t)||x.nodeList(t)?Array.from(t).filter(Boolean).forEach(e):e(t)}))}if(R.isEdge&&A(i),this.config.tooltips.controls){const{classNames:e,selectors:t}=this.config,i=`${t.controls.wrapper} ${t.labels} .${e.hidden}`,r=V.call(this,i);Array.from(r).forEach((e=>{z(e,this.config.classNames.hidden,!1),z(e,this.config.classNames.tooltip,!0)}))}},setMediaMetadata(){try{"mediaSession"in navigator&&(navigator.mediaSession.metadata=new window.MediaMetadata({title:this.config.mediaMetadata.title,artist:this.config.mediaMetadata.artist,album:this.config.mediaMetadata.album,artwork:this.config.mediaMetadata.artwork}))}catch(e){}},setMarkers(){var e,t;if(!this.duration||this.elements.markers)return;const i=null===(e=this.config.markers)||void 0===e||null===(t=e.points)||void 0===t?void 0:t.filter((({time:e})=>e>0&&e<this.duration));if(null==i||!i.length)return;const r=document.createDocumentFragment(),n=document.createDocumentFragment();let s=null;const o=`${this.config.classNames.tooltip}--visible`,a=e=>z(s,o,e);i.forEach((e=>{const t=I("span",{class:this.config.classNames.marker},""),i=e.time/this.duration*100+"%";s&&(t.addEventListener("mouseenter",(()=>{e.label||(s.style.left=i,s.innerHTML=e.label,a(!0))})),t.addEventListener("mouseleave",(()=>{a(!1)}))),t.addEventListener("click",(()=>{this.currentTime=e.time})),t.style.left=i,n.appendChild(t)})),r.appendChild(n),this.config.tooltips.seek||(s=I("span",{class:this.config.classNames.tooltip},""),r.appendChild(s)),this.elements.markers={points:n,tip:s},this.elements.progress.appendChild(r)}};function Re(e,t=!0){let i=e;if(t){const e=document.createElement("a");e.href=i,i=e.href}try{return new URL(i)}catch(e){return null}}function Le(e){const t=new URLSearchParams;return x.object(e)&&Object.entries(e).forEach((([e,i])=>{t.set(e,i)})),t}const Pe={setup(){if(!this.supported.ui)return;if(!this.isVideo||this.isYouTube||this.isHTML5&&!W.textTracks)return void(x.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&Ae.setCaptionsMenu.call(this));var e,t;if(x.element(this.elements.captions)||(this.elements.captions=I("div",B(this.config.selectors.captions)),this.elements.captions.setAttribute("dir","auto"),e=this.elements.captions,t=this.elements.wrapper,x.element(e)&&x.element(t)&&t.parentNode.insertBefore(e,t.nextSibling)),R.isIE&&window.URL){const e=this.media.querySelectorAll("track");Array.from(e).forEach((e=>{const t=e.getAttribute("src"),i=Re(t);null!==i&&i.hostname!==window.location.href.hostname&&["http:","https:"].includes(i.protocol)&&Ee(t,"blob").then((t=>{e.setAttribute("src",window.URL.createObjectURL(t))})).catch((()=>{F(e)}))}))}const i=ne((navigator.languages||[navigator.language||navigator.userLanguage||"en"]).map((e=>e.split("-")[0])));let r=(this.storage.get("language")||this.config.captions.language||"auto").toLowerCase();"auto"===r&&([r]=i);let n=this.storage.get("captions");if(x.boolean(n)||({active:n}=this.config.captions),Object.assign(this.captions,{toggled:!1,active:n,language:r,languages:i}),this.isHTML5){const e=this.config.captions.update?"addtrack removetrack":"removetrack";Q.call(this,this.media.textTracks,e,Pe.update.bind(this))}setTimeout(Pe.update.bind(this),0)},update(){const e=Pe.getTracks.call(this,!0),{active:t,language:i,meta:r,currentTrackNode:n}=this.captions,s=Boolean(e.find((e=>e.language===i)));this.isHTML5&&this.isVideo&&e.filter((e=>!r.get(e))).forEach((e=>{this.debug.log("Track added",e),r.set(e,{default:"showing"===e.mode}),"showing"===e.mode&&(e.mode="hidden"),Q.call(this,e,"cuechange",(()=>Pe.updateCues.call(this)))})),(s&&this.language!==i||!e.includes(n))&&(Pe.setLanguage.call(this,i),Pe.toggle.call(this,t&&s)),this.elements&&z(this.elements.container,this.config.classNames.captions.enabled,!x.empty(e)),x.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&Ae.setCaptionsMenu.call(this)},toggle(e,t=!0){if(!this.supported.ui)return;const{toggled:i}=this.captions,r=this.config.classNames.captions.active,n=x.nullOrUndefined(e)?!i:e;if(n!==i){if(t||(this.captions.active=n,this.storage.set({captions:n})),!this.language&&n&&!t){const e=Pe.getTracks.call(this),t=Pe.findTrack.call(this,[this.captions.language,...this.captions.languages],!0);return this.captions.language=t.language,void Pe.set.call(this,e.indexOf(t))}this.elements.buttons.captions&&(this.elements.buttons.captions.pressed=n),z(this.elements.container,r,n),this.captions.toggled=n,Ae.updateSetting.call(this,"captions"),ee.call(this,this.media,n?"captionsenabled":"captionsdisabled")}setTimeout((()=>{n&&this.captions.toggled&&(this.captions.currentTrackNode.mode="hidden")}))},set(e,t=!0){const i=Pe.getTracks.call(this);if(-1!==e)if(x.number(e))if(e in i){if(this.captions.currentTrack!==e){this.captions.currentTrack=e;const r=i[e],{language:n}=r||{};this.captions.currentTrackNode=r,Ae.updateSetting.call(this,"captions"),t||(this.captions.language=n,this.storage.set({language:n})),this.isVimeo&&this.embed.enableTextTrack(n),ee.call(this,this.media,"languagechange")}Pe.toggle.call(this,!0,t),this.isHTML5&&this.isVideo&&Pe.updateCues.call(this)}else this.debug.warn("Track not found",e);else this.debug.warn("Invalid caption argument",e);else Pe.toggle.call(this,!1,t)},setLanguage(e,t=!0){if(!x.string(e))return void this.debug.warn("Invalid language argument",e);const i=e.toLowerCase();this.captions.language=i;const r=Pe.getTracks.call(this),n=Pe.findTrack.call(this,[i]);Pe.set.call(this,r.indexOf(n),t)},getTracks(e=!1){return Array.from((this.media||{}).textTracks||[]).filter((t=>!this.isHTML5||e||this.captions.meta.has(t))).filter((e=>["captions","subtitles"].includes(e.kind)))},findTrack(e,t=!1){const i=Pe.getTracks.call(this),r=e=>Number((this.captions.meta.get(e)||{}).default),n=Array.from(i).sort(((e,t)=>r(t)-r(e)));let s;return e.every((e=>(s=n.find((t=>t.language===e)),!s))),s||(t?n[0]:void 0)},getCurrentTrack(){return Pe.getTracks.call(this)[this.currentTrack]},getLabel(e){let t=e;return!x.track(t)&&W.textTracks&&this.captions.toggled&&(t=Pe.getCurrentTrack.call(this)),x.track(t)?x.empty(t.label)?x.empty(t.language)?we.get("enabled",this.config):e.language.toUpperCase():t.label:we.get("disabled",this.config)},updateCues(e){if(!this.supported.ui)return;if(!x.element(this.elements.captions))return void this.debug.warn("No captions element to render to");if(!x.nullOrUndefined(e)&&!Array.isArray(e))return void this.debug.warn("updateCues: Invalid input",e);let t=e;if(!t){const e=Pe.getCurrentTrack.call(this);t=Array.from((e||{}).activeCues||[]).map((e=>e.getCueAsHTML())).map(ve)}const i=t.map((e=>e.trim())).join("\n");if(i!==this.elements.captions.innerHTML){N(this.elements.captions);const e=I("span",B(this.config.selectors.caption));e.innerHTML=i,this.elements.captions.appendChild(e),ee.call(this,this.media,"cuechange")}}},Oe={enabled:!0,title:"",debug:!1,autoplay:!1,autopause:!0,playsinline:!0,seekTime:10,volume:1,muted:!1,duration:null,displayDuration:!0,invertTime:!0,toggleInvert:!0,ratio:null,clickToPlay:!0,hideControls:!0,resetOnEnd:!1,disableContextMenu:!0,loadSprite:!0,iconPrefix:"plyr",iconUrl:"https://cdn.plyr.io/3.7.8/plyr.svg",blankVideo:"https://cdn.plyr.io/static/blank.mp4",quality:{default:576,options:[4320,2880,2160,1440,1080,720,576,480,360,240],forced:!1,onChange:null},loop:{active:!1},speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2,4]},keyboard:{focused:!0,global:!1},tooltips:{controls:!1,seek:!0},captions:{active:!1,language:"auto",update:!1},fullscreen:{enabled:!0,fallback:!0,iosNative:!1},storage:{enabled:!0,key:"plyr"},controls:["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen"],settings:["captions","quality","speed"],i18n:{restart:"Restart",rewind:"Rewind {seektime}s",play:"Play",pause:"Pause",fastForward:"Forward {seektime}s",seek:"Seek",seekLabel:"{currentTime} of {duration}",played:"Played",buffered:"Buffered",currentTime:"Current time",duration:"Duration",volume:"Volume",mute:"Mute",unmute:"Unmute",enableCaptions:"Enable captions",disableCaptions:"Disable captions",download:"Download",enterFullscreen:"Enter fullscreen",exitFullscreen:"Exit fullscreen",frameTitle:"Player for {title}",captions:"Captions",settings:"Settings",pip:"PIP",menuBack:"Go back to previous menu",speed:"Speed",normal:"Normal",quality:"Quality",loop:"Loop",start:"Start",end:"End",all:"All",reset:"Reset",disabled:"Disabled",enabled:"Enabled",advertisement:"Ad",qualityBadge:{2160:"4K",1440:"HD",1080:"HD",720:"HD",576:"SD",480:"SD"}},urls:{download:null,vimeo:{sdk:"https://player.vimeo.com/api/player.js",iframe:"https://player.vimeo.com/video/{0}?{1}",api:"https://vimeo.com/api/oembed.json?url={0}"},youtube:{sdk:"https://www.youtube.com/iframe_api",api:"https://noembed.com/embed?url=https://www.youtube.com/watch?v={0}"},googleIMA:{sdk:"https://imasdk.googleapis.com/js/sdkloader/ima3.js"}},listeners:{seek:null,play:null,pause:null,restart:null,rewind:null,fastForward:null,mute:null,volume:null,captions:null,download:null,fullscreen:null,pip:null,airplay:null,speed:null,quality:null,loop:null,language:null},events:["ended","progress","stalled","playing","waiting","canplay","canplaythrough","loadstart","loadeddata","loadedmetadata","timeupdate","volumechange","play","pause","error","seeking","seeked","emptied","ratechange","cuechange","download","enterfullscreen","exitfullscreen","captionsenabled","captionsdisabled","languagechange","controlshidden","controlsshown","ready","statechange","qualitychange","adsloaded","adscontentpause","adscontentresume","adstarted","adsmidpoint","adscomplete","adsallcomplete","adsimpression","adsclick"],selectors:{editable:"input, textarea, select, [contenteditable]",container:".plyr",controls:{container:null,wrapper:".plyr__controls"},labels:"[data-plyr]",buttons:{play:'[data-plyr="play"]',pause:'[data-plyr="pause"]',restart:'[data-plyr="restart"]',rewind:'[data-plyr="rewind"]',fastForward:'[data-plyr="fast-forward"]',mute:'[data-plyr="mute"]',captions:'[data-plyr="captions"]',download:'[data-plyr="download"]',fullscreen:'[data-plyr="fullscreen"]',pip:'[data-plyr="pip"]',airplay:'[data-plyr="airplay"]',settings:'[data-plyr="settings"]',loop:'[data-plyr="loop"]'},inputs:{seek:'[data-plyr="seek"]',volume:'[data-plyr="volume"]',speed:'[data-plyr="speed"]',language:'[data-plyr="language"]',quality:'[data-plyr="quality"]'},display:{currentTime:".plyr__time--current",duration:".plyr__time--duration",buffer:".plyr__progress__buffer",loop:".plyr__progress__loop",volume:".plyr__volume--display"},progress:".plyr__progress",captions:".plyr__captions",caption:".plyr__caption"},classNames:{type:"plyr--{0}",provider:"plyr--{0}",video:"plyr__video-wrapper",embed:"plyr__video-embed",videoFixedRatio:"plyr__video-wrapper--fixed-ratio",embedContainer:"plyr__video-embed__container",poster:"plyr__poster",posterEnabled:"plyr__poster-enabled",ads:"plyr__ads",control:"plyr__control",controlPressed:"plyr__control--pressed",playing:"plyr--playing",paused:"plyr--paused",stopped:"plyr--stopped",loading:"plyr--loading",hover:"plyr--hover",tooltip:"plyr__tooltip",cues:"plyr__cues",marker:"plyr__progress__marker",hidden:"plyr__sr-only",hideControls:"plyr--hide-controls",isTouch:"plyr--is-touch",uiSupported:"plyr--full-ui",noTransition:"plyr--no-transition",display:{time:"plyr__time"},menu:{value:"plyr__menu__value",badge:"plyr__badge",open:"plyr--menu-open"},captions:{enabled:"plyr--captions-enabled",active:"plyr--captions-active"},fullscreen:{enabled:"plyr--fullscreen-enabled",fallback:"plyr--fullscreen-fallback"},pip:{supported:"plyr--pip-supported",active:"plyr--pip-active"},airplay:{supported:"plyr--airplay-supported",active:"plyr--airplay-active"},previewThumbnails:{thumbContainer:"plyr__preview-thumb",thumbContainerShown:"plyr__preview-thumb--is-shown",imageContainer:"plyr__preview-thumb__image-container",timeContainer:"plyr__preview-thumb__time-container",scrubbingContainer:"plyr__preview-scrubbing",scrubbingContainerShown:"plyr__preview-scrubbing--is-shown"}},attributes:{embed:{provider:"data-plyr-provider",id:"data-plyr-embed-id",hash:"data-plyr-embed-hash"}},ads:{enabled:!1,publisherId:"",tagUrl:""},previewThumbnails:{enabled:!1,src:""},vimeo:{byline:!1,portrait:!1,title:!1,speed:!0,transparent:!1,customControls:!0,referrerPolicy:null,premium:!1},youtube:{rel:0,showinfo:0,iv_load_policy:3,modestbranding:1,customControls:!0,noCookie:!1},mediaMetadata:{title:"",artist:"",album:"",artwork:[]},markers:{enabled:!1,points:[]}},De="picture-in-picture",Ie="inline",Me={html5:"html5",youtube:"youtube",vimeo:"vimeo"},Fe="audio",Ne="video",je=()=>{};class Be{constructor(e=!1){this.enabled=window.console&&e,this.enabled&&this.log("Debugging enabled")}get log(){return this.enabled?Function.prototype.bind.call(console.log,console):je}get warn(){return this.enabled?Function.prototype.bind.call(console.warn,console):je}get error(){return this.enabled?Function.prototype.bind.call(console.error,console):je}}class Ue{constructor(t){e(this,"onChange",(()=>{if(!this.supported)return;const e=this.player.elements.buttons.fullscreen;x.element(e)&&(e.pressed=this.active);const t=this.target===this.player.media?this.target:this.player.elements.container;ee.call(this.player,t,this.active?"enterfullscreen":"exitfullscreen",!0)})),e(this,"toggleFallback",((e=!1)=>{if(e?this.scrollPosition={x:window.scrollX??0,y:window.scrollY??0}:window.scrollTo(this.scrollPosition.x,this.scrollPosition.y),document.body.style.overflow=e?"hidden":"",z(this.target,this.player.config.classNames.fullscreen.fallback,e),R.isIos){let t=document.head.querySelector('meta[name="viewport"]');const i="viewport-fit=cover";t||(t=document.createElement("meta"),t.setAttribute("name","viewport"));const r=x.string(t.content)&&t.content.includes(i);e?(this.cleanupViewport=!r,r||(t.content+=`,${i}`)):this.cleanupViewport&&(t.content=t.content.split(",").filter((e=>e.trim()!==i)).join(","))}this.onChange()})),e(this,"trapFocus",(e=>{if(R.isIos||R.isIPadOS||!this.active||"Tab"!==e.key)return;const t=document.activeElement,i=V.call(this.player,"a[href], button:not(:disabled), input:not(:disabled), [tabindex]"),[r]=i,n=i[i.length-1];t!==n||e.shiftKey?t===r&&e.shiftKey&&(n.focus(),e.preventDefault()):(r.focus(),e.preventDefault())})),e(this,"update",(()=>{if(this.supported){let e;e=this.forceFallback?"Fallback (forced)":Ue.nativeSupported?"Native":"Fallback",this.player.debug.log(`${e} fullscreen enabled`)}else this.player.debug.log("Fullscreen not supported and fallback disabled");z(this.player.elements.container,this.player.config.classNames.fullscreen.enabled,this.supported)})),e(this,"enter",(()=>{this.supported&&(R.isIos&&this.player.config.fullscreen.iosNative?this.player.isVimeo?this.player.embed.requestFullscreen():this.target.webkitEnterFullscreen():!Ue.nativeSupported||this.forceFallback?this.toggleFallback(!0):this.prefix?x.empty(this.prefix)||this.target[`${this.prefix}Request${this.property}`]():this.target.requestFullscreen({navigationUI:"hide"}))})),e(this,"exit",(()=>{if(this.supported)if(R.isIos&&this.player.config.fullscreen.iosNative)this.player.isVimeo?this.player.embed.exitFullscreen():this.target.webkitEnterFullscreen(),re(this.player.play());else if(!Ue.nativeSupported||this.forceFallback)this.toggleFallback(!1);else if(this.prefix){if(!x.empty(this.prefix)){const e="moz"===this.prefix?"Cancel":"Exit";document[`${this.prefix}${e}${this.property}`]()}}else(document.cancelFullScreen||document.exitFullscreen).call(document)})),e(this,"toggle",(()=>{this.active?this.exit():this.enter()})),this.player=t,this.prefix=Ue.prefix,this.property=Ue.property,this.scrollPosition={x:0,y:0},this.forceFallback="force"===t.config.fullscreen.fallback,this.player.elements.fullscreen=t.config.fullscreen.container&&function(e,t){const{prototype:i}=Element;return(i.closest||function(){let e=this;do{if(H.matches(e,t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null}).call(e,t)}(this.player.elements.container,t.config.fullscreen.container),Q.call(this.player,document,"ms"===this.prefix?"MSFullscreenChange":`${this.prefix}fullscreenchange`,(()=>{this.onChange()})),Q.call(this.player,this.player.elements.container,"dblclick",(e=>{x.element(this.player.elements.controls)&&this.player.elements.controls.contains(e.target)||this.player.listeners.proxy(e,this.toggle,"fullscreen")})),Q.call(this,this.player.elements.container,"keydown",(e=>this.trapFocus(e))),this.update()}static get nativeSupported(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}get useNative(){return Ue.nativeSupported&&!this.forceFallback}static get prefix(){if(x.function(document.exitFullscreen))return"";let e="";return["webkit","moz","ms"].some((t=>!(!x.function(document[`${t}ExitFullscreen`])&&!x.function(document[`${t}CancelFullScreen`])||(e=t,0)))),e}static get property(){return"moz"===this.prefix?"FullScreen":"Fullscreen"}get supported(){return[this.player.config.fullscreen.enabled,this.player.isVideo,Ue.nativeSupported||this.player.config.fullscreen.fallback,!this.player.isYouTube||Ue.nativeSupported||!R.isIos||this.player.config.playsinline&&!this.player.config.fullscreen.iosNative].every(Boolean)}get active(){if(!this.supported)return!1;if(!Ue.nativeSupported||this.forceFallback)return $(this.target,this.player.config.classNames.fullscreen.fallback);const e=this.prefix?this.target.getRootNode()[`${this.prefix}${this.property}Element`]:this.target.getRootNode().fullscreenElement;return e&&e.shadowRoot?e===this.target.getRootNode().host:e===this.target}get target(){return R.isIos&&this.player.config.fullscreen.iosNative?this.player.media:this.player.elements.fullscreen??this.player.elements.container}}function ze(e,t=1){return new Promise(((i,r)=>{const n=new Image,s=()=>{delete n.onload,delete n.onerror,(n.naturalWidth>=t?i:r)(n)};Object.assign(n,{onload:s,onerror:s,src:e})}))}const $e={addStyleHook(){z(this.elements.container,this.config.selectors.container.replace(".",""),!0),z(this.elements.container,this.config.classNames.uiSupported,this.supported.ui)},toggleNativeControls(e=!1){e&&this.isHTML5?this.media.setAttribute("controls",""):this.media.removeAttribute("controls")},build(){if(this.listeners.media(),!this.supported.ui)return this.debug.warn(`Basic support only for ${this.provider} ${this.type}`),void $e.toggleNativeControls.call(this,!0);x.element(this.elements.controls)||(Ae.inject.call(this),this.listeners.controls()),$e.toggleNativeControls.call(this),this.isHTML5&&Pe.setup.call(this),this.volume=null,this.muted=null,this.loop=null,this.quality=null,this.speed=null,Ae.updateVolume.call(this),Ae.timeUpdate.call(this),Ae.durationUpdate.call(this),$e.checkPlaying.call(this),z(this.elements.container,this.config.classNames.pip.supported,W.pip&&this.isHTML5&&this.isVideo),z(this.elements.container,this.config.classNames.airplay.supported,W.airplay&&this.isHTML5),z(this.elements.container,this.config.classNames.isTouch,this.touch),this.ready=!0,setTimeout((()=>{ee.call(this,this.media,"ready")}),0),$e.setTitle.call(this),this.poster&&$e.setPoster.call(this,this.poster,!1).catch((()=>{})),this.config.duration&&Ae.durationUpdate.call(this),this.config.mediaMetadata&&Ae.setMediaMetadata.call(this)},setTitle(){let e=we.get("play",this.config);if(x.string(this.config.title)&&!x.empty(this.config.title)&&(e+=`, ${this.config.title}`),Array.from(this.elements.buttons.play||[]).forEach((t=>{t.setAttribute("aria-label",e)})),this.isEmbed){const e=G.call(this,"iframe");if(!x.element(e))return;const t=x.empty(this.config.title)?"video":this.config.title,i=we.get("frameTitle",this.config);e.setAttribute("title",i.replace("{title}",t))}},togglePoster(e){z(this.elements.container,this.config.classNames.posterEnabled,e)},setPoster(e,t=!0){return t&&this.poster?Promise.reject(new Error("Poster already set")):(this.media.setAttribute("data-poster",e),this.elements.poster.removeAttribute("hidden"),ie.call(this).then((()=>ze(e))).catch((t=>{throw e===this.poster&&$e.togglePoster.call(this,!1),t})).then((()=>{if(e!==this.poster)throw new Error("setPoster cancelled by later call to setPoster")})).then((()=>(Object.assign(this.elements.poster.style,{backgroundImage:`url('${e}')`,backgroundSize:""}),$e.togglePoster.call(this,!0),e))))},checkPlaying(e){z(this.elements.container,this.config.classNames.playing,this.playing),z(this.elements.container,this.config.classNames.paused,this.paused),z(this.elements.container,this.config.classNames.stopped,this.stopped),Array.from(this.elements.buttons.play||[]).forEach((e=>{Object.assign(e,{pressed:this.playing}),e.setAttribute("aria-label",we.get(this.playing?"pause":"play",this.config))})),x.event(e)&&"timeupdate"===e.type||$e.toggleControls.call(this)},checkLoading(e){this.loading=["stalled","waiting"].includes(e.type),clearTimeout(this.timers.loading),this.timers.loading=setTimeout((()=>{z(this.elements.container,this.config.classNames.loading,this.loading),$e.toggleControls.call(this)}),this.loading?250:0)},toggleControls(e){const{controls:t}=this.elements;if(t&&this.config.hideControls){const i=this.touch&&this.lastSeekTime+2e3>Date.now();this.toggleControls(Boolean(e||this.loading||this.paused||t.pressed||t.hover||i))}},migrateStyles(){Object.values({...this.media.style}).filter((e=>!x.empty(e)&&x.string(e)&&e.startsWith("--plyr"))).forEach((e=>{this.elements.container.style.setProperty(e,this.media.style.getPropertyValue(e)),this.media.style.removeProperty(e)})),x.empty(this.media.style)&&this.media.removeAttribute("style")}};class He{constructor(t){e(this,"firstTouch",(()=>{const{player:e}=this,{elements:t}=e;e.touch=!0,z(t.container,e.config.classNames.isTouch,!0)})),e(this,"global",((e=!0)=>{const{player:t}=this;t.config.keyboard.global&&X.call(t,window,"keydown keyup",this.handleKey,e,!1),X.call(t,document.body,"click",this.toggleMenu,e),Z.call(t,document.body,"touchstart",this.firstTouch)})),e(this,"container",(()=>{const{player:e}=this,{config:t,elements:i,timers:r}=e;!t.keyboard.global&&t.keyboard.focused&&Q.call(e,i.container,"keydown keyup",this.handleKey,!1),Q.call(e,i.container,"mousemove mouseleave touchstart touchmove enterfullscreen exitfullscreen",(t=>{const{controls:n}=i;n&&"enterfullscreen"===t.type&&(n.pressed=!1,n.hover=!1);let s=0;["touchstart","touchmove","mousemove"].includes(t.type)&&($e.toggleControls.call(e,!0),s=e.touch?3e3:2e3),clearTimeout(r.controls),r.controls=setTimeout((()=>$e.toggleControls.call(e,!1)),s)}));const n=()=>{if(!e.isVimeo||e.config.vimeo.premium)return;const t=i.wrapper,{active:r}=e.fullscreen,[n,s]=ue.call(e),o=oe(`aspect-ratio: ${n} / ${s}`);if(!r)return void(o?(t.style.width=null,t.style.height=null):(t.style.maxWidth=null,t.style.margin=null));const[a,l]=[Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)],c=a/l>n/s;o?(t.style.width=c?"auto":"100%",t.style.height=c?"100%":"auto"):(t.style.maxWidth=c?l/s*n+"px":null,t.style.margin=c?"0 auto":null)},s=()=>{clearTimeout(r.resized),r.resized=setTimeout(n,50)};Q.call(e,i.container,"enterfullscreen exitfullscreen",(t=>{const{target:r}=e.fullscreen;r===i.container&&(!e.isEmbed&&x.empty(e.config.ratio)||(n(),("enterfullscreen"===t.type?Q:J).call(e,window,"resize",s)))}))})),e(this,"media",(()=>{const{player:e}=this,{elements:t}=e;if(Q.call(e,e.media,"timeupdate seeking seeked",(t=>Ae.timeUpdate.call(e,t))),Q.call(e,e.media,"durationchange loadeddata loadedmetadata",(t=>Ae.durationUpdate.call(e,t))),Q.call(e,e.media,"ended",(()=>{e.isHTML5&&e.isVideo&&e.config.resetOnEnd&&(e.restart(),e.pause())})),Q.call(e,e.media,"progress playing seeking seeked",(t=>Ae.updateProgress.call(e,t))),Q.call(e,e.media,"volumechange",(t=>Ae.updateVolume.call(e,t))),Q.call(e,e.media,"playing play pause ended emptied timeupdate",(t=>$e.checkPlaying.call(e,t))),Q.call(e,e.media,"waiting canplay seeked playing",(t=>$e.checkLoading.call(e,t))),e.supported.ui&&e.config.clickToPlay&&!e.isAudio){const i=G.call(e,`.${e.config.classNames.video}`);if(!x.element(i))return;Q.call(e,t.container,"click",(r=>{([t.container,i].includes(r.target)||i.contains(r.target))&&(e.touch&&e.config.hideControls||(e.ended?(this.proxy(r,e.restart,"restart"),this.proxy(r,(()=>{re(e.play())}),"play")):this.proxy(r,(()=>{re(e.togglePlay())}),"play")))}))}e.supported.ui&&e.config.disableContextMenu&&Q.call(e,t.wrapper,"contextmenu",(e=>{e.preventDefault()}),!1),Q.call(e,e.media,"volumechange",(()=>{e.storage.set({volume:e.volume,muted:e.muted})})),Q.call(e,e.media,"ratechange",(()=>{Ae.updateSetting.call(e,"speed"),e.storage.set({speed:e.speed})})),Q.call(e,e.media,"qualitychange",(t=>{Ae.updateSetting.call(e,"quality",null,t.detail.quality)})),Q.call(e,e.media,"ready qualitychange",(()=>{Ae.setDownloadUrl.call(e)}));const i=e.config.events.concat(["keyup","keydown"]).join(" ");Q.call(e,e.media,i,(i=>{let{detail:r={}}=i;"error"===i.type&&(r=e.media.error),ee.call(e,t.container,i.type,!0,r)}))})),e(this,"proxy",((e,t,i)=>{const{player:r}=this,n=r.config.listeners[i];let s=!0;x.function(n)&&(s=n.call(r,e)),!1!==s&&x.function(t)&&t.call(r,e)})),e(this,"bind",((e,t,i,r,n=!0)=>{const{player:s}=this,o=s.config.listeners[r],a=x.function(o);Q.call(s,e,t,(e=>this.proxy(e,i,r)),n&&!a)})),e(this,"controls",(()=>{const{player:e}=this,{elements:t}=e,i=R.isIE?"change":"input";if(t.buttons.play&&Array.from(t.buttons.play).forEach((t=>{this.bind(t,"click",(()=>{re(e.togglePlay())}),"play")})),this.bind(t.buttons.restart,"click",e.restart,"restart"),this.bind(t.buttons.rewind,"click",(()=>{e.lastSeekTime=Date.now(),e.rewind()}),"rewind"),this.bind(t.buttons.fastForward,"click",(()=>{e.lastSeekTime=Date.now(),e.forward()}),"fastForward"),this.bind(t.buttons.mute,"click",(()=>{e.muted=!e.muted}),"mute"),this.bind(t.buttons.captions,"click",(()=>e.toggleCaptions())),this.bind(t.buttons.download,"click",(()=>{ee.call(e,e.media,"download")}),"download"),this.bind(t.buttons.fullscreen,"click",(()=>{e.fullscreen.toggle()}),"fullscreen"),this.bind(t.buttons.pip,"click",(()=>{e.pip="toggle"}),"pip"),this.bind(t.buttons.airplay,"click",e.airplay,"airplay"),this.bind(t.buttons.settings,"click",(t=>{t.stopPropagation(),t.preventDefault(),Ae.toggleMenu.call(e,t)}),null,!1),this.bind(t.buttons.settings,"keyup",(t=>{[" ","Enter"].includes(t.key)&&("Enter"!==t.key?(t.preventDefault(),t.stopPropagation(),Ae.toggleMenu.call(e,t)):Ae.focusFirstMenuItem.call(e,null,!0))}),null,!1),this.bind(t.settings.menu,"keydown",(t=>{"Escape"===t.key&&Ae.toggleMenu.call(e,t)})),this.bind(t.inputs.seek,"mousedown mousemove",(e=>{const i=t.progress.getBoundingClientRect(),r=100/i.width*(e.pageX-i.left);e.currentTarget.setAttribute("seek-value",r)})),this.bind(t.inputs.seek,"mousedown mouseup keydown keyup touchstart touchend",(t=>{const i=t.currentTarget,r="play-on-seeked";if(x.keyboardEvent(t)&&!["ArrowLeft","ArrowRight"].includes(t.key))return;e.lastSeekTime=Date.now();const n=i.hasAttribute(r),s=["mouseup","touchend","keyup"].includes(t.type);n&&s?(i.removeAttribute(r),re(e.play())):!s&&e.playing&&(i.setAttribute(r,""),e.pause())})),R.isIos){const t=V.call(e,'input[type="range"]');Array.from(t).forEach((e=>this.bind(e,i,(e=>A(e.target)))))}this.bind(t.inputs.seek,i,(t=>{const i=t.currentTarget;let r=i.getAttribute("seek-value");x.empty(r)&&(r=i.value),i.removeAttribute("seek-value"),e.currentTime=r/i.max*e.duration}),"seek"),this.bind(t.progress,"mouseenter mouseleave mousemove",(t=>Ae.updateSeekTooltip.call(e,t))),this.bind(t.progress,"mousemove touchmove",(t=>{const{previewThumbnails:i}=e;i&&i.loaded&&i.startMove(t)})),this.bind(t.progress,"mouseleave touchend click",(()=>{const{previewThumbnails:t}=e;t&&t.loaded&&t.endMove(!1,!0)})),this.bind(t.progress,"mousedown touchstart",(t=>{const{previewThumbnails:i}=e;i&&i.loaded&&i.startScrubbing(t)})),this.bind(t.progress,"mouseup touchend",(t=>{const{previewThumbnails:i}=e;i&&i.loaded&&i.endScrubbing(t)})),R.isWebKit&&Array.from(V.call(e,'input[type="range"]')).forEach((t=>{this.bind(t,"input",(t=>Ae.updateRangeFill.call(e,t.target)))})),e.config.toggleInvert&&!x.element(t.display.duration)&&this.bind(t.display.currentTime,"click",(()=>{0!==e.currentTime&&(e.config.invertTime=!e.config.invertTime,Ae.timeUpdate.call(e))})),this.bind(t.inputs.volume,i,(t=>{e.volume=t.target.value}),"volume"),this.bind(t.controls,"mouseenter mouseleave",(i=>{t.controls.hover=!e.touch&&"mouseenter"===i.type})),t.fullscreen&&Array.from(t.fullscreen.children).filter((e=>!e.contains(t.container))).forEach((i=>{this.bind(i,"mouseenter mouseleave",(i=>{t.controls&&(t.controls.hover=!e.touch&&"mouseenter"===i.type)}))})),this.bind(t.controls,"mousedown mouseup touchstart touchend touchcancel",(e=>{t.controls.pressed=["mousedown","touchstart"].includes(e.type)})),this.bind(t.controls,"focusin",(()=>{const{config:i,timers:r}=e;z(t.controls,i.classNames.noTransition,!0),$e.toggleControls.call(e,!0),setTimeout((()=>{z(t.controls,i.classNames.noTransition,!1)}),0);const n=this.touch?3e3:4e3;clearTimeout(r.controls),r.controls=setTimeout((()=>$e.toggleControls.call(e,!1)),n)})),this.bind(t.inputs.volume,"wheel",(t=>{const i=t.webkitDirectionInvertedFromDevice,[r,n]=[t.deltaX,-t.deltaY].map((e=>i?-e:e)),s=Math.sign(Math.abs(r)>Math.abs(n)?r:n);e.increaseVolume(s/50);const{volume:o}=e.media;(1===s&&o<1||-1===s&&o>0)&&t.preventDefault()}),"volume",!1)})),this.player=t,this.lastKey=null,this.focusTimer=null,this.lastKeyDown=null,this.handleKey=this.handleKey.bind(this),this.toggleMenu=this.toggleMenu.bind(this),this.firstTouch=this.firstTouch.bind(this)}handleKey(e){const{player:t}=this,{elements:i}=t,{key:r,type:n,altKey:s,ctrlKey:o,metaKey:a,shiftKey:l}=e,c="keydown"===n,u=c&&r===this.lastKey;var d;if(!(s||o||a||l)&&r)if(c){const n=document.activeElement;if(x.element(n)){const{editable:r}=t.config.selectors,{seek:s}=i.inputs;if(n!==s&&H(n,r))return;if(" "===e.key&&H(n,'button, [role^="menuitem"]'))return}switch([" ","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","0","1","2","3","4","5","6","7","8","9","c","f","k","l","m"].includes(r)&&(e.preventDefault(),e.stopPropagation()),r){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":u||(d=parseInt(r,10),t.currentTime=t.duration/10*d);break;case" ":case"k":u||re(t.togglePlay());break;case"ArrowUp":t.increaseVolume(.1);break;case"ArrowDown":t.decreaseVolume(.1);break;case"m":u||(t.muted=!t.muted);break;case"ArrowRight":t.forward();break;case"ArrowLeft":t.rewind();break;case"f":t.fullscreen.toggle();break;case"c":u||t.toggleCaptions();break;case"l":t.loop=!t.loop}"Escape"===r&&!t.fullscreen.usingNative&&t.fullscreen.active&&t.fullscreen.toggle(),this.lastKey=r}else this.lastKey=null}toggleMenu(e){Ae.toggleMenu.call(this.player,e)}}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==i.g?i.g:"undefined"!=typeof self&&self;var Ve=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){e.exports=function(){var e=function(){},t={},i={},r={};function n(e,t){e=e.push?e:[e];var n,s,o,a=[],l=e.length,c=l;for(n=function(e,i){i.length&&a.push(e),--c||t(a)};l--;)s=e[l],(o=i[s])?n(s,o):(r[s]=r[s]||[]).push(n)}function s(e,t){if(e){var n=r[e];if(i[e]=t,n)for(;n.length;)n[0](e,t),n.splice(0,1)}}function o(t,i){t.call&&(t={success:t}),i.length?(t.error||e)(i):(t.success||e)(t)}function a(t,i,r,n){var s,o,l=document,c=r.async,u=(r.numRetries||0)+1,d=r.before||e,h=t.replace(/[\?|#].*$/,""),p=t.replace(/^(css|img)!/,"");n=n||0,/(^css!|\.css$)/.test(h)?((o=l.createElement("link")).rel="stylesheet",o.href=p,(s="hideFocus"in o)&&o.relList&&(s=0,o.rel="preload",o.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(h)?(o=l.createElement("img")).src=p:((o=l.createElement("script")).src=t,o.async=void 0===c||c),o.onload=o.onerror=o.onbeforeload=function(e){var l=e.type[0];if(s)try{o.sheet.cssText.length||(l="e")}catch(e){18!=e.code&&(l="e")}if("e"==l){if((n+=1)<u)return a(t,i,r,n)}else if("preload"==o.rel&&"style"==o.as)return o.rel="stylesheet";i(t,l,e.defaultPrevented)},!1!==d(t,o)&&l.head.appendChild(o)}function l(e,t,i){var r,n,s=(e=e.push?e:[e]).length,o=s,l=[];for(r=function(e,i,r){if("e"==i&&l.push(e),"b"==i){if(!r)return;l.push(e)}--s||t(l)},n=0;n<o;n++)a(e[n],r,i)}function c(e,i,r){var n,a;if(i&&i.trim&&(n=i),a=(n?r:i)||{},n){if(n in t)throw"LoadJS";t[n]=!0}function c(t,i){l(e,(function(e){o(a,e),t&&o({success:t,error:i},e),s(n,e)}),a)}if(a.returnPromise)return new Promise(c);c()}return c.ready=function(e,t){return n(e,(function(e){o(t,e)})),c},c.done=function(e){s(e,[])},c.reset=function(){t={},i={},r={}},c.isDefined=function(e){return e in t},c}()}));function Ge(e){return new Promise(((t,i)=>{Ve(e,{success:t,error:i})}))}function Ke(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,ee.call(this,this.media,e?"play":"pause"))}const qe={setup(){const e=this;z(e.elements.wrapper,e.config.classNames.embed,!0),e.options.speed=e.config.speed.options,de.call(e),x.object(window.Vimeo)?qe.ready.call(e):Ge(e.config.urls.vimeo.sdk).then((()=>{qe.ready.call(e)})).catch((t=>{e.debug.warn("Vimeo SDK (player.js) failed to load",t)}))},ready(){const e=this,t=e.config.vimeo,{premium:i,referrerPolicy:r,...n}=t;let s=e.media.getAttribute("src"),o="";x.empty(s)?(s=e.media.getAttribute(e.config.attributes.embed.id),o=e.media.getAttribute(e.config.attributes.embed.hash)):o=function(e){const t=e.match(/^.*(vimeo.com\/|video\/)(\d+)(\?.*&*h=|\/)+([\d,a-f]+)/);return t&&5===t.length?t[4]:null}(s);const a=o?{h:o}:{};i&&Object.assign(n,{controls:!1,sidedock:!1});const l=Le({loop:e.config.loop.active,autoplay:e.autoplay,muted:e.muted,gesture:"media",playsinline:e.config.playsinline,...a,...n}),c=(u=s,x.empty(u)?null:x.number(Number(u))?u:u.match(/^.*(vimeo.com\/|video\/)(\d+).*/)?RegExp.$2:u);var u;const d=I("iframe"),h=fe(e.config.urls.vimeo.iframe,c,l);if(d.setAttribute("src",h),d.setAttribute("allowfullscreen",""),d.setAttribute("allow",["autoplay","fullscreen","picture-in-picture","encrypted-media","accelerometer","gyroscope"].join("; ")),x.empty(r)||d.setAttribute("referrerPolicy",r),i||!t.customControls)d.setAttribute("data-poster",e.poster),e.media=j(d,e.media);else{const t=I("div",{class:e.config.classNames.embedContainer,"data-poster":e.poster});t.appendChild(d),e.media=j(t,e.media)}t.customControls||Ee(fe(e.config.urls.vimeo.api,h)).then((t=>{!x.empty(t)&&t.thumbnail_url&&$e.setPoster.call(e,t.thumbnail_url).catch((()=>{}))})),e.embed=new window.Vimeo.Player(d,{autopause:e.config.autopause,muted:e.muted}),e.media.paused=!0,e.media.currentTime=0,e.supported.ui&&e.embed.disableTextTrack(),e.media.play=()=>(Ke.call(e,!0),e.embed.play()),e.media.pause=()=>(Ke.call(e,!1),e.embed.pause()),e.media.stop=()=>{e.pause(),e.currentTime=0};let{currentTime:p}=e.media;Object.defineProperty(e.media,"currentTime",{get:()=>p,set(t){const{embed:i,media:r,paused:n,volume:s}=e,o=n&&!i.hasPlayed;r.seeking=!0,ee.call(e,r,"seeking"),Promise.resolve(o&&i.setVolume(0)).then((()=>i.setCurrentTime(t))).then((()=>o&&i.pause())).then((()=>o&&i.setVolume(s))).catch((()=>{}))}});let f=e.config.speed.selected;Object.defineProperty(e.media,"playbackRate",{get:()=>f,set(t){e.embed.setPlaybackRate(t).then((()=>{f=t,ee.call(e,e.media,"ratechange")})).catch((()=>{e.options.speed=[1]}))}});let{volume:m}=e.config;Object.defineProperty(e.media,"volume",{get:()=>m,set(t){e.embed.setVolume(t).then((()=>{m=t,ee.call(e,e.media,"volumechange")}))}});let{muted:g}=e.config;Object.defineProperty(e.media,"muted",{get:()=>g,set(t){const i=!!x.boolean(t)&&t;e.embed.setMuted(!!i||e.config.muted).then((()=>{g=i,ee.call(e,e.media,"volumechange")}))}});let y,{loop:v}=e.config;Object.defineProperty(e.media,"loop",{get:()=>v,set(t){const i=x.boolean(t)?t:e.config.loop.active;e.embed.setLoop(i).then((()=>{v=i}))}}),e.embed.getVideoUrl().then((t=>{y=t,Ae.setDownloadUrl.call(e)})).catch((e=>{this.debug.warn(e)})),Object.defineProperty(e.media,"currentSrc",{get:()=>y}),Object.defineProperty(e.media,"ended",{get:()=>e.currentTime===e.duration}),Promise.all([e.embed.getVideoWidth(),e.embed.getVideoHeight()]).then((t=>{const[i,r]=t;e.embed.ratio=he(i,r),de.call(this)})),e.embed.setAutopause(e.config.autopause).then((t=>{e.config.autopause=t})),e.embed.getVideoTitle().then((t=>{e.config.title=t,$e.setTitle.call(this)})),e.embed.getCurrentTime().then((t=>{p=t,ee.call(e,e.media,"timeupdate")})),e.embed.getDuration().then((t=>{e.media.duration=t,ee.call(e,e.media,"durationchange")})),e.embed.getTextTracks().then((t=>{e.media.textTracks=t,Pe.setup.call(e)})),e.embed.on("cuechange",(({cues:t=[]})=>{const i=t.map((e=>function(e){const t=document.createDocumentFragment(),i=document.createElement("div");return t.appendChild(i),i.innerHTML=e,t.firstChild.innerText}(e.text)));Pe.updateCues.call(e,i)})),e.embed.on("loaded",(()=>{e.embed.getPaused().then((t=>{Ke.call(e,!t),t||ee.call(e,e.media,"playing")})),x.element(e.embed.element)&&e.supported.ui&&e.embed.element.setAttribute("tabindex",-1)})),e.embed.on("bufferstart",(()=>{ee.call(e,e.media,"waiting")})),e.embed.on("bufferend",(()=>{ee.call(e,e.media,"playing")})),e.embed.on("play",(()=>{Ke.call(e,!0),ee.call(e,e.media,"playing")})),e.embed.on("pause",(()=>{Ke.call(e,!1)})),e.embed.on("timeupdate",(t=>{e.media.seeking=!1,p=t.seconds,ee.call(e,e.media,"timeupdate")})),e.embed.on("progress",(t=>{e.media.buffered=t.percent,ee.call(e,e.media,"progress"),1===parseInt(t.percent,10)&&ee.call(e,e.media,"canplaythrough"),e.embed.getDuration().then((t=>{t!==e.media.duration&&(e.media.duration=t,ee.call(e,e.media,"durationchange"))}))})),e.embed.on("seeked",(()=>{e.media.seeking=!1,ee.call(e,e.media,"seeked")})),e.embed.on("ended",(()=>{e.media.paused=!0,ee.call(e,e.media,"ended")})),e.embed.on("error",(t=>{e.media.error=t,ee.call(e,e.media,"error")})),t.customControls&&setTimeout((()=>$e.build.call(e)),0)}};function We(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,ee.call(this,this.media,e?"play":"pause"))}function Ye(e){return e.noCookie?"https://www.youtube-nocookie.com":"http:"===window.location.protocol?"http://www.youtube.com":void 0}const Xe={setup(){if(z(this.elements.wrapper,this.config.classNames.embed,!0),x.object(window.YT)&&x.function(window.YT.Player))Xe.ready.call(this);else{const e=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=()=>{x.function(e)&&e(),Xe.ready.call(this)},Ge(this.config.urls.youtube.sdk).catch((e=>{this.debug.warn("YouTube API failed to load",e)}))}},getTitle(e){Ee(fe(this.config.urls.youtube.api,e)).then((e=>{if(x.object(e)){const{title:t,height:i,width:r}=e;this.config.title=t,$e.setTitle.call(this),this.embed.ratio=he(r,i)}de.call(this)})).catch((()=>{de.call(this)}))},ready(){const e=this,t=e.config.youtube,i=e.media&&e.media.getAttribute("id");if(!x.empty(i)&&i.startsWith("youtube-"))return;let r=e.media.getAttribute("src");x.empty(r)&&(r=e.media.getAttribute(this.config.attributes.embed.id));const n=(s=r,x.empty(s)?null:s.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/)?RegExp.$2:s);var s;const o=I("div",{id:`${e.provider}-${Math.floor(1e4*Math.random())}`,"data-poster":t.customControls?e.poster:void 0});if(e.media=j(o,e.media),t.customControls){const t=e=>`https://i.ytimg.com/vi/${n}/${e}default.jpg`;ze(t("maxres"),121).catch((()=>ze(t("sd"),121))).catch((()=>ze(t("hq")))).then((t=>$e.setPoster.call(e,t.src))).then((t=>{t.includes("maxres")||(e.elements.poster.style.backgroundSize="cover")})).catch((()=>{}))}e.embed=new window.YT.Player(e.media,{videoId:n,host:Ye(t),playerVars:P({},{autoplay:e.config.autoplay?1:0,hl:e.config.hl,controls:e.supported.ui&&t.customControls?0:1,disablekb:1,playsinline:e.config.playsinline&&!e.config.fullscreen.iosNative?1:0,cc_load_policy:e.captions.active?1:0,cc_lang_pref:e.config.captions.language,widget_referrer:window?window.location.href:null},t),events:{onError(t){if(!e.media.error){const i=t.data,r={2:"The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.",5:"The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.",100:"The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.",101:"The owner of the requested video does not allow it to be played in embedded players.",150:"The owner of the requested video does not allow it to be played in embedded players."}[i]||"An unknown error occurred";e.media.error={code:i,message:r},ee.call(e,e.media,"error")}},onPlaybackRateChange(t){const i=t.target;e.media.playbackRate=i.getPlaybackRate(),ee.call(e,e.media,"ratechange")},onReady(i){if(x.function(e.media.play))return;const r=i.target;Xe.getTitle.call(e,n),e.media.play=()=>{We.call(e,!0),r.playVideo()},e.media.pause=()=>{We.call(e,!1),r.pauseVideo()},e.media.stop=()=>{r.stopVideo()},e.media.duration=r.getDuration(),e.media.paused=!0,e.media.currentTime=0,Object.defineProperty(e.media,"currentTime",{get:()=>Number(r.getCurrentTime()),set(t){e.paused&&!e.embed.hasPlayed&&e.embed.mute(),e.media.seeking=!0,ee.call(e,e.media,"seeking"),r.seekTo(t)}}),Object.defineProperty(e.media,"playbackRate",{get:()=>r.getPlaybackRate(),set(e){r.setPlaybackRate(e)}});let{volume:s}=e.config;Object.defineProperty(e.media,"volume",{get:()=>s,set(t){s=t,r.setVolume(100*s),ee.call(e,e.media,"volumechange")}});let{muted:o}=e.config;Object.defineProperty(e.media,"muted",{get:()=>o,set(t){const i=x.boolean(t)?t:o;o=i,r[i?"mute":"unMute"](),r.setVolume(100*s),ee.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"currentSrc",{get:()=>r.getVideoUrl()}),Object.defineProperty(e.media,"ended",{get:()=>e.currentTime===e.duration});const a=r.getAvailablePlaybackRates();e.options.speed=a.filter((t=>e.config.speed.options.includes(t))),e.supported.ui&&t.customControls&&e.media.setAttribute("tabindex",-1),ee.call(e,e.media,"timeupdate"),ee.call(e,e.media,"durationchange"),clearInterval(e.timers.buffering),e.timers.buffering=setInterval((()=>{e.media.buffered=r.getVideoLoadedFraction(),(null===e.media.lastBuffered||e.media.lastBuffered<e.media.buffered)&&ee.call(e,e.media,"progress"),e.media.lastBuffered=e.media.buffered,1===e.media.buffered&&(clearInterval(e.timers.buffering),ee.call(e,e.media,"canplaythrough"))}),200),t.customControls&&setTimeout((()=>$e.build.call(e)),50)},onStateChange(i){const r=i.target;switch(clearInterval(e.timers.playing),e.media.seeking&&[1,2].includes(i.data)&&(e.media.seeking=!1,ee.call(e,e.media,"seeked")),i.data){case-1:ee.call(e,e.media,"timeupdate"),e.media.buffered=r.getVideoLoadedFraction(),ee.call(e,e.media,"progress");break;case 0:We.call(e,!1),e.media.loop?(r.stopVideo(),r.playVideo()):ee.call(e,e.media,"ended");break;case 1:t.customControls&&!e.config.autoplay&&e.media.paused&&!e.embed.hasPlayed?e.media.pause():(We.call(e,!0),ee.call(e,e.media,"playing"),e.timers.playing=setInterval((()=>{ee.call(e,e.media,"timeupdate")}),50),e.media.duration!==r.getDuration()&&(e.media.duration=r.getDuration(),ee.call(e,e.media,"durationchange")));break;case 2:e.muted||e.embed.unMute(),We.call(e,!1);break;case 3:ee.call(e,e.media,"waiting")}ee.call(e,e.elements.container,"statechange",!1,{code:i.data})}}})}},Qe={setup(){this.media?(z(this.elements.container,this.config.classNames.type.replace("{0}",this.type),!0),z(this.elements.container,this.config.classNames.provider.replace("{0}",this.provider),!0),this.isEmbed&&z(this.elements.container,this.config.classNames.type.replace("{0}","video"),!0),this.isVideo&&(this.elements.wrapper=I("div",{class:this.config.classNames.video}),O(this.media,this.elements.wrapper),this.elements.poster=I("div",{class:this.config.classNames.poster}),this.elements.wrapper.appendChild(this.elements.poster)),this.isHTML5?pe.setup.call(this):this.isYouTube?Xe.setup.call(this):this.isVimeo&&qe.setup.call(this)):this.debug.warn("No media element found!")}};class Je{constructor(t){e(this,"load",(()=>{this.enabled&&(x.object(window.google)&&x.object(window.google.ima)?this.ready():Ge(this.player.config.urls.googleIMA.sdk).then((()=>{this.ready()})).catch((()=>{this.trigger("error",new Error("Google IMA SDK failed to load"))})))})),e(this,"ready",(()=>{var e;this.enabled||((e=this).manager&&e.manager.destroy(),e.elements.displayContainer&&e.elements.displayContainer.destroy(),e.elements.container.remove()),this.startSafetyTimer(12e3,"ready()"),this.managerPromise.then((()=>{this.clearSafetyTimer("onAdsManagerLoaded()")})),this.listeners(),this.setupIMA()})),e(this,"setupIMA",(()=>{this.elements.container=I("div",{class:this.player.config.classNames.ads}),this.player.elements.container.appendChild(this.elements.container),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setLocale(this.player.config.ads.language),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(this.player.config.playsinline),this.elements.displayContainer=new google.ima.AdDisplayContainer(this.elements.container,this.player.media),this.loader=new google.ima.AdsLoader(this.elements.displayContainer),this.loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(e=>this.onAdsManagerLoaded(e)),!1),this.loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(e=>this.onAdError(e)),!1),this.requestAds()})),e(this,"requestAds",(()=>{const{container:e}=this.player.elements;try{const t=new google.ima.AdsRequest;t.adTagUrl=this.tagUrl,t.linearAdSlotWidth=e.offsetWidth,t.linearAdSlotHeight=e.offsetHeight,t.nonLinearAdSlotWidth=e.offsetWidth,t.nonLinearAdSlotHeight=e.offsetHeight,t.forceNonLinearFullSlot=!1,t.setAdWillPlayMuted(!this.player.muted),this.loader.requestAds(t)}catch(e){this.onAdError(e)}})),e(this,"pollCountdown",((e=!1)=>{if(!e)return clearInterval(this.countdownTimer),void this.elements.container.removeAttribute("data-badge-text");this.countdownTimer=setInterval((()=>{const e=Ce(Math.max(this.manager.getRemainingTime(),0)),t=`${we.get("advertisement",this.player.config)} - ${e}`;this.elements.container.setAttribute("data-badge-text",t)}),100)})),e(this,"onAdsManagerLoaded",(e=>{if(!this.enabled)return;const t=new google.ima.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=!0,t.enablePreloading=!0,this.manager=e.getAdsManager(this.player,t),this.cuePoints=this.manager.getCuePoints(),this.manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(e=>this.onAdError(e))),Object.keys(google.ima.AdEvent.Type).forEach((e=>{this.manager.addEventListener(google.ima.AdEvent.Type[e],(e=>this.onAdEvent(e)))})),this.trigger("loaded")})),e(this,"addCuePoints",(()=>{x.empty(this.cuePoints)||this.cuePoints.forEach((e=>{if(0!==e&&-1!==e&&e<this.player.duration){const t=this.player.elements.progress;if(x.element(t)){const i=100/this.player.duration*e,r=I("span",{class:this.player.config.classNames.cues});r.style.left=`${i.toString()}%`,t.appendChild(r)}}}))})),e(this,"onAdEvent",(e=>{const{container:t}=this.player.elements,i=e.getAd(),r=e.getAdData();switch((e=>{ee.call(this.player,this.player.media,`ads${e.replace(/_/g,"").toLowerCase()}`)})(e.type),e.type){case google.ima.AdEvent.Type.LOADED:this.trigger("loaded"),this.pollCountdown(!0),i.isLinear()||(i.width=t.offsetWidth,i.height=t.offsetHeight);break;case google.ima.AdEvent.Type.STARTED:this.manager.setVolume(this.player.volume);break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:this.player.ended?this.loadAds():this.loader.contentComplete();break;case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:this.pauseContent();break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:this.pollCountdown(),this.resumeContent();break;case google.ima.AdEvent.Type.LOG:r.adError&&this.player.debug.warn(`Non-fatal ad error: ${r.adError.getMessage()}`)}})),e(this,"onAdError",(e=>{this.cancel(),this.player.debug.warn("Ads error",e)})),e(this,"listeners",(()=>{const{container:e}=this.player.elements;let t;this.player.on("canplay",(()=>{this.addCuePoints()})),this.player.on("ended",(()=>{this.loader.contentComplete()})),this.player.on("timeupdate",(()=>{t=this.player.currentTime})),this.player.on("seeked",(()=>{const e=this.player.currentTime;x.empty(this.cuePoints)||this.cuePoints.forEach(((i,r)=>{t<i&&i<e&&(this.manager.discardAdBreak(),this.cuePoints.splice(r,1))}))})),window.addEventListener("resize",(()=>{this.manager&&this.manager.resize(e.offsetWidth,e.offsetHeight,google.ima.ViewMode.NORMAL)}))})),e(this,"play",(()=>{const{container:e}=this.player.elements;this.managerPromise||this.resumeContent(),this.managerPromise.then((()=>{this.manager.setVolume(this.player.volume),this.elements.displayContainer.initialize();try{this.initialized||(this.manager.init(e.offsetWidth,e.offsetHeight,google.ima.ViewMode.NORMAL),this.manager.start()),this.initialized=!0}catch(e){this.onAdError(e)}})).catch((()=>{}))})),e(this,"resumeContent",(()=>{this.elements.container.style.zIndex="",this.playing=!1,re(this.player.media.play())})),e(this,"pauseContent",(()=>{this.elements.container.style.zIndex=3,this.playing=!0,this.player.media.pause()})),e(this,"cancel",(()=>{this.initialized&&this.resumeContent(),this.trigger("error"),this.loadAds()})),e(this,"loadAds",(()=>{this.managerPromise.then((()=>{this.manager&&this.manager.destroy(),this.managerPromise=new Promise((e=>{this.on("loaded",e),this.player.debug.log(this.manager)})),this.initialized=!1,this.requestAds()})).catch((()=>{}))})),e(this,"trigger",((e,...t)=>{const i=this.events[e];x.array(i)&&i.forEach((e=>{x.function(e)&&e.apply(this,t)}))})),e(this,"on",((e,t)=>(x.array(this.events[e])||(this.events[e]=[]),this.events[e].push(t),this))),e(this,"startSafetyTimer",((e,t)=>{this.player.debug.log(`Safety timer invoked from: ${t}`),this.safetyTimer=setTimeout((()=>{this.cancel(),this.clearSafetyTimer("startSafetyTimer()")}),e)})),e(this,"clearSafetyTimer",(e=>{x.nullOrUndefined(this.safetyTimer)||(this.player.debug.log(`Safety timer cleared from: ${e}`),clearTimeout(this.safetyTimer),this.safetyTimer=null)})),this.player=t,this.config=t.config.ads,this.playing=!1,this.initialized=!1,this.elements={container:null,displayContainer:null},this.manager=null,this.loader=null,this.cuePoints=null,this.events={},this.safetyTimer=null,this.countdownTimer=null,this.managerPromise=new Promise(((e,t)=>{this.on("loaded",e),this.on("error",t)})),this.load()}get enabled(){const{config:e}=this;return this.player.isHTML5&&this.player.isVideo&&e.enabled&&(!x.empty(e.publisherId)||x.url(e.tagUrl))}get tagUrl(){const{config:e}=this;return x.url(e.tagUrl)?e.tagUrl:`https://go.aniview.com/api/adserver6/vast/?${Le({AV_PUBLISHERID:"58c25bb0073ef448b1087ad6",AV_CHANNELID:"5a0458dc28a06145e4519d21",AV_URL:window.location.hostname,cb:Date.now(),AV_WIDTH:640,AV_HEIGHT:480,AV_CDIM2:e.publisherId})}`}}function Ze(e=0,t=0,i=255){return Math.min(Math.max(e,t),i)}const et=e=>{const t=[];return e.split(/\r\n\r\n|\n\n|\r\r/).forEach((e=>{const i={};e.split(/\r\n|\n|\r/).forEach((e=>{if(x.number(i.startTime)){if(!x.empty(e.trim())&&x.empty(i.text)){const t=e.trim().split("#xywh=");[i.text]=t,t[1]&&([i.x,i.y,i.w,i.h]=t[1].split(","))}}else{const t=e.match(/([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})( ?--> ?)([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})/);t&&(i.startTime=60*Number(t[1]||0)*60+60*Number(t[2])+Number(t[3])+Number(`0.${t[4]}`),i.endTime=60*Number(t[6]||0)*60+60*Number(t[7])+Number(t[8])+Number(`0.${t[9]}`))}})),i.text&&t.push(i)})),t},tt=(e,t)=>{const i={};return e>t.width/t.height?(i.width=t.width,i.height=1/e*t.width):(i.height=t.height,i.width=e*t.height),i};class it{constructor(t){e(this,"load",(()=>{this.player.elements.display.seekTooltip&&(this.player.elements.display.seekTooltip.hidden=this.enabled),this.enabled&&this.getThumbnails().then((()=>{this.enabled&&(this.render(),this.determineContainerAutoSizing(),this.listeners(),this.loaded=!0)}))})),e(this,"getThumbnails",(()=>new Promise((e=>{const{src:t}=this.player.config.previewThumbnails;if(x.empty(t))throw new Error("Missing previewThumbnails.src config attribute");const i=()=>{this.thumbnails.sort(((e,t)=>e.height-t.height)),this.player.debug.log("Preview thumbnails",this.thumbnails),e()};if(x.function(t))t((e=>{this.thumbnails=e,i()}));else{const e=(x.string(t)?[t]:t).map((e=>this.getThumbnail(e)));Promise.all(e).then(i)}})))),e(this,"getThumbnail",(e=>new Promise((t=>{Ee(e).then((i=>{const r={frames:et(i),height:null,urlPrefix:""};r.frames[0].text.startsWith("/")||r.frames[0].text.startsWith("http://")||r.frames[0].text.startsWith("https://")||(r.urlPrefix=e.substring(0,e.lastIndexOf("/")+1));const n=new Image;n.onload=()=>{r.height=n.naturalHeight,r.width=n.naturalWidth,this.thumbnails.push(r),t()},n.src=r.urlPrefix+r.frames[0].text}))})))),e(this,"startMove",(e=>{if(this.loaded&&x.event(e)&&["touchmove","mousemove"].includes(e.type)&&this.player.media.duration){if("touchmove"===e.type)this.seekTime=this.player.media.duration*(this.player.elements.inputs.seek.value/100);else{var t,i;const r=this.player.elements.progress.getBoundingClientRect(),n=100/r.width*(e.pageX-r.left);this.seekTime=this.player.media.duration*(n/100),this.seekTime<0&&(this.seekTime=0),this.seekTime>this.player.media.duration-1&&(this.seekTime=this.player.media.duration-1),this.mousePosX=e.pageX,this.elements.thumb.time.innerText=Ce(this.seekTime);const s=null===(t=this.player.config.markers)||void 0===t||null===(i=t.points)||void 0===i?void 0:i.find((({time:e})=>e===Math.round(this.seekTime)));s&&this.elements.thumb.time.insertAdjacentHTML("afterbegin",`${s.label}<br>`)}this.showImageAtCurrentTime()}})),e(this,"endMove",(()=>{this.toggleThumbContainer(!1,!0)})),e(this,"startScrubbing",(e=>{(x.nullOrUndefined(e.button)||!1===e.button||0===e.button)&&(this.mouseDown=!0,this.player.media.duration&&(this.toggleScrubbingContainer(!0),this.toggleThumbContainer(!1,!0),this.showImageAtCurrentTime()))})),e(this,"endScrubbing",(()=>{this.mouseDown=!1,Math.ceil(this.lastTime)===Math.ceil(this.player.media.currentTime)?this.toggleScrubbingContainer(!1):Z.call(this.player,this.player.media,"timeupdate",(()=>{this.mouseDown||this.toggleScrubbingContainer(!1)}))})),e(this,"listeners",(()=>{this.player.on("play",(()=>{this.toggleThumbContainer(!1,!0)})),this.player.on("seeked",(()=>{this.toggleThumbContainer(!1)})),this.player.on("timeupdate",(()=>{this.lastTime=this.player.media.currentTime}))})),e(this,"render",(()=>{this.elements.thumb.container=I("div",{class:this.player.config.classNames.previewThumbnails.thumbContainer}),this.elements.thumb.imageContainer=I("div",{class:this.player.config.classNames.previewThumbnails.imageContainer}),this.elements.thumb.container.appendChild(this.elements.thumb.imageContainer);const e=I("div",{class:this.player.config.classNames.previewThumbnails.timeContainer});this.elements.thumb.time=I("span",{},"00:00"),e.appendChild(this.elements.thumb.time),this.elements.thumb.imageContainer.appendChild(e),x.element(this.player.elements.progress)&&this.player.elements.progress.appendChild(this.elements.thumb.container),this.elements.scrubbing.container=I("div",{class:this.player.config.classNames.previewThumbnails.scrubbingContainer}),this.player.elements.wrapper.appendChild(this.elements.scrubbing.container)})),e(this,"destroy",(()=>{this.elements.thumb.container&&this.elements.thumb.container.remove(),this.elements.scrubbing.container&&this.elements.scrubbing.container.remove()})),e(this,"showImageAtCurrentTime",(()=>{this.mouseDown?this.setScrubbingContainerSize():this.setThumbContainerSizeAndPos();const e=this.thumbnails[0].frames.findIndex((e=>this.seekTime>=e.startTime&&this.seekTime<=e.endTime)),t=e>=0;let i=0;this.mouseDown||this.toggleThumbContainer(t),t&&(this.thumbnails.forEach(((t,r)=>{this.loadedImages.includes(t.frames[e].text)&&(i=r)})),e!==this.showingThumb&&(this.showingThumb=e,this.loadImage(i)))})),e(this,"loadImage",((e=0)=>{const t=this.showingThumb,i=this.thumbnails[e],{urlPrefix:r}=i,n=i.frames[t],s=i.frames[t].text,o=r+s;if(this.currentImageElement&&this.currentImageElement.dataset.filename===s)this.showImage(this.currentImageElement,n,e,t,s,!1),this.currentImageElement.dataset.index=t,this.removeOldImages(this.currentImageElement);else{this.loadingImage&&this.usingSprites&&(this.loadingImage.onload=null);const i=new Image;i.src=o,i.dataset.index=t,i.dataset.filename=s,this.showingThumbFilename=s,this.player.debug.log(`Loading image: ${o}`),i.onload=()=>this.showImage(i,n,e,t,s,!0),this.loadingImage=i,this.removeOldImages(i)}})),e(this,"showImage",((e,t,i,r,n,s=!0)=>{this.player.debug.log(`Showing thumb: ${n}. num: ${r}. qual: ${i}. newimg: ${s}`),this.setImageSizeAndOffset(e,t),s&&(this.currentImageContainer.appendChild(e),this.currentImageElement=e,this.loadedImages.includes(n)||this.loadedImages.push(n)),this.preloadNearby(r,!0).then(this.preloadNearby(r,!1)).then(this.getHigherQuality(i,e,t,n))})),e(this,"removeOldImages",(e=>{Array.from(this.currentImageContainer.children).forEach((t=>{if("img"!==t.tagName.toLowerCase())return;const i=this.usingSprites?500:1e3;if(t.dataset.index!==e.dataset.index&&!t.dataset.deleting){t.dataset.deleting=!0;const{currentImageContainer:e}=this;setTimeout((()=>{e.removeChild(t),this.player.debug.log(`Removing thumb: ${t.dataset.filename}`)}),i)}}))})),e(this,"preloadNearby",((e,t=!0)=>new Promise((i=>{setTimeout((()=>{const r=this.thumbnails[0].frames[e].text;if(this.showingThumbFilename===r){let n;n=t?this.thumbnails[0].frames.slice(e):this.thumbnails[0].frames.slice(0,e).reverse();let s=!1;n.forEach((e=>{const t=e.text;if(t!==r&&!this.loadedImages.includes(t)){s=!0,this.player.debug.log(`Preloading thumb filename: ${t}`);const{urlPrefix:e}=this.thumbnails[0],r=e+t,n=new Image;n.src=r,n.onload=()=>{this.player.debug.log(`Preloaded thumb filename: ${t}`),this.loadedImages.includes(t)||this.loadedImages.push(t),i()}}})),s||i()}}),300)})))),e(this,"getHigherQuality",((e,t,i,r)=>{if(e<this.thumbnails.length-1){let n=t.naturalHeight;this.usingSprites&&(n=i.h),n<this.thumbContainerHeight&&setTimeout((()=>{this.showingThumbFilename===r&&(this.player.debug.log(`Showing higher quality thumb for: ${r}`),this.loadImage(e+1))}),300)}})),e(this,"toggleThumbContainer",((e=!1,t=!1)=>{const i=this.player.config.classNames.previewThumbnails.thumbContainerShown;this.elements.thumb.container.classList.toggle(i,e),!e&&t&&(this.showingThumb=null,this.showingThumbFilename=null)})),e(this,"toggleScrubbingContainer",((e=!1)=>{const t=this.player.config.classNames.previewThumbnails.scrubbingContainerShown;this.elements.scrubbing.container.classList.toggle(t,e),e||(this.showingThumb=null,this.showingThumbFilename=null)})),e(this,"determineContainerAutoSizing",(()=>{(this.elements.thumb.imageContainer.clientHeight>20||this.elements.thumb.imageContainer.clientWidth>20)&&(this.sizeSpecifiedInCSS=!0)})),e(this,"setThumbContainerSizeAndPos",(()=>{const{imageContainer:e}=this.elements.thumb;if(this.sizeSpecifiedInCSS){if(e.clientHeight>20&&e.clientWidth<20){const t=Math.floor(e.clientHeight*this.thumbAspectRatio);e.style.width=`${t}px`}else if(e.clientHeight<20&&e.clientWidth>20){const t=Math.floor(e.clientWidth/this.thumbAspectRatio);e.style.height=`${t}px`}}else{const t=Math.floor(this.thumbContainerHeight*this.thumbAspectRatio);e.style.height=`${this.thumbContainerHeight}px`,e.style.width=`${t}px`}this.setThumbContainerPos()})),e(this,"setThumbContainerPos",(()=>{const e=this.player.elements.progress.getBoundingClientRect(),t=this.player.elements.container.getBoundingClientRect(),{container:i}=this.elements.thumb,r=t.left-e.left+10,n=t.right-e.left-i.clientWidth-10,s=this.mousePosX-e.left-i.clientWidth/2,o=Ze(s,r,n);i.style.left=`${o}px`,i.style.setProperty("--preview-arrow-offset",s-o+"px")})),e(this,"setScrubbingContainerSize",(()=>{const{width:e,height:t}=tt(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});this.elements.scrubbing.container.style.width=`${e}px`,this.elements.scrubbing.container.style.height=`${t}px`})),e(this,"setImageSizeAndOffset",((e,t)=>{if(!this.usingSprites)return;const i=this.thumbContainerHeight/t.h;e.style.height=e.naturalHeight*i+"px",e.style.width=e.naturalWidth*i+"px",e.style.left=`-${t.x*i}px`,e.style.top=`-${t.y*i}px`})),this.player=t,this.thumbnails=[],this.loaded=!1,this.lastMouseMoveTime=Date.now(),this.mouseDown=!1,this.loadedImages=[],this.elements={thumb:{},scrubbing:{}},this.load()}get enabled(){return this.player.isHTML5&&this.player.isVideo&&this.player.config.previewThumbnails.enabled}get currentImageContainer(){return this.mouseDown?this.elements.scrubbing.container:this.elements.thumb.imageContainer}get usingSprites(){return Object.keys(this.thumbnails[0].frames[0]).includes("w")}get thumbAspectRatio(){return this.usingSprites?this.thumbnails[0].frames[0].w/this.thumbnails[0].frames[0].h:this.thumbnails[0].width/this.thumbnails[0].height}get thumbContainerHeight(){if(this.mouseDown){const{height:e}=tt(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});return e}return this.sizeSpecifiedInCSS?this.elements.thumb.imageContainer.clientHeight:Math.floor(this.player.media.clientWidth/this.thumbAspectRatio/4)}get currentImageElement(){return this.mouseDown?this.currentScrubbingImageElement:this.currentThumbnailImageElement}set currentImageElement(e){this.mouseDown?this.currentScrubbingImageElement=e:this.currentThumbnailImageElement=e}}const rt={insertElements(e,t){x.string(t)?M(e,this.media,{src:t}):x.array(t)&&t.forEach((t=>{M(e,this.media,t)}))},change(e){L(e,"sources.length")?(pe.cancelRequests.call(this),this.destroy.call(this,(()=>{this.options.quality=[],F(this.media),this.media=null,x.element(this.elements.container)&&this.elements.container.removeAttribute("class");const{sources:t,type:i}=e,[{provider:r=Me.html5,src:n}]=t,s="html5"===r?i:"div",o="html5"===r?{}:{src:n};Object.assign(this,{provider:r,type:i,supported:W.check(i,r,this.config.playsinline),media:I(s,o)}),this.elements.container.appendChild(this.media),x.boolean(e.autoplay)&&(this.config.autoplay=e.autoplay),this.isHTML5&&(this.config.crossorigin&&this.media.setAttribute("crossorigin",""),this.config.autoplay&&this.media.setAttribute("autoplay",""),x.empty(e.poster)||(this.poster=e.poster),this.config.loop.active&&this.media.setAttribute("loop",""),this.config.muted&&this.media.setAttribute("muted",""),this.config.playsinline&&this.media.setAttribute("playsinline","")),$e.addStyleHook.call(this),this.isHTML5&&rt.insertElements.call(this,"source",t),this.config.title=e.title,Qe.setup.call(this),this.isHTML5&&Object.keys(e).includes("tracks")&&rt.insertElements.call(this,"track",e.tracks),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&$e.build.call(this),this.isHTML5&&this.media.load(),x.empty(e.previewThumbnails)||(Object.assign(this.config.previewThumbnails,e.previewThumbnails),this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new it(this))),this.fullscreen.update()}),!0)):this.debug.warn("Invalid source format")}};class nt{constructor(t,i){if(e(this,"play",(()=>x.function(this.media.play)?(this.ads&&this.ads.enabled&&this.ads.managerPromise.then((()=>this.ads.play())).catch((()=>re(this.media.play()))),this.media.play()):null)),e(this,"pause",(()=>this.playing&&x.function(this.media.pause)?this.media.pause():null)),e(this,"togglePlay",(e=>(x.boolean(e)?e:!this.playing)?this.play():this.pause())),e(this,"stop",(()=>{this.isHTML5?(this.pause(),this.restart()):x.function(this.media.stop)&&this.media.stop()})),e(this,"restart",(()=>{this.currentTime=0})),e(this,"rewind",(e=>{this.currentTime-=x.number(e)?e:this.config.seekTime})),e(this,"forward",(e=>{this.currentTime+=x.number(e)?e:this.config.seekTime})),e(this,"increaseVolume",(e=>{const t=this.media.muted?0:this.volume;this.volume=t+(x.number(e)?e:0)})),e(this,"decreaseVolume",(e=>{this.increaseVolume(-e)})),e(this,"airplay",(()=>{W.airplay&&this.media.webkitShowPlaybackTargetPicker()})),e(this,"toggleControls",(e=>{if(this.supported.ui&&!this.isAudio){const t=$(this.elements.container,this.config.classNames.hideControls),i=void 0===e?void 0:!e,r=z(this.elements.container,this.config.classNames.hideControls,i);if(r&&x.array(this.config.controls)&&this.config.controls.includes("settings")&&!x.empty(this.config.settings)&&Ae.toggleMenu.call(this,!1),r!==t){const e=r?"controlshidden":"controlsshown";ee.call(this,this.media,e)}return!r}return!1})),e(this,"on",((e,t)=>{Q.call(this,this.elements.container,e,t)})),e(this,"once",((e,t)=>{Z.call(this,this.elements.container,e,t)})),e(this,"off",((e,t)=>{J(this.elements.container,e,t)})),e(this,"destroy",((e,t=!1)=>{if(!this.ready)return;const i=()=>{document.body.style.overflow="",this.embed=null,t?(Object.keys(this.elements).length&&(F(this.elements.buttons.play),F(this.elements.captions),F(this.elements.controls),F(this.elements.wrapper),this.elements.buttons.play=null,this.elements.captions=null,this.elements.controls=null,this.elements.wrapper=null),x.function(e)&&e()):(te.call(this),pe.cancelRequests.call(this),j(this.elements.original,this.elements.container),ee.call(this,this.elements.original,"destroyed",!0),x.function(e)&&e.call(this.elements.original),this.ready=!1,setTimeout((()=>{this.elements=null,this.media=null}),200))};this.stop(),clearTimeout(this.timers.loading),clearTimeout(this.timers.controls),clearTimeout(this.timers.resized),this.isHTML5?($e.toggleNativeControls.call(this,!0),i()):this.isYouTube?(clearInterval(this.timers.buffering),clearInterval(this.timers.playing),null!==this.embed&&x.function(this.embed.destroy)&&this.embed.destroy(),i()):this.isVimeo&&(null!==this.embed&&this.embed.unload().then(i),setTimeout(i,200))})),e(this,"supports",(e=>W.mime.call(this,e))),this.timers={},this.ready=!1,this.loading=!1,this.failed=!1,this.touch=W.touch,this.media=t,x.string(this.media)&&(this.media=document.querySelectorAll(this.media)),(window.jQuery&&this.media instanceof jQuery||x.nodeList(this.media)||x.array(this.media))&&(this.media=this.media[0]),this.config=P({},Oe,nt.defaults,i||{},(()=>{try{return JSON.parse(this.media.getAttribute("data-plyr-config"))}catch(e){return{}}})()),this.elements={container:null,fullscreen:null,captions:null,buttons:{},display:{},progress:{},inputs:{},settings:{popup:null,menu:null,panels:{},buttons:{}}},this.captions={active:null,currentTrack:-1,meta:new WeakMap},this.fullscreen={active:!1},this.options={speed:[],quality:[]},this.debug=new Be(this.config.debug),this.debug.log("Config",this.config),this.debug.log("Support",W),x.nullOrUndefined(this.media)||!x.element(this.media))return void this.debug.error("Setup failed: no suitable element passed");if(this.media.plyr)return void this.debug.warn("Target already setup");if(!this.config.enabled)return void this.debug.error("Setup failed: disabled by config");if(!W.check().api)return void this.debug.error("Setup failed: no support");const r=this.media.cloneNode(!0);r.autoplay=!1,this.elements.original=r;const n=this.media.tagName.toLowerCase();let s=null,o=null;switch(n){case"div":if(s=this.media.querySelector("iframe"),x.element(s)){if(o=Re(s.getAttribute("src")),this.provider=function(e){return/^(https?:\/\/)?(www\.)?(youtube\.com|youtube-nocookie\.com|youtu\.?be)\/.+$/.test(e)?Me.youtube:/^https?:\/\/player.vimeo.com\/video\/\d{0,9}(?=\b|\/)/.test(e)?Me.vimeo:null}(o.toString()),this.elements.container=this.media,this.media=s,this.elements.container.className="",o.search.length){const e=["1","true"];e.includes(o.searchParams.get("autoplay"))&&(this.config.autoplay=!0),e.includes(o.searchParams.get("loop"))&&(this.config.loop.active=!0),this.isYouTube?(this.config.playsinline=e.includes(o.searchParams.get("playsinline")),this.config.youtube.hl=o.searchParams.get("hl")):this.config.playsinline=!0}}else this.provider=this.media.getAttribute(this.config.attributes.embed.provider),this.media.removeAttribute(this.config.attributes.embed.provider);if(x.empty(this.provider)||!Object.values(Me).includes(this.provider))return void this.debug.error("Setup failed: Invalid provider");this.type=Ne;break;case"video":case"audio":this.type=n,this.provider=Me.html5,this.media.hasAttribute("crossorigin")&&(this.config.crossorigin=!0),this.media.hasAttribute("autoplay")&&(this.config.autoplay=!0),(this.media.hasAttribute("playsinline")||this.media.hasAttribute("webkit-playsinline"))&&(this.config.playsinline=!0),this.media.hasAttribute("muted")&&(this.config.muted=!0),this.media.hasAttribute("loop")&&(this.config.loop.active=!0);break;default:return void this.debug.error("Setup failed: unsupported type")}this.supported=W.check(this.type,this.provider),this.supported.api?(this.eventListeners=[],this.listeners=new He(this),this.storage=new _e(this),this.media.plyr=this,x.element(this.elements.container)||(this.elements.container=I("div"),O(this.media,this.elements.container)),$e.migrateStyles.call(this),$e.addStyleHook.call(this),Qe.setup.call(this),this.config.debug&&Q.call(this,this.elements.container,this.config.events.join(" "),(e=>{this.debug.log(`event: ${e.type}`)})),this.fullscreen=new Ue(this),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&$e.build.call(this),this.listeners.container(),this.listeners.global(),this.config.ads.enabled&&(this.ads=new Je(this)),this.isHTML5&&this.config.autoplay&&this.once("canplay",(()=>re(this.play()))),this.lastSeekTime=0,this.config.previewThumbnails.enabled&&(this.previewThumbnails=new it(this))):this.debug.error("Setup failed: no support")}get isHTML5(){return this.provider===Me.html5}get isEmbed(){return this.isYouTube||this.isVimeo}get isYouTube(){return this.provider===Me.youtube}get isVimeo(){return this.provider===Me.vimeo}get isVideo(){return this.type===Ne}get isAudio(){return this.type===Fe}get playing(){return Boolean(this.ready&&!this.paused&&!this.ended)}get paused(){return Boolean(this.media.paused)}get stopped(){return Boolean(this.paused&&0===this.currentTime)}get ended(){return Boolean(this.media.ended)}set currentTime(e){if(!this.duration)return;const t=x.number(e)&&e>0;this.media.currentTime=t?Math.min(e,this.duration):0,this.debug.log(`Seeking to ${this.currentTime} seconds`)}get currentTime(){return Number(this.media.currentTime)}get buffered(){const{buffered:e}=this.media;return x.number(e)?e:e&&e.length&&this.duration>0?e.end(0)/this.duration:0}get seeking(){return Boolean(this.media.seeking)}get duration(){const e=parseFloat(this.config.duration),t=(this.media||{}).duration,i=x.number(t)&&t!==1/0?t:0;return e||i}set volume(e){let t=e;x.string(t)&&(t=Number(t)),x.number(t)||(t=this.storage.get("volume")),x.number(t)||({volume:t}=this.config),t>1&&(t=1),t<0&&(t=0),this.config.volume=t,this.media.volume=t,!x.empty(e)&&this.muted&&t>0&&(this.muted=!1)}get volume(){return Number(this.media.volume)}set muted(e){let t=e;x.boolean(t)||(t=this.storage.get("muted")),x.boolean(t)||(t=this.config.muted),this.config.muted=t,this.media.muted=t}get muted(){return Boolean(this.media.muted)}get hasAudio(){return!this.isHTML5||!!this.isAudio||Boolean(this.media.mozHasAudio)||Boolean(this.media.webkitAudioDecodedByteCount)||Boolean(this.media.audioTracks&&this.media.audioTracks.length)}set speed(e){let t=null;x.number(e)&&(t=e),x.number(t)||(t=this.storage.get("speed")),x.number(t)||(t=this.config.speed.selected);const{minimumSpeed:i,maximumSpeed:r}=this;t=Ze(t,i,r),this.config.speed.selected=t,setTimeout((()=>{this.media&&(this.media.playbackRate=t)}),0)}get speed(){return Number(this.media.playbackRate)}get minimumSpeed(){return this.isYouTube?Math.min(...this.options.speed):this.isVimeo?.5:.0625}get maximumSpeed(){return this.isYouTube?Math.max(...this.options.speed):this.isVimeo?2:16}set quality(e){const t=this.config.quality,i=this.options.quality;if(!i.length)return;let r=[!x.empty(e)&&Number(e),this.storage.get("quality"),t.selected,t.default].find(x.number),n=!0;if(!i.includes(r)){const e=se(i,r);this.debug.warn(`Unsupported quality option: ${r}, using ${e} instead`),r=e,n=!1}t.selected=r,this.media.quality=r,n&&this.storage.set({quality:r})}get quality(){return this.media.quality}set loop(e){const t=x.boolean(e)?e:this.config.loop.active;this.config.loop.active=t,this.media.loop=t}get loop(){return Boolean(this.media.loop)}set source(e){rt.change.call(this,e)}get source(){return this.media.currentSrc}get download(){const{download:e}=this.config.urls;return x.url(e)?e:this.source}set download(e){x.url(e)&&(this.config.urls.download=e,Ae.setDownloadUrl.call(this))}set poster(e){this.isVideo?$e.setPoster.call(this,e,!1).catch((()=>{})):this.debug.warn("Poster can only be set for video")}get poster(){return this.isVideo?this.media.getAttribute("poster")||this.media.getAttribute("data-poster"):null}get ratio(){if(!this.isVideo)return null;const e=ce(ue.call(this));return x.array(e)?e.join(":"):e}set ratio(e){this.isVideo?x.string(e)&&le(e)?(this.config.ratio=ce(e),de.call(this)):this.debug.error(`Invalid aspect ratio specified (${e})`):this.debug.warn("Aspect ratio can only be set for video")}set autoplay(e){this.config.autoplay=x.boolean(e)?e:this.config.autoplay}get autoplay(){return Boolean(this.config.autoplay)}toggleCaptions(e){Pe.toggle.call(this,e,!1)}set currentTrack(e){Pe.set.call(this,e,!1),Pe.setup.call(this)}get currentTrack(){const{toggled:e,currentTrack:t}=this.captions;return e?t:-1}set language(e){Pe.setLanguage.call(this,e,!1)}get language(){return(Pe.getCurrentTrack.call(this)||{}).language}set pip(e){if(!W.pip)return;const t=x.boolean(e)?e:!this.pip;x.function(this.media.webkitSetPresentationMode)&&this.media.webkitSetPresentationMode(t?De:Ie),x.function(this.media.requestPictureInPicture)&&(!this.pip&&t?this.media.requestPictureInPicture():this.pip&&!t&&document.exitPictureInPicture())}get pip(){return W.pip?x.empty(this.media.webkitPresentationMode)?this.media===document.pictureInPictureElement:this.media.webkitPresentationMode===De:null}setPreviewThumbnails(e){this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),Object.assign(this.config.previewThumbnails,e),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new it(this))}static supported(e,t){return W.check(e,t)}static loadSprite(e,t){return Te(e,t)}static setup(e,t={}){let i=null;return x.string(e)?i=Array.from(document.querySelectorAll(e)):x.nodeList(e)?i=Array.from(e):x.array(e)&&(i=e.filter(x.element)),x.empty(i)?null:i.map((e=>new nt(e,t)))}}var st;return nt.defaults=(st=Oe,JSON.parse(JSON.stringify(st))),nt}())},819:(e,t,i)=>{"use strict";i.d(t,{f:()=>ae});var r=i(545);function n(e){return e.split("-")[0]}function s(e){return e.split("-")[1]}function o(e){return["top","bottom"].includes(n(e))?"x":"y"}function a(e){return"y"===e?"height":"width"}function l(e,t,i){let{reference:r,floating:l}=e;const c=r.x+r.width/2-l.width/2,u=r.y+r.height/2-l.height/2,d=o(t),h=a(d),p=r[h]/2-l[h]/2,f="x"===d;let m;switch(n(t)){case"top":m={x:c,y:r.y-l.height};break;case"bottom":m={x:c,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:u};break;case"left":m={x:r.x-l.width,y:u};break;default:m={x:r.x,y:r.y}}switch(s(t)){case"start":m[d]-=p*(i&&f?-1:1);break;case"end":m[d]+=p*(i&&f?-1:1)}return m}function c(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function u(e,t){var i;void 0===t&&(t={});const{x:r,y:n,platform:s,rects:o,elements:a,strategy:l}=e,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:p=!1,padding:f=0}=t,m=function(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}(f),g=a[p?"floating"===h?"reference":"floating":h],y=c(await s.getClippingRect({element:null==(i=await(null==s.isElement?void 0:s.isElement(g)))||i?g:g.contextElement||await(null==s.getDocumentElement?void 0:s.getDocumentElement(a.floating)),boundary:u,rootBoundary:d,strategy:l})),v=c(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:"floating"===h?{...o.floating,x:r,y:n}:o.reference,offsetParent:await(null==s.getOffsetParent?void 0:s.getOffsetParent(a.floating)),strategy:l}):o[h]);return{top:y.top-v.top+m.top,bottom:v.bottom-y.bottom+m.bottom,left:y.left-v.left+m.left,right:v.right-y.right+m.right}}const d=Math.min,h=Math.max;function p(e,t,i){return h(e,d(t,i))}const f={left:"right",right:"left",bottom:"top",top:"bottom"};function m(e){return e.replace(/left|right|bottom|top/g,(e=>f[e]))}function g(e,t,i){void 0===i&&(i=!1);const r=s(e),n=o(e),l=a(n);let c="x"===n?r===(i?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[l]>t.floating[l]&&(c=m(c)),{main:c,cross:m(c)}}const y={start:"end",end:"start"};function v(e){return e.replace(/start|end/g,(e=>y[e]))}const b=["top","right","bottom","left"].reduce(((e,t)=>e.concat(t,t+"-start",t+"-end")),[]);const w=function(e){return void 0===e&&(e={}),{name:"autoPlacement",options:e,async fn(t){var i,r,o,a,l;const{x:c,y:d,rects:h,middlewareData:p,placement:f,platform:m,elements:y}=t,{alignment:w=null,allowedPlacements:_=b,autoAlignment:E=!0,...T}=e,S=function(e,t,i){return(e?[...i.filter((t=>s(t)===e)),...i.filter((t=>s(t)!==e))]:i.filter((e=>n(e)===e))).filter((i=>!e||s(i)===e||!!t&&v(i)!==i))}(w,E,_),k=await u(t,T),x=null!=(i=null==(r=p.autoPlacement)?void 0:r.index)?i:0,C=S[x];if(null==C)return{};const{main:A,cross:R}=g(C,h,await(null==m.isRTL?void 0:m.isRTL(y.floating)));if(f!==C)return{x:c,y:d,reset:{placement:S[0]}};const L=[k[n(C)],k[A],k[R]],P=[...null!=(o=null==(a=p.autoPlacement)?void 0:a.overflows)?o:[],{placement:C,overflows:L}],O=S[x+1];if(O)return{data:{index:x+1,overflows:P},reset:{placement:O}};const D=P.slice().sort(((e,t)=>e.overflows[0]-t.overflows[0])),I=null==(l=D.find((e=>{let{overflows:t}=e;return t.every((e=>e<=0))})))?void 0:l.placement,M=null!=I?I:D[0].placement;return M!==f?{data:{index:x+1,overflows:P},reset:{placement:M}}:{}}}};const _=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var i;const{placement:r,middlewareData:s,rects:o,initialPlacement:a,platform:l,elements:c}=t,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:p,fallbackStrategy:f="bestFit",flipAlignment:y=!0,...b}=e,w=n(r),_=p||(w!==a&&y?function(e){const t=m(e);return[v(e),t,v(t)]}(a):[m(a)]),E=[a,..._],T=await u(t,b),S=[];let k=(null==(i=s.flip)?void 0:i.overflows)||[];if(d&&S.push(T[w]),h){const{main:e,cross:t}=g(r,o,await(null==l.isRTL?void 0:l.isRTL(c.floating)));S.push(T[e],T[t])}if(k=[...k,{placement:r,overflows:S}],!S.every((e=>e<=0))){var x,C;const e=(null!=(x=null==(C=s.flip)?void 0:C.index)?x:0)+1,t=E[e];if(t)return{data:{index:e,overflows:k},reset:{placement:t}};let i="bottom";switch(f){case"bestFit":{var A;const e=null==(A=k.map((e=>[e,e.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)])).sort(((e,t)=>e[1]-t[1]))[0])?void 0:A[0].placement;e&&(i=e);break}case"initialPlacement":i=a}if(r!==i)return{reset:{placement:i}}}return{}}}};const E=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){const{x:i,y:r}=t,a=await async function(e,t){const{placement:i,platform:r,elements:a}=e,l=await(null==r.isRTL?void 0:r.isRTL(a.floating)),c=n(i),u=s(i),d="x"===o(i),h=["left","top"].includes(c)?-1:1,p=l&&d?-1:1,f="function"==typeof t?t(e):t;let{mainAxis:m,crossAxis:g,alignmentAxis:y}="number"==typeof f?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...f};return u&&"number"==typeof y&&(g="end"===u?-1*y:y),d?{x:g*p,y:m*h}:{x:m*h,y:g*p}}(t,e);return{x:i+a.x,y:r+a.y,data:a}}}};const T=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:i,y:r,placement:s}=t,{mainAxis:a=!0,crossAxis:l=!1,limiter:c={fn:e=>{let{x:t,y:i}=e;return{x:t,y:i}}},...d}=e,h={x:i,y:r},f=await u(t,d),m=o(n(s)),g=function(e){return"x"===e?"y":"x"}(m);let y=h[m],v=h[g];if(a){const e="y"===m?"bottom":"right";y=p(y+f["y"===m?"top":"left"],y,y-f[e])}if(l){const e="y"===g?"bottom":"right";v=p(v+f["y"===g?"top":"left"],v,v-f[e])}const b=c.fn({...t,[m]:y,[g]:v});return{...b,data:{x:b.x-i,y:b.y-r}}}}};function S(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function k(e){if(null==e)return window;if(!S(e)){const t=e.ownerDocument;return t&&t.defaultView||window}return e}function x(e){return k(e).getComputedStyle(e)}function C(e){return S(e)?"":e?(e.nodeName||"").toLowerCase():""}function A(){const e=navigator.userAgentData;return null!=e&&e.brands?e.brands.map((e=>e.brand+"/"+e.version)).join(" "):navigator.userAgent}function R(e){return e instanceof k(e).HTMLElement}function L(e){return e instanceof k(e).Element}function P(e){if(typeof ShadowRoot>"u")return!1;return e instanceof k(e).ShadowRoot||e instanceof ShadowRoot}function O(e){const{overflow:t,overflowX:i,overflowY:r}=x(e);return/auto|scroll|overlay|hidden/.test(t+r+i)}function D(e){return["table","td","th"].includes(C(e))}function I(e){const t=/firefox/i.test(A()),i=x(e);return"none"!==i.transform||"none"!==i.perspective||"paint"===i.contain||["transform","perspective"].includes(i.willChange)||t&&"filter"===i.willChange||t&&!!i.filter&&"none"!==i.filter}function M(){return!/^((?!chrome|android).)*safari/i.test(A())}const F=Math.min,N=Math.max,j=Math.round;function B(e,t,i){var r,n,s,o;void 0===t&&(t=!1),void 0===i&&(i=!1);const a=e.getBoundingClientRect();let l=1,c=1;t&&R(e)&&(l=e.offsetWidth>0&&j(a.width)/e.offsetWidth||1,c=e.offsetHeight>0&&j(a.height)/e.offsetHeight||1);const u=L(e)?k(e):window,d=!M()&&i,h=(a.left+(d&&null!=(r=null==(n=u.visualViewport)?void 0:n.offsetLeft)?r:0))/l,p=(a.top+(d&&null!=(s=null==(o=u.visualViewport)?void 0:o.offsetTop)?s:0))/c,f=a.width/l,m=a.height/c;return{width:f,height:m,top:p,right:h+f,bottom:p+m,left:h,x:h,y:p}}function U(e){return((function(e){return e instanceof k(e).Node}(e)?e.ownerDocument:e.document)||window.document).documentElement}function z(e){return L(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function $(e){return B(U(e)).left+z(e).scrollLeft}function H(e,t,i){const r=R(t),n=U(t),s=B(e,r&&function(e){const t=B(e);return j(t.width)!==e.offsetWidth||j(t.height)!==e.offsetHeight}(t),"fixed"===i);let o={scrollLeft:0,scrollTop:0};const a={x:0,y:0};if(r||!r&&"fixed"!==i)if(("body"!==C(t)||O(n))&&(o=z(t)),R(t)){const e=B(t,!0);a.x=e.x+t.clientLeft,a.y=e.y+t.clientTop}else n&&(a.x=$(n));return{x:s.left+o.scrollLeft-a.x,y:s.top+o.scrollTop-a.y,width:s.width,height:s.height}}function V(e){return"html"===C(e)?e:e.assignedSlot||e.parentNode||(P(e)?e.host:null)||U(e)}function G(e){return R(e)&&"fixed"!==x(e).position?function(e){let{offsetParent:t}=e,i=e,r=!1;for(;i&&i!==t;){const{assignedSlot:e}=i;if(e){let n=e.offsetParent;if("contents"===x(e).display){const t=e.hasAttribute("style"),r=e.style.display;e.style.display=x(i).display,n=e.offsetParent,e.style.display=r,t||e.removeAttribute("style")}i=e,t!==n&&(t=n,r=!0)}else if(P(i)&&i.host&&r)break;i=P(i)&&i.host||i.parentNode}return t}(e):null}function K(e){const t=k(e);let i=G(e);for(;i&&D(i)&&"static"===x(i).position;)i=G(i);return i&&("html"===C(i)||"body"===C(i)&&"static"===x(i).position&&!I(i))?t:i||function(e){let t=V(e);for(P(t)&&(t=t.host);R(t)&&!["html","body"].includes(C(t));){if(I(t))return t;{const e=t.parentNode;t=P(e)?e.host:e}}return null}(e)||t}function q(e){if(R(e))return{width:e.offsetWidth,height:e.offsetHeight};const t=B(e);return{width:t.width,height:t.height}}function W(e){const t=V(e);return["html","body","#document"].includes(C(t))?e.ownerDocument.body:R(t)&&O(t)?t:W(t)}function Y(e,t){var i;void 0===t&&(t=[]);const r=W(e),n=r===(null==(i=e.ownerDocument)?void 0:i.body),s=k(r),o=n?[s].concat(s.visualViewport||[],O(r)?r:[]):r,a=t.concat(o);return n?a:a.concat(Y(o))}function X(e,t,i){return"viewport"===t?c(function(e,t){const i=k(e),r=U(e),n=i.visualViewport;let s=r.clientWidth,o=r.clientHeight,a=0,l=0;if(n){s=n.width,o=n.height;const e=M();(e||!e&&"fixed"===t)&&(a=n.offsetLeft,l=n.offsetTop)}return{width:s,height:o,x:a,y:l}}(e,i)):L(t)?function(e,t){const i=B(e,!1,"fixed"===t),r=i.top+e.clientTop,n=i.left+e.clientLeft;return{top:r,left:n,x:n,y:r,right:n+e.clientWidth,bottom:r+e.clientHeight,width:e.clientWidth,height:e.clientHeight}}(t,i):c(function(e){var t;const i=U(e),r=z(e),n=null==(t=e.ownerDocument)?void 0:t.body,s=N(i.scrollWidth,i.clientWidth,n?n.scrollWidth:0,n?n.clientWidth:0),o=N(i.scrollHeight,i.clientHeight,n?n.scrollHeight:0,n?n.clientHeight:0);let a=-r.scrollLeft+$(e);const l=-r.scrollTop;return"rtl"===x(n||i).direction&&(a+=N(i.clientWidth,n?n.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}(U(e)))}function Q(e){const t=Y(e),i=["absolute","fixed"].includes(x(e).position)&&R(e)?K(e):e;return L(i)?t.filter((e=>L(e)&&function(e,t){const i=null==t.getRootNode?void 0:t.getRootNode();if(e.contains(t))return!0;if(i&&P(i)){let i=t;do{if(i&&e===i)return!0;i=i.parentNode||i.host}while(i)}return!1}(e,i)&&"body"!==C(e))):[]}const J={getClippingRect:function(e){let{element:t,boundary:i,rootBoundary:r,strategy:n}=e;const s=[..."clippingAncestors"===i?Q(t):[].concat(i),r],o=s[0],a=s.reduce(((e,i)=>{const r=X(t,i,n);return e.top=N(r.top,e.top),e.right=F(r.right,e.right),e.bottom=F(r.bottom,e.bottom),e.left=N(r.left,e.left),e}),X(t,o,n));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:i,strategy:r}=e;const n=R(i),s=U(i);if(i===s)return t;let o={scrollLeft:0,scrollTop:0};const a={x:0,y:0};if((n||!n&&"fixed"!==r)&&(("body"!==C(i)||O(s))&&(o=z(i)),R(i))){const e=B(i,!0);a.x=e.x+i.clientLeft,a.y=e.y+i.clientTop}return{...t,x:t.x-o.scrollLeft+a.x,y:t.y-o.scrollTop+a.y}},isElement:L,getDimensions:q,getOffsetParent:K,getDocumentElement:U,getElementRects:e=>{let{reference:t,floating:i,strategy:r}=e;return{reference:H(t,K(i),r),floating:{...q(i),x:0,y:0}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>"rtl"===x(e).direction};const Z=(e,t,i)=>(async(e,t,i)=>{const{placement:r="bottom",strategy:n="absolute",middleware:s=[],platform:o}=i,a=await(null==o.isRTL?void 0:o.isRTL(t));let c=await o.getElementRects({reference:e,floating:t,strategy:n}),{x:u,y:d}=l(c,r,a),h=r,p={},f=0;for(let i=0;i<s.length;i++){const{name:m,fn:g}=s[i],{x:y,y:v,data:b,reset:w}=await g({x:u,y:d,initialPlacement:r,placement:h,strategy:n,middlewareData:p,rects:c,platform:o,elements:{reference:e,floating:t}});u=null!=y?y:u,d=null!=v?v:d,p={...p,[m]:{...p[m],...b}},w&&f<=50&&(f++,"object"==typeof w&&(w.placement&&(h=w.placement),w.rects&&(c=!0===w.rects?await o.getElementRects({reference:e,floating:t,strategy:n}):w.rects),({x:u,y:d}=l(c,h,a))),i=-1)}return{x:u,y:d,placement:h,strategy:n,middlewareData:p}})(e,t,{platform:J,...i});async function ee(e,t,i,r){if(!r)throw new Error("Must provide a positioning option");return await("string"==typeof r?async function(e,t,i,r){if(!i)throw new Error("Reference element is required for relative positioning");let n;return n="auto"===r?{middleware:[w(),T(),E({mainAxis:5,crossAxis:12})]}:{placement:r,middleware:[_(),T(),E(5)]},function(e,t,i,r){void 0===r&&(r={});const{ancestorScroll:n=!0,ancestorResize:s=!0,elementResize:o=!0,animationFrame:a=!1}=r,l=n&&!a,c=s&&!a,u=l||c?[...L(e)?Y(e):[],...Y(t)]:[];u.forEach((e=>{l&&e.addEventListener("scroll",i,{passive:!0}),c&&e.addEventListener("resize",i)}));let d=null;if(o){let r=!0;d=new ResizeObserver((()=>{r||i(),r=!1})),L(e)&&!a&&d.observe(e),d.observe(t)}let h,p=a?B(e):null;return a&&function t(){const r=B(e);p&&(r.x!==p.x||r.y!==p.y||r.width!==p.width||r.height!==p.height)&&i(),p=r,h=requestAnimationFrame(t)}(),i(),()=>{var e;u.forEach((e=>{l&&e.removeEventListener("scroll",i),c&&e.removeEventListener("resize",i)})),null==(e=d)||e.disconnect(),d=null,a&&cancelAnimationFrame(h)}}(i,t,(async()=>{if((!i.isConnected||!i.offsetParent)&&function(e){switch(e.options.onPositionLost){case"close":return e.close(),!0;case"destroy":return e.destroy(),!0;case"hold":return!0}}(e))return;const{x:r,y:s}=await Z(i,t,n);Object.assign(t.style,{position:"absolute",left:`${r}px`,top:`${s}px`})}))}(e,t,i,r):function(e,t){return e.style.position="fixed",Object.entries(t).forEach((([t,i])=>{e.style[t]=i})),()=>{}}(t,r))}const te={hideOnClickOutside:!0,hideOnEmojiSelect:!0,hideOnEscape:!0,position:"auto",showCloseButton:!0,onPositionLost:"none"};function ie(e={}){return{...te,rootElement:document.body,...e}}const re=(0,r.oy)("popupContainer","closeButton");class ne{constructor(e,t){this.isOpen=!1,this.externalEvents=new r.sV,this.options={...ie(t),...(0,r.$E)(e)},this.popupEl=document.createElement("div"),this.popupEl.classList.add(re.popupContainer),this.popupEl.classList.add(this.options.theme),t.className&&this.popupEl.classList.add(t.className),this.options.showCloseButton&&(this.closeButton=document.createElement("button"),this.closeButton.type="button",this.closeButton.classList.add(re.closeButton),this.closeButton.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>',this.closeButton.addEventListener("click",(()=>{this.close()})),this.popupEl.appendChild(this.closeButton));const i=document.createElement("div");this.popupEl.appendChild(i),this.picker=(0,r.$)({...this.options,rootElement:i}),this.focusTrap=new r.sp,this.picker.addEventListener("data:ready",(()=>{this.focusTrap.activate(this.picker.el),this.picker.setInitialFocus()})),this.options.hideOnEmojiSelect&&this.picker.addEventListener("emoji:select",(()=>{var e;this.close(),null==(e=this.triggerElement)||e.focus()})),this.options.hideOnClickOutside&&(this.onDocumentClick=this.onDocumentClick.bind(this),document.addEventListener("click",this.onDocumentClick)),this.options.hideOnEscape&&(this.handleKeydown=this.handleKeydown.bind(this),this.popupEl.addEventListener("keydown",this.handleKeydown)),this.referenceElement=this.options.referenceElement,this.triggerElement=this.options.triggerElement}addEventListener(e,t){this.externalEvents.on(e,t),this.picker.addEventListener(e,t)}removeEventListener(e,t){this.externalEvents.off(e,t),this.picker.removeEventListener(e,t)}handleKeydown(e){var t;"Escape"===e.key&&(this.close(),null==(t=this.triggerElement)||t.focus())}async destroy(){this.isOpen&&await this.close(),document.removeEventListener("click",this.onDocumentClick),this.picker.destroy(),this.externalEvents.removeAll()}toggle(e){return this.isOpen?this.close():this.open(e)}async open({triggerElement:e,referenceElement:t}={}){this.isOpen||(e&&(this.triggerElement=e),t&&(this.referenceElement=t),await this.initiateOpenStateChange(!0),this.popupEl.style.opacity="0",this.options.rootElement.appendChild(this.popupEl),await this.setPosition(),this.picker.reset(!1),await this.animatePopup(!0),await this.animateCloseButton(!0),this.picker.setInitialFocus(),this.externalEvents.emit("picker:open"))}async close(){var e;!this.isOpen||(await this.initiateOpenStateChange(!1),await this.animateCloseButton(!1),await this.animatePopup(!1),this.popupEl.remove(),this.picker.reset(),null==(e=this.positionCleanup)||e.call(this),this.focusTrap.deactivate(),this.externalEvents.emit("picker:close"))}getRunningAnimations(){return this.picker.el.getAnimations().filter((e=>"running"===e.playState))}async setPosition(){var e;null==(e=this.positionCleanup)||e.call(this),this.positionCleanup=await ee(this,this.popupEl,this.referenceElement,this.options.position)}awaitPendingAnimations(){return Promise.all(this.getRunningAnimations().map((e=>e.finished)))}onDocumentClick(e){var t;const i=e.target,r=null==(t=this.triggerElement)?void 0:t.contains(i);this.isOpen&&!this.picker.isPickerClick(e)&&!r&&this.close()}animatePopup(e){return(0,r.i0)(this.popupEl,{opacity:[0,1],transform:["scale(0.9)","scale(1)"]},{duration:150,id:e?"show-picker":"hide-picker",easing:"ease-in-out",direction:e?"normal":"reverse",fill:"both"},this.options)}animateCloseButton(e){if(this.closeButton)return(0,r.i0)(this.closeButton,{opacity:[0,1]},{duration:25,id:e?"show-close":"hide-close",easing:"ease-in-out",direction:e?"normal":"reverse",fill:"both"},this.options)}async initiateOpenStateChange(e){this.isOpen=e,await this.awaitPendingAnimations()}}const se=".picmo__popupContainer{display:flex;flex-direction:column;position:absolute}.picmo__popupContainer .picmo__closeButton{position:absolute;opacity:0;background:transparent;border:none;z-index:1;right:0;top:0;cursor:pointer;padding:4px;align-self:flex-end;transform:translate(50%,-50%);background:#999999;width:1.5rem;height:1.5rem;display:flex;align-items:center;justify-content:center;border-radius:50%}.picmo__popupContainer .picmo__closeButton:hover{background:var(--accent-color)}.picmo__popupContainer .picmo__closeButton svg{fill:#fff;width:1.25rem;height:1.25rem}\n",oe=(0,r.WT)();function ae(e,t){return oe(se),new ne({autoFocus:"auto",...e},t)}},545:(e,t,i)=>{"use strict";i.d(t,{$:()=>Ft,$E:()=>be,WT:()=>Pt,i0:()=>y,oy:()=>b,sV:()=>ke,sp:()=>j});var r=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},n=(e,t,i)=>(r(e,t,"read from private field"),i?i.call(e):t.get(e)),s=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},o=(e,t,i,n)=>(r(e,t,"write to private field"),n?n.call(e,i):t.set(e,i),i),a=(e,t,i)=>(r(e,t,"access private method"),i);async function l(e,t={}){const{local:i=!1,version:r="latest",cdnUrl:n,...s}=t,o=function(e,t,i){let r=`https://cdn.jsdelivr.net/npm/emojibase-data@${t}/${e}`;return"function"==typeof i?r=i(e,t):"string"==typeof i&&(r=`${i}/${e}`),r}(e,r,n),a=i?localStorage:sessionStorage,l=`emojibase/${r}/${e}`,c=a.getItem(l);if(c)return Promise.resolve(JSON.parse(c));const u=await fetch(o,{credentials:"omit",mode:"cors",redirect:"error",...s});if(!u.ok)throw new Error("Failed to load Emojibase dataset.");const d=await u.json();try{a.setItem(l,JSON.stringify(d))}catch{}return d}const c={discord:"joypixels",slack:"iamcal"};async function u(e,t,i){var r;return l(`${e}/shortcodes/${null!==(r=c[t])&&void 0!==r?r:t}.json`,i)}function d(e,t){if(0===t.length)return e;const i=new Set(e.shortcodes);return t.forEach((t=>{const r=t[e.hexcode];Array.isArray(r)?r.forEach((e=>i.add(e))):r&&i.add(r)})),e.shortcodes=[...i],e.skins&&e.skins.forEach((e=>{d(e,t)})),e}async function h(e,t={}){const{compact:i=!1,flat:r=!1,shortcodes:n=[],...s}=t,o=await l(`${e}/${i?"compact":"data"}.json`,s);let a=[];return n.length>0&&(a=await Promise.all(n.map((t=>{let i;if(t.includes("/")){const[e,r]=t.split("/");i=u(e,r,s)}else i=u(e,t,s);return i.catch((()=>({})))})))),r?function(e,t=[]){const i=[];return e.forEach((e=>{if(e.skins){const{skins:r,...n}=e;i.push(d(n,t)),r.forEach((e=>{const r={...e};n.tags&&(r.tags=[...n.tags]),i.push(d(r,t))}))}else i.push(d(e,t))})),i}(o,a):function(e,t){return 0===t.length||e.forEach((e=>{d(e,t)})),e}(o,a)}async function p(e,t){return l(`${e}/messages.json`,t)}function f(e,t){const i=e.target.closest("[data-emoji]");if(i){const e=t.find((e=>e.emoji===i.dataset.emoji));if(e)return e}return null}function m(e){var t;const i=null==(t=window.matchMedia)?void 0:t.call(window,"(prefers-reduced-motion: reduce)");return e.animate&&!(null!=i&&i.matches)}function g(e,t){return e.toLowerCase().includes(t.toLowerCase())}function y(e,t,i,r){if(m(r)&&e.animate)return e.animate(t,i).finished;const n="normal"===i.direction?1:0,s=Object.entries(t).reduce(((e,[t,i])=>({...e,[t]:i[n]})),{});return Object.assign(e.style,s),Promise.resolve()}function v(e){var t;const i=document.createElement("template");return i.innerHTML=e,null==(t=i.content)?void 0:t.firstElementChild}function b(...e){return e.reduce(((e,t)=>({...e,[t]:w(t)})),{})}function w(e){return`picmo__${e}`}function _(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function E(e,...t){_(e).append(...t)}function T(e){try{return window[e].length,!0}catch{return!1}}function S(){return T("sessionStorage")}function k(e){var t;return{emoji:e.emoji,label:e.label,tags:e.tags,skins:null==(t=e.skins)?void 0:t.map((e=>k(e))),order:e.order,custom:!1,hexcode:e.hexcode,version:e.version}}function x(e,t,i){var r;return!(i&&!i.some((t=>t.order===e.group)))&&(g(e.label,t)||(null==(r=e.tags)?void 0:r.some((e=>g(e,t)))))}class C{constructor(e="en"){this.locale=e}}const A=[(e,t)=>("1F91D"===e.hexcode&&t<14&&(e.skins=[]),e),(e,t)=>(e.skins&&(e.skins=e.skins.filter((e=>!e.version||e.version<=t))),e)];function R(e,t){return e.filter((e=>null!==function(e,t){return A.some((i=>null===i(e,t)))?null:e}(e,t)))}const L={};function P(e){return L[e]||(L[e]=new O(e)),L[e]}P.deleteDatabase=e=>{};class O extends C{open(){return Promise.resolve()}delete(){return Promise.resolve()}close(){}isPopulated(){return Promise.resolve(!1)}getEmojiCount(){return Promise.resolve(this.emojis.length)}getEtags(){return Promise.resolve({foo:"bar"})}getHash(){return Promise.resolve("")}populate(e){return this.categories=e.groups,this.emojis=e.emojis,Promise.resolve()}getCategories(e){var t;let i=this.categories.filter((e=>"component"!==e.key));if(e.showRecents&&i.unshift({key:"recents",order:-1}),null!=(t=e.custom)&&t.length&&i.push({key:"custom",order:10}),e.categories){const t=e.categories;i=i.filter((e=>t.includes(e.key))),i.sort(((e,i)=>t.indexOf(e.key)-t.indexOf(i.key)))}else i.sort(((e,t)=>e.order-t.order));return Promise.resolve(i)}getEmojis(e,t){const i=this.emojis.filter((t=>t.group===e.order)).filter((e=>e.version<=t)).sort(((e,t)=>null!=e.order&&null!=t.order?e.order-t.order:0)).map(k);return Promise.resolve(R(i,t))}searchEmojis(e,t,i,r){const n=this.emojis.filter((t=>x(t,e,r)&&t.version<=i)).map(k),s=t.filter((t=>x(t,e,r))),o=[...R(n,i),...s];return Promise.resolve(o)}setMeta(e){this.meta=e}}async function D(e){try{return(await fetch(e,{method:"HEAD"})).headers.get("etag")}catch{return null}}async function I(e,t,i){let r=i||t(e);try{await r.open()}catch{console.warn("[picmo] IndexedDB not available, falling back to InMemoryStoreFactory"),r=P(e)}return r}async function M(e,t,i){if(!S()&&typeof window<"u")throw new Error("Session storage is required to use CDN emoji data.");const r=await I(e,t,i),[n,s]=await function(e){const{emojisUrl:t,messagesUrl:i}=function(e,t){const i=`https://cdn.jsdelivr.net/npm/emojibase-data@${"latest"}/${t}`;return{emojisUrl:`${i}/data.json`,messagesUrl:`${i}/messages.json`}}(0,e);try{return Promise.all([D(t),D(i)])}catch{return Promise.all([null,null])}}(e);if(await r.isPopulated())n&&s&&await async function(e,t,i){let r;try{r=await e.getEtags()}catch{r={}}const{storedEmojisEtag:n,storedMessagesEtag:s}=r;if(i!==s||t!==n){const[r,n]=await Promise.all([p(e.locale),h(e.locale)]);await e.populate({groups:r.groups,emojis:n,emojisEtag:t,messagesEtag:i})}}(r,n,s);else{const[t,i]=await Promise.all([p(e),h(e)]);await r.populate({groups:t.groups,emojis:i,emojisEtag:n,messagesEtag:s})}return r}async function F(e,t,i,r,n){const s=await I(e,t,n),o=await async function(e){const t=(new TextEncoder).encode(e),i=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(i)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(r);return(!await s.isPopulated()||await async function(e,t){return t!==await e.getHash()}(s,o))&&await s.populate({groups:i.groups,emojis:r,hash:o}),s}async function N(e,t,i,r,n){return i&&r?F(e,t,i,r,n):M(e,t,n)}class j{constructor(){this.handleKeyDown=this.handleKeyDown.bind(this)}activate(e){this.rootElement=e,this.rootElement.addEventListener("keydown",this.handleKeyDown)}deactivate(){var e;null==(e=this.rootElement)||e.removeEventListener("keydown",this.handleKeyDown)}get focusableElements(){return this.rootElement.querySelectorAll('input, [tabindex="0"]')}get lastFocusableElement(){return this.focusableElements[this.focusableElements.length-1]}get firstFocusableElement(){return this.focusableElements[0]}checkFocus(e,t,i){e.target===t&&(i.focus(),e.preventDefault())}handleKeyDown(e){"Tab"===e.key&&this.checkFocus(e,e.shiftKey?this.firstFocusableElement:this.lastFocusableElement,e.shiftKey?this.lastFocusableElement:this.firstFocusableElement)}}const{light:B,dark:U,auto:z}=b("light","dark","auto");class ${constructor({template:e,classes:t,parent:i}){this.isDestroyed=!1,this.appEvents={},this.uiEvents=[],this.uiElements={},this.ui={},this.template=e,this.classes=t,this.parent=i,this.keyBindingHandler=this.keyBindingHandler.bind(this)}initialize(){this.bindAppEvents()}setCustomEmojis(e){this.customEmojis=e}setEvents(e){this.events=e}setPickerId(e){this.pickerId=e}emit(e,...t){this.events.emit(e,...t)}setI18n(e){this.i18n=e}setRenderer(e){this.renderer=e}setEmojiData(e){this.emojiDataPromise=e,e.then((e=>{this.emojiData=e}))}updateEmojiData(e){this.emojiData=e,this.emojiDataPromise=Promise.resolve(e)}setOptions(e){this.options=e}renderSync(e={}){return this.el=this.template.renderSync({classes:this.classes,i18n:this.i18n,pickerId:this.pickerId,...e}),this.postRender(),this.el}async render(e={}){return await this.emojiDataPromise,this.el=await this.template.renderAsync({classes:this.classes,i18n:this.i18n,pickerId:this.pickerId,...e}),this.postRender(),this.el}postRender(){this.bindUIElements(),this.bindKeyBindings(),this.bindUIEvents(),this.scheduleShowAnimation()}bindAppEvents(){Object.keys(this.appEvents).forEach((e=>{this.events.on(e,this.appEvents[e],this)})),this.events.on("data:ready",this.updateEmojiData,this)}unbindAppEvents(){Object.keys(this.appEvents).forEach((e=>{this.events.off(e,this.appEvents[e])})),this.events.off("data:ready",this.updateEmojiData)}keyBindingHandler(e){const t=this.keyBindings[e.key];t&&t.call(this,e)}bindKeyBindings(){this.keyBindings&&this.el.addEventListener("keydown",this.keyBindingHandler)}unbindKeyBindings(){this.keyBindings&&this.el.removeEventListener("keydown",this.keyBindingHandler)}bindUIElements(){this.ui=Object.keys(this.uiElements).reduce(((e,t)=>({...e,[t]:this.el.querySelector(this.uiElements[t])})),{})}bindUIEvents(){this.uiEvents.forEach((e=>{e.handler=e.handler.bind(this),(e.target?this.ui[e.target]:this.el).addEventListener(e.event,e.handler,e.options)}))}unbindUIEvents(){this.uiEvents.forEach((e=>{(e.target?this.ui[e.target]:this.el).removeEventListener(e.event,e.handler)}))}destroy(){this.unbindAppEvents(),this.unbindUIEvents(),this.unbindKeyBindings(),this.el.remove(),this.isDestroyed=!0}scheduleShowAnimation(){if(this.parent){const e=new MutationObserver((t=>{const[i]=t;"childList"===i.type&&i.addedNodes[0]===this.el&&(m(this.options)&&this.animateShow&&this.animateShow(),e.disconnect)}));e.observe(this.parent,{childList:!0})}}static childEvent(e,t,i,r={}){return{target:e,event:t,handler:i,options:r}}static uiEvent(e,t,i={}){return{event:e,handler:t,options:i}}static byClass(e){return`.${e}`}}const H={clock:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512zM232 256C232 264 236 271.5 242.7 275.1L338.7 339.1C349.7 347.3 364.6 344.3 371.1 333.3C379.3 322.3 376.3 307.4 365.3 300L280 243.2V120C280 106.7 269.3 96 255.1 96C242.7 96 231.1 106.7 231.1 120L232 256z"/></svg>',flag:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M64 496C64 504.8 56.75 512 48 512h-32C7.25 512 0 504.8 0 496V32c0-17.75 14.25-32 32-32s32 14.25 32 32V496zM476.3 0c-6.365 0-13.01 1.35-19.34 4.233c-45.69 20.86-79.56 27.94-107.8 27.94c-59.96 0-94.81-31.86-163.9-31.87C160.9 .3055 131.6 4.867 96 15.75v350.5c32-9.984 59.87-14.1 84.85-14.1c73.63 0 124.9 31.78 198.6 31.78c31.91 0 68.02-5.971 111.1-23.09C504.1 355.9 512 344.4 512 332.1V30.73C512 11.1 495.3 0 476.3 0z"/></svg>',frown:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256zM176.4 240C194 240 208.4 225.7 208.4 208C208.4 190.3 194 176 176.4 176C158.7 176 144.4 190.3 144.4 208C144.4 225.7 158.7 240 176.4 240zM336.4 176C318.7 176 304.4 190.3 304.4 208C304.4 225.7 318.7 240 336.4 240C354 240 368.4 225.7 368.4 208C368.4 190.3 354 176 336.4 176zM259.9 369.4C288.8 369.4 316.2 375.2 340.6 385.5C352.9 390.7 366.7 381.3 361.4 369.1C344.8 330.9 305.6 303.1 259.9 303.1C214.3 303.1 175.1 330.8 158.4 369.1C153.1 381.3 166.1 390.6 179.3 385.4C203.7 375.1 231 369.4 259.9 369.4L259.9 369.4z"/></svg>',gamepad:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M448 64H192C85.96 64 0 149.1 0 256s85.96 192 192 192h256c106 0 192-85.96 192-192S554 64 448 64zM247.1 280h-32v32c0 13.2-10.78 24-23.98 24c-13.2 0-24.02-10.8-24.02-24v-32L136 279.1C122.8 279.1 111.1 269.2 111.1 256c0-13.2 10.85-24.01 24.05-24.01L167.1 232v-32c0-13.2 10.82-24 24.02-24c13.2 0 23.98 10.8 23.98 24v32h32c13.2 0 24.02 10.8 24.02 24C271.1 269.2 261.2 280 247.1 280zM431.1 344c-22.12 0-39.1-17.87-39.1-39.1s17.87-40 39.1-40s39.1 17.88 39.1 40S454.1 344 431.1 344zM495.1 248c-22.12 0-39.1-17.87-39.1-39.1s17.87-40 39.1-40c22.12 0 39.1 17.88 39.1 40S518.1 248 495.1 248z"/></svg>',lightbulb:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M112.1 454.3c0 6.297 1.816 12.44 5.284 17.69l17.14 25.69c5.25 7.875 17.17 14.28 26.64 14.28h61.67c9.438 0 21.36-6.401 26.61-14.28l17.08-25.68c2.938-4.438 5.348-12.37 5.348-17.7L272 415.1h-160L112.1 454.3zM191.4 .0132C89.44 .3257 16 82.97 16 175.1c0 44.38 16.44 84.84 43.56 115.8c16.53 18.84 42.34 58.23 52.22 91.45c.0313 .25 .0938 .5166 .125 .7823h160.2c.0313-.2656 .0938-.5166 .125-.7823c9.875-33.22 35.69-72.61 52.22-91.45C351.6 260.8 368 220.4 368 175.1C368 78.61 288.9-.2837 191.4 .0132zM192 96.01c-44.13 0-80 35.89-80 79.1C112 184.8 104.8 192 96 192S80 184.8 80 176c0-61.76 50.25-111.1 112-111.1c8.844 0 16 7.159 16 16S200.8 96.01 192 96.01z"/></svg>',mug:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M512 32H120c-13.25 0-24 10.75-24 24L96.01 288c0 53 43 96 96 96h192C437 384 480 341 480 288h32c70.63 0 128-57.38 128-128S582.6 32 512 32zM512 224h-32V96h32c35.25 0 64 28.75 64 64S547.3 224 512 224zM560 416h-544C7.164 416 0 423.2 0 432C0 458.5 21.49 480 48 480h480c26.51 0 48-21.49 48-48C576 423.2 568.8 416 560 416z"/></svg>',plane:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M482.3 192C516.5 192 576 221 576 256C576 292 516.5 320 482.3 320H365.7L265.2 495.9C259.5 505.8 248.9 512 237.4 512H181.2C170.6 512 162.9 501.8 165.8 491.6L214.9 320H112L68.8 377.6C65.78 381.6 61.04 384 56 384H14.03C6.284 384 0 377.7 0 369.1C0 368.7 .1818 367.4 .5398 366.1L32 256L.5398 145.9C.1818 144.6 0 143.3 0 142C0 134.3 6.284 128 14.03 128H56C61.04 128 65.78 130.4 68.8 134.4L112 192H214.9L165.8 20.4C162.9 10.17 170.6 0 181.2 0H237.4C248.9 0 259.5 6.153 265.2 16.12L365.7 192H482.3z"/></svg>',robot:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M9.375 233.4C3.375 239.4 0 247.5 0 256v128c0 8.5 3.375 16.62 9.375 22.62S23.5 416 32 416h32V224H32C23.5 224 15.38 227.4 9.375 233.4zM464 96H352V32c0-17.62-14.38-32-32-32S288 14.38 288 32v64H176C131.8 96 96 131.8 96 176V448c0 35.38 28.62 64 64 64h320c35.38 0 64-28.62 64-64V176C544 131.8 508.3 96 464 96zM256 416H192v-32h64V416zM224 296C201.9 296 184 278.1 184 256S201.9 216 224 216S264 233.9 264 256S246.1 296 224 296zM352 416H288v-32h64V416zM448 416h-64v-32h64V416zM416 296c-22.12 0-40-17.88-40-40S393.9 216 416 216S456 233.9 456 256S438.1 296 416 296zM630.6 233.4C624.6 227.4 616.5 224 608 224h-32v192h32c8.5 0 16.62-3.375 22.62-9.375S640 392.5 640 384V256C640 247.5 636.6 239.4 630.6 233.4z"/></svg>',sad:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\n  <defs>\n    <radialGradient gradientUnits="userSpaceOnUse" cy="10%" id="gradient-0">\n      <stop offset="0" stop-color="hsl(50, 100%, 50%)" />\n      <stop offset="1" stop-color="hsl(50, 100%, 60%)" />\n    </radialGradient>\n  </defs>\n  \x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e\n  <ellipse stroke="#000" fill="rgba(0, 0, 0, 0.6)" cx="172.586" cy="207.006" rx="39.974" ry="39.974"/>\n  <ellipse stroke="#000" fill="rgba(0, 0, 0, 0.6)" cx="334.523" cy="207.481" rx="39.974" ry="39.974"/>\n  <ellipse stroke="#000" fill="rgba(0, 0, 0, 0.6)" cx="313.325" cy="356.208" rx="91.497" ry="59.893"/>\n  <path fill="#55a7ff" d="M 159.427 274.06 L 102.158 363.286 L 124.366 417.011 L 160.476 423.338 L 196.937 414.736 L 218.502 375.214"></path>\n  <path fill="url(#gradient-0)" d="M256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0zM256 352C290.9 352 323.2 367.8 348.3 394.9C354.3 401.4 364.4 401.7 370.9 395.7C377.4 389.7 377.7 379.6 371.7 373.1C341.6 340.5 301 320 256 320C247.2 320 240 327.2 240 336C240 344.8 247.2 352 256 352H256zM208 369C208 349 179.6 308.6 166.4 291.3C163.2 286.9 156.8 286.9 153.6 291.3C140.6 308.6 112 349 112 369C112 395 133.5 416 160 416C186.5 416 208 395 208 369H208zM303.6 208C303.6 225.7 317.1 240 335.6 240C353.3 240 367.6 225.7 367.6 208C367.6 190.3 353.3 176 335.6 176C317.1 176 303.6 190.3 303.6 208zM207.6 208C207.6 190.3 193.3 176 175.6 176C157.1 176 143.6 190.3 143.6 208C143.6 225.7 157.1 240 175.6 240C193.3 240 207.6 225.7 207.6 208z" />\n</svg>',search:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M500.3 443.7l-119.7-119.7c27.22-40.41 40.65-90.9 33.46-144.7C401.8 87.79 326.8 13.32 235.2 1.723C99.01-15.51-15.51 99.01 1.724 235.2c11.6 91.64 86.08 166.7 177.6 178.9c53.8 7.189 104.3-6.236 144.7-33.46l119.7 119.7c15.62 15.62 40.95 15.62 56.57 0C515.9 484.7 515.9 459.3 500.3 443.7zM79.1 208c0-70.58 57.42-128 128-128s128 57.42 128 128c0 70.58-57.42 128-128 128S79.1 278.6 79.1 208z"/></svg>',smiley:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256zM256.3 331.8C208.9 331.8 164.1 324.9 124.5 312.8C112.2 309 100.2 319.7 105.2 331.5C130.1 390.6 188.4 432 256.3 432C324.2 432 382.4 390.6 407.4 331.5C412.4 319.7 400.4 309 388.1 312.8C348.4 324.9 303.7 331.8 256.3 331.8H256.3zM176.4 176C158.7 176 144.4 190.3 144.4 208C144.4 225.7 158.7 240 176.4 240C194 240 208.4 225.7 208.4 208C208.4 190.3 194 176 176.4 176zM336.4 240C354 240 368.4 225.7 368.4 208C368.4 190.3 354 176 336.4 176C318.7 176 304.4 190.3 304.4 208C304.4 225.7 318.7 240 336.4 240z"/></svg>',symbols:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M500.3 7.251C507.7 13.33 512 22.41 512 31.1V175.1C512 202.5 483.3 223.1 447.1 223.1C412.7 223.1 383.1 202.5 383.1 175.1C383.1 149.5 412.7 127.1 447.1 127.1V71.03L351.1 90.23V207.1C351.1 234.5 323.3 255.1 287.1 255.1C252.7 255.1 223.1 234.5 223.1 207.1C223.1 181.5 252.7 159.1 287.1 159.1V63.1C287.1 48.74 298.8 35.61 313.7 32.62L473.7 .6198C483.1-1.261 492.9 1.173 500.3 7.251H500.3zM74.66 303.1L86.5 286.2C92.43 277.3 102.4 271.1 113.1 271.1H174.9C185.6 271.1 195.6 277.3 201.5 286.2L213.3 303.1H239.1C266.5 303.1 287.1 325.5 287.1 351.1V463.1C287.1 490.5 266.5 511.1 239.1 511.1H47.1C21.49 511.1-.0019 490.5-.0019 463.1V351.1C-.0019 325.5 21.49 303.1 47.1 303.1H74.66zM143.1 359.1C117.5 359.1 95.1 381.5 95.1 407.1C95.1 434.5 117.5 455.1 143.1 455.1C170.5 455.1 191.1 434.5 191.1 407.1C191.1 381.5 170.5 359.1 143.1 359.1zM440.3 367.1H496C502.7 367.1 508.6 372.1 510.1 378.4C513.3 384.6 511.6 391.7 506.5 396L378.5 508C372.9 512.1 364.6 513.3 358.6 508.9C352.6 504.6 350.3 496.6 353.3 489.7L391.7 399.1H336C329.3 399.1 323.4 395.9 321 389.6C318.7 383.4 320.4 376.3 325.5 371.1L453.5 259.1C459.1 255 467.4 254.7 473.4 259.1C479.4 263.4 481.6 271.4 478.7 278.3L440.3 367.1zM116.7 219.1L19.85 119.2C-8.112 90.26-6.614 42.31 24.85 15.34C51.82-8.137 93.26-3.642 118.2 21.83L128.2 32.32L137.7 21.83C162.7-3.642 203.6-8.137 231.6 15.34C262.6 42.31 264.1 90.26 236.1 119.2L139.7 219.1C133.2 225.6 122.7 225.6 116.7 219.1H116.7z"/></svg>',tree:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M413.8 447.1L256 448l0 31.99C256 497.7 241.8 512 224.1 512c-17.67 0-32.1-14.32-32.1-31.99l0-31.99l-158.9-.0099c-28.5 0-43.69-34.49-24.69-56.4l68.98-79.59H62.22c-25.41 0-39.15-29.8-22.67-49.13l60.41-70.85H89.21c-21.28 0-32.87-22.5-19.28-37.31l134.8-146.5c10.4-11.3 28.22-11.3 38.62-.0033l134.9 146.5c13.62 14.81 2.001 37.31-19.28 37.31h-10.77l60.35 70.86c16.46 19.34 2.716 49.12-22.68 49.12h-15.2l68.98 79.59C458.7 413.7 443.1 447.1 413.8 447.1z"/></svg>',users:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M224 256c70.7 0 128-57.31 128-128S294.7 0 224 0C153.3 0 96 57.31 96 128S153.3 256 224 256zM274.7 304H173.3c-95.73 0-173.3 77.6-173.3 173.3C0 496.5 15.52 512 34.66 512H413.3C432.5 512 448 496.5 448 477.3C448 381.6 370.4 304 274.7 304zM479.1 320h-73.85C451.2 357.7 480 414.1 480 477.3C480 490.1 476.2 501.9 470 512h138C625.7 512 640 497.6 640 479.1C640 391.6 568.4 320 479.1 320zM432 256C493.9 256 544 205.9 544 144S493.9 32 432 32c-25.11 0-48.04 8.555-66.72 22.51C376.8 76.63 384 101.4 384 128c0 35.52-11.93 68.14-31.59 94.71C372.7 243.2 400.8 256 432 256z"/></svg>',warning:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\n  <defs>\n    <radialGradient id="radial" cy="85%">\n      <stop offset="20%" stop-color="var(--color-secondary)" />\n      <stop offset="100%" stop-color="var(--color-primary)" />\n    </radialGradient>\n  </defs>\n  \x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e\n  <path fill="url(\'#radial\')" d="M506.3 417l-213.3-364c-16.33-28-57.54-28-73.98 0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6C502.1 480 522.6 445 506.3 417zM232 168c0-13.25 10.75-24 24-24S280 154.8 280 168v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zM256 416c-17.36 0-31.44-14.08-31.44-31.44c0-17.36 14.07-31.44 31.44-31.44s31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z" />\n</svg>',xmark:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>'},V={recents:"clock","smileys-emotion":"smiley","people-body":"users","animals-nature":"tree","food-drink":"mug",activities:"gamepad","travel-places":"plane",objects:"lightbulb",symbols:"symbols",flags:"flag",custom:"robot"};function G(e,t){if(!(e in H))return console.warn(`Unknown icon: "${e}"`),document.createElement("div");const i=function(e,t){const i=v(t);return i.dataset.icon=e,i.classList.add(w("icon")),i}(e,H[e]);return t&&i.classList.add(w(`icon-${t}`)),i}const K="sync";var q,W,Y,X,Q,J,Z,ee;class te{constructor(e,t={}){s(this,Y),s(this,Q),s(this,Z),s(this,q,void 0),s(this,W,void 0),o(this,q,e),o(this,W,t.mode||K)}renderSync(e={}){const t=v(n(this,q).call(this,e));return a(this,Z,ee).call(this,t,e),a(this,Q,J).call(this,t),a(this,Y,X).call(this,t,e),t}async renderAsync(e={}){const t=v(n(this,q).call(this,e));return a(this,Z,ee).call(this,t,e),a(this,Q,J).call(this,t),await a(this,Y,X).call(this,t,e),t}render(e){return"sync"===n(this,W)?this.renderSync(e):this.renderAsync(e)}}q=new WeakMap,W=new WeakMap,Y=new WeakSet,X=async function(e,t){const i=e.querySelectorAll("[data-view]"),r=[];for(const e of i){const i=t[e.dataset.view];i?"sync"!==e.dataset.render?r.push(i.render().then((t=>(e.replaceWith(t),t)))):e.replaceWith(i.renderSync()):e.remove()}return Promise.all(r)},Q=new WeakSet,J=function(e){e.querySelectorAll("i[data-icon]").forEach((e=>{const{icon:t,size:i}=e.dataset;e.replaceWith(G(t,i))}))},Z=new WeakSet,ee=function(e,t){return e.querySelectorAll("[data-placeholder]").forEach((e=>{const i=e.dataset.placeholder;if(i&&t[i]){const r=t[i];e.replaceWith(...[r].flat())}else console.warn(`Missing placeholder element for key "${i}"`)})),e};const ie=b("imagePlaceholder","placeholder"),re=new te((({classes:e})=>`\n  <div class="${e.placeholder} ${e.imagePlaceholder}"></div>\n`));class ne extends ${constructor({classNames:e}={}){super({template:re,classes:ie}),this.classNames=e}load(e){const t=document.createElement("img");this.classNames&&(t.className=this.classNames),t.addEventListener("load",(()=>{this.el.replaceWith(t)}),{once:!0}),Promise.resolve(e).then((e=>t.src=e))}renderSync(){return super.renderSync(),this.classNames&&this.classNames.split(" ").forEach((e=>this.el.classList.add(e))),this.el}}const se=b("customEmoji");class oe{renderElement(e){return{content:e}}renderImage(e="",t){const i=new ne({classNames:e});return i.renderSync(),{content:i,resolver:()=>(i.load(t()),i.el)}}doRender(e,t,i){if(e.custom)return this.renderCustom(e,t,i);const{content:r,resolver:n}=this.render(e,i),s=r instanceof Element?r:r.el;return n&&n(),s}doEmit(e){return e.custom?this.emitCustom(e):this.emit(e)}emitCustom({url:e,label:t,emoji:i,data:r}){return{url:e,label:t,emoji:i,data:r}}renderCustom(e,t,i=""){const r=[se.customEmoji,i].join(" ").trim(),{content:n,resolver:s}=this.renderImage(r,(()=>e.url)),o=n instanceof Element?n:n.el;return s&&s(),o}}const ae=new te((({emoji:e})=>`<span>${e}</span>`));class le extends oe{render(e){return this.renderElement(ae.renderSync({emoji:e.emoji}))}emit({emoji:e,hexcode:t,label:i}){return{emoji:e,hexcode:t,label:i}}}const ce={"categories.activities":"Activities","categories.animals-nature":"Animals & Nature","categories.custom":"Custom","categories.flags":"Flags","categories.food-drink":"Food & Drink","categories.objects":"Objects","categories.people-body":"People & Body","categories.recents":"Recently Used","categories.smileys-emotion":"Smileys & Emotion","categories.symbols":"Symbols","categories.travel-places":"Travel & Places","error.load":"Failed to load emojis","recents.clear":"Clear recent emojis","recents.none":"You haven't selected any emojis yet.",retry:"Try again","search.clear":"Clear search","search.error":"Failed to search emojis","search.notFound":"No results found",search:"Search emojis..."},ue="PicMo";function de(e){return new he(e)}de.deleteDatabase=e=>new Promise(((t,i)=>{const r=indexedDB.deleteDatabase(`${ue}-${e}`);r.addEventListener("success",t),r.addEventListener("error",i)}));class he extends C{async open(){const e=indexedDB.open(`${ue}-${this.locale}`);return new Promise(((t,i)=>{e.addEventListener("success",(e=>{var i;this.db=null==(i=e.target)?void 0:i.result,t()})),e.addEventListener("error",i),e.addEventListener("upgradeneeded",(async e=>{var t;this.db=null==(t=e.target)?void 0:t.result,this.db.createObjectStore("category",{keyPath:"order"});const i=this.db.createObjectStore("emoji",{keyPath:"emoji"});i.createIndex("category","group"),i.createIndex("version","version"),this.db.createObjectStore("meta")}))}))}async delete(){this.close();const e=indexedDB.deleteDatabase(`${ue}-${this.locale}`);await this.waitForRequest(e)}close(){this.db.close()}async getEmojiCount(){const e=this.db.transaction("emoji","readonly").objectStore("emoji");return(await this.waitForRequest(e.count())).target.result}async getEtags(){const e=this.db.transaction("meta","readonly").objectStore("meta"),[t,i]=await Promise.all([this.waitForRequest(e.get("emojisEtag")),this.waitForRequest(e.get("messagesEtag"))]);return{storedEmojisEtag:t.target.result,storedMessagesEtag:i.target.result}}async setMeta(e){const t=this.db.transaction("meta","readwrite"),i=t.objectStore("meta");return new Promise((r=>{t.oncomplete=r,Object.keys(e).filter(Boolean).forEach((t=>{i.put(e[t],t)}))}))}async getHash(){const e=this.db.transaction("meta","readonly").objectStore("meta");return(await this.waitForRequest(e.get("hash"))).target.result}async isPopulated(){const e=this.db.transaction("category","readonly").objectStore("category");return(await this.waitForRequest(e.count())).target.result>0}async populate({groups:e,emojis:t,emojisEtag:i,messagesEtag:r,hash:n}){await this.removeAllObjects("category","emoji");const s=[this.addObjects("category",e),this.addObjects("emoji",t),this.setMeta({emojisEtag:i,messagesEtag:r,hash:n})];await Promise.all(s)}async getCategories(e){var t;const i=this.db.transaction("category","readonly").objectStore("category");let r=(await this.waitForRequest(i.getAll())).target.result.filter((e=>"component"!==e.key));if(e.showRecents&&r.unshift({key:"recents",order:-1}),null!=(t=e.custom)&&t.length&&r.push({key:"custom",order:10}),e.categories){const t=e.categories;r=r.filter((e=>t.includes(e.key))),r.sort(((e,i)=>t.indexOf(e.key)-t.indexOf(i.key)))}else r.sort(((e,t)=>e.order-t.order));return r}async getEmojis(e,t){const i=this.db.transaction("emoji","readonly").objectStore("emoji").index("category");return R((await this.waitForRequest(i.getAll(e.order))).target.result.filter((e=>e.version<=t)).sort(((e,t)=>null!=e.order&&null!=t.order?e.order-t.order:0)).map(k),t)}async searchEmojis(e,t,i,r){const n=[];return new Promise(((s,o)=>{const a=this.db.transaction("emoji","readonly").objectStore("emoji").openCursor();a.addEventListener("success",(o=>{var a;const l=null==(a=o.target)?void 0:a.result;if(!l)return s([...R(n,i),...t.filter((t=>x(t,e)))]);const c=l.value;x(c,e,r)&&c.version<=i&&n.push(k(c)),l.continue()})),a.addEventListener("error",(e=>{o(e)}))}))}async waitForRequest(e){return new Promise(((t,i)=>{e.onsuccess=t,e.onerror=i}))}withTransaction(e,t="readwrite",i){return new Promise(((r,n)=>{const s=this.db.transaction(e,t);s.oncomplete=r,s.onerror=n,i(s)}))}async removeAllObjects(...e){const t=this.db.transaction(e,"readwrite"),i=e.map((e=>t.objectStore(e)));await Promise.all(i.map((e=>this.waitForRequest(e.clear()))))}async addObjects(e,t){return this.withTransaction(e,"readwrite",(i=>{const r=i.objectStore(e);t.forEach((e=>{r.add(e)}))}))}}function pe(){let e={};return{getItem:t=>e[t],setItem:(t,i)=>e[t]=i,length:Object.keys(e).length,clear:()=>e={},key:t=>Object.keys(e)[t],removeItem:t=>delete e[t]}}class fe{}const me="PicMo:recents";class ge extends fe{constructor(e){super(),this.storage=e}clear(){this.storage.removeItem(me)}getRecents(e){var t;try{return JSON.parse(null!=(t=this.storage.getItem(me))?t:"[]").slice(0,e)}catch{return[]}}addOrUpdateRecent(e,t){const i=[e,...this.getRecents(t).filter((t=>t.hexcode!==e.hexcode))].slice(0,t);try{this.storage.setItem(me,JSON.stringify(i))}catch{console.warn("storage is not available, recent emojis will not be saved")}}}class ye extends ge{constructor(){super(T("localStorage")?localStorage:pe())}}const ve={dataStore:de,theme:B,animate:!0,showCategoryTabs:!0,showPreview:!0,showRecents:!0,showSearch:!0,showVariants:!0,emojisPerRow:8,visibleRows:6,emojiVersion:"auto",i18n:ce,locale:"en",maxRecents:50,custom:[]};function be(e={}){return{...ve,...e,renderer:e.renderer||new le,recentsProvider:e.recentsProvider||new ye}}var we,_e,Ee,Te,Se;class ke{constructor(){s(this,_e),s(this,Te),s(this,we,new Map)}on(e,t,i){a(this,Te,Se).call(this,e,t,i)}once(e,t,i){a(this,Te,Se).call(this,e,t,i,!0)}off(e,t){const i=a(this,_e,Ee).call(this,e);n(this,we).set(e,i.filter((e=>e.handler!==t)))}emit(e,...t){a(this,_e,Ee).call(this,e).forEach((i=>{i.handler.apply(i.context,t),i.once&&this.off(e,i.handler)}))}removeAll(){n(this,we).clear()}}we=new WeakMap,_e=new WeakSet,Ee=function(e){return n(this,we).has(e)||n(this,we).set(e,[]),n(this,we).get(e)},Te=new WeakSet,Se=function(e,t,i,r=!1){a(this,_e,Ee).call(this,e).push({context:i,handler:t,once:r})};const xe={injectStyles:!0};class Ce extends ke{}class Ae extends ke{}const Re=b("emojiCategory","categoryName","noRecents","recentEmojis");class Le extends ${constructor({template:e,category:t,showVariants:i,lazyLoader:r}){super({template:e,classes:Re}),this.baseUIElements={categoryName:$.byClass(Re.categoryName)},this.category=t,this.showVariants=i,this.lazyLoader=r}setActive(e,t,i){this.emojiContainer.setActive(e,t,i)}}const Pe=new te((({classes:e,emoji:t})=>`\n  <button\n    type="button"\n    class="${e.emojiButton}"\n    title="${t.label}"\n    data-emoji="${t.emoji}"\n    tabindex="-1">\n    <div data-placeholder="emojiContent"></div>\n  </button>\n`)),Oe=b("emojiButton");class De extends ${constructor({emoji:e,lazyLoader:t,category:i}){super({template:Pe,classes:Oe}),this.emoji=e,this.lazyLoader=t,this.category=i}initialize(){this.uiEvents=[$.uiEvent("focus",this.handleFocus)],super.initialize()}handleFocus(){this.category&&this.events.emit("focus:change",this.category)}activateFocus(e){this.el.tabIndex=0,e&&this.el.focus()}deactivateFocus(){this.el.tabIndex=-1}renderSync(){return super.renderSync({emoji:this.emoji,emojiContent:this.renderer.doRender(this.emoji,this.lazyLoader)})}}class Ie{constructor(e,t,i=0,r=0,n=!1){this.events=new ke,this.keyHandlers={ArrowLeft:this.focusPrevious.bind(this),ArrowRight:this.focusNext.bind(this),ArrowUp:this.focusUp.bind(this),ArrowDown:this.focusDown.bind(this)},this.rowCount=Math.ceil(t/e),this.columnCount=e,this.focusedRow=i,this.focusedColumn=r,this.emojiCount=t,this.wrap=n,this.handleKeyDown=this.handleKeyDown.bind(this)}destroy(){this.events.removeAll()}on(e,t){this.events.on(e,t)}handleKeyDown(e){e.key in this.keyHandlers&&(e.preventDefault(),this.keyHandlers[e.key]())}setCell(e,t,i=!0){const r=this.getIndex();this.focusedRow=e,void 0!==t&&(this.focusedColumn=Math.min(this.columnCount,t)),(this.focusedRow>=this.rowCount||this.getIndex()>=this.emojiCount)&&(this.focusedRow=this.rowCount-1,this.focusedColumn=this.emojiCount%this.columnCount-1),this.events.emit("focus:change",{from:r,to:this.getIndex(),performFocus:i})}setFocusedIndex(e,t=!0){const i=Math.floor(e/this.columnCount),r=e%this.columnCount;this.setCell(i,r,t)}focusNext(){this.focusedColumn<this.columnCount-1&&this.getIndex()<this.emojiCount-1?this.setCell(this.focusedRow,this.focusedColumn+1):this.focusedRow<this.rowCount-1?this.setCell(this.focusedRow+1,0):this.wrap?this.setCell(0,0):this.events.emit("focus:overflow",0)}focusPrevious(){this.focusedColumn>0?this.setCell(this.focusedRow,this.focusedColumn-1):this.focusedRow>0?this.setCell(this.focusedRow-1,this.columnCount-1):this.wrap?this.setCell(this.rowCount-1,this.columnCount-1):this.events.emit("focus:underflow",this.columnCount-1)}focusUp(){this.focusedRow>0?this.setCell(this.focusedRow-1,this.focusedColumn):this.events.emit("focus:underflow",this.focusedColumn)}focusDown(){this.focusedRow<this.rowCount-1?this.setCell(this.focusedRow+1,this.focusedColumn):this.events.emit("focus:overflow",this.focusedColumn)}focusToIndex(e){this.setCell(Math.floor(e/this.columnCount),e%this.columnCount)}getIndex(){return this.focusedRow*this.columnCount+this.focusedColumn}getCell(){return{row:this.focusedRow,column:this.focusedColumn}}getRowCount(){return this.rowCount}}const Me=new te((({classes:e})=>`\n  <div class="${e.emojiContainer}">\n    <div data-placeholder="emojis"></div>\n  </div>\n`)),Fe=b("emojiContainer");class Ne extends ${constructor({emojis:e,showVariants:t,preview:i=!0,lazyLoader:r,category:n,fullHeight:s=!1}){super({template:Me,classes:Fe}),this.fullHeight=!1,this.showVariants=t,this.lazyLoader=r,this.preview=i,this.emojis=e,this.category=n,this.fullHeight=s,this.setFocus=this.setFocus.bind(this),this.triggerNextCategory=this.triggerNextCategory.bind(this),this.triggerPreviousCategory=this.triggerPreviousCategory.bind(this)}initialize(){this.grid=new Ie(this.options.emojisPerRow,this.emojiCount,0,0,!this.category),this.grid.on("focus:change",this.setFocus),this.grid.on("focus:overflow",this.triggerNextCategory),this.grid.on("focus:underflow",this.triggerPreviousCategory),this.uiEvents=[$.uiEvent("click",this.selectEmoji),$.uiEvent("keydown",this.grid.handleKeyDown)],this.preview&&this.uiEvents.push($.uiEvent("mouseover",this.showPreview),$.uiEvent("mouseout",this.hidePreview),$.uiEvent("focus",this.showPreview,{capture:!0}),$.uiEvent("blur",this.hidePreview,{capture:!0})),super.initialize()}setFocusedView(e,t){if(e)if("string"==typeof e){const t=this.emojis.findIndex((t=>t.emoji===e));this.grid.setFocusedIndex(t,!1),setTimeout((()=>{var e,i,r,n;const s=this.emojiViews[t].el;s.scrollIntoView();const o=null==(e=s.parentElement)?void 0:e.previousElementSibling;(null==(r=null==(i=s.parentElement)?void 0:i.parentElement)?void 0:r.parentElement).scrollTop-=null!=(n=null==o?void 0:o.offsetHeight)?n:0}))}else"first"===e.row||0===e.row?this.grid.setCell(0,e.offset,t):"last"===e.row&&this.grid.setCell(this.grid.getRowCount()-1,e.offset,t)}setActive(e,t,i){var r;e?this.setFocusedView(t,i):null==(r=this.emojiViews[this.grid.getIndex()])||r.deactivateFocus()}renderSync(){return this.emojiViews=this.emojis.map((e=>this.viewFactory.create(De,{emoji:e,category:this.category,lazyLoader:this.lazyLoader,renderer:this.renderer}))),this.emojiElements=this.emojiViews.map((e=>e.renderSync())),super.renderSync({emojis:this.emojiElements,i18n:this.i18n})}destroy(){super.destroy(),this.emojiViews.forEach((e=>e.destroy())),this.grid.destroy()}triggerPreviousCategory(e){this.events.emit("category:previous",e)}triggerNextCategory(e){this.category&&this.events.emit("category:next",e)}setFocus({from:e,to:t,performFocus:i}){var r,n;null==(r=this.emojiViews[e])||r.deactivateFocus(),null==(n=this.emojiViews[t])||n.activateFocus(i)}selectEmoji(e){e.stopPropagation();const t=f(e,this.emojis);t&&this.events.emit("emoji:select",{emoji:t,showVariants:this.showVariants})}showPreview(e){const t=e.target.closest("button"),i=null==t?void 0:t.firstElementChild,r=f(e,this.emojis);r&&this.events.emit("preview:show",r,null==i?void 0:i.cloneNode(!0))}hidePreview(e){f(e,this.emojis)&&this.events.emit("preview:hide")}get emojiCount(){return this.emojis.length}}const je=new te((({classes:e,category:t,pickerId:i,icon:r,i18n:n})=>`\n  <section class="${e.emojiCategory}" role="tabpanel" aria-labelledby="${i}-category-${t.key}">\n    <h3 data-category="${t.key}" class="${e.categoryName}">\n      <i data-icon="${r}"></i>\n      ${n.get(`categories.${t.key}`,t.message||t.key)}\n    </h3>\n    <div data-view="emojis" data-render="sync"></div>\n  </section>\n`));class Be extends Le{constructor({category:e,showVariants:t,lazyLoader:i,emojiVersion:r}){super({category:e,showVariants:t,lazyLoader:i,template:je}),this.showVariants=t,this.lazyLoader=i,this.emojiVersion=r}initialize(){this.uiElements={...this.baseUIElements},super.initialize()}async render(){await this.emojiDataPromise;const e=await this.emojiData.getEmojis(this.category,this.emojiVersion);return this.emojiContainer=this.viewFactory.create(Ne,{emojis:e,showVariants:this.showVariants,lazyLoader:this.lazyLoader,category:this.category.key}),super.render({category:this.category,emojis:this.emojiContainer,emojiCount:e.length,icon:V[this.category.key]})}}class Ue extends Ne{constructor({category:e,emojis:t,preview:i=!0,lazyLoader:r}){super({category:e,emojis:t,showVariants:!1,preview:i,lazyLoader:r})}async addOrUpdate(e){const t=this.el.querySelector(`[data-emoji="${e.emoji}"]`);t&&(this.el.removeChild(t),this.emojis=this.emojis.filter((t=>t!==e)));const i=this.viewFactory.create(De,{emoji:e});if(this.el.insertBefore(i.renderSync(),this.el.firstChild),this.emojis=[e,...this.emojis.filter((t=>t!==e))],this.emojis.length>this.options.maxRecents){this.emojis=this.emojis.slice(0,this.options.maxRecents);const e=this.el.childElementCount-this.options.maxRecents;for(let t=0;t<e;t++)this.el.lastElementChild&&this.el.removeChild(this.el.lastElementChild)}}}const ze=new te((({emojiCount:e,classes:t,category:i,pickerId:r,icon:n,i18n:s})=>`\n  <section class="${t.emojiCategory}" role="tabpanel" aria-labelledby="${r}-category-${i.key}">\n    <h3 data-category="${i.key}" class="${t.categoryName}">\n      <i data-icon="${n}"></i>\n      ${s.get(`categories.${i.key}`,i.message||i.key)}\n    </h3>\n    <div data-empty="${0===e}" class="${t.recentEmojis}">\n      <div data-view="emojis" data-render="sync"></div>\n    </div>\n    <div class="${t.noRecents}">\n      ${s.get("recents.none")}\n    </div>\n  </section>\n`),{mode:"async"});const $e=new te((({classes:e,category:t,pickerId:i,icon:r,i18n:n})=>`\n  <section class="${e.emojiCategory}" role="tabpanel" aria-labelledby="${i}-category-${t.key}">\n    <h3 data-category="${t.key}" class="${e.categoryName}">\n      <i data-icon="${r}"></i>\n      ${n.get(`categories.${t.key}`,t.message||t.key)}\n    </h3>\n    <div data-view="emojis" data-render="sync"></div>\n  </section>\n`));class He{constructor(){this.elements=new Map}lazyLoad(e,t){return this.elements.set(e,t),e}observe(e){if(window.IntersectionObserver){const t=new IntersectionObserver((e=>{e.filter((e=>e.intersectionRatio>0)).map((e=>e.target)).forEach((e=>{const i=this.elements.get(e);null==i||i(),t.unobserve(e)}))}),{root:e});this.elements.forEach(((e,i)=>{t.observe(i)}))}else this.elements.forEach((e=>{e()}))}}const Ve=b("emojiArea"),Ge=new te((({classes:e})=>`\n  <div class="${e.emojiArea}">\n    <div data-placeholder="emojis"></div>\n  </div>\n`),{mode:"async"}),Ke={recents:class extends Le{constructor({category:e,lazyLoader:t,provider:i}){super({category:e,showVariants:!1,lazyLoader:t,template:ze}),this.provider=i}initialize(){this.uiElements={...this.baseUIElements,recents:$.byClass(Re.recentEmojis)},this.appEvents={"recent:add":this.addRecent},super.initialize()}async addRecent(e){await this.emojiContainer.addOrUpdate(e),this.ui.recents.dataset.empty="false"}async render(){var e;const t=null==(e=this.provider)?void 0:e.getRecents(this.options.maxRecents);return this.emojiContainer=this.viewFactory.create(Ue,{emojis:t,showVariants:!1,lazyLoader:this.lazyLoader,category:this.category.key}),await super.render({category:this.category,emojis:this.emojiContainer,emojiCount:t.length,icon:V[this.category.key]}),this.el}},custom:class extends Le{constructor({category:e,lazyLoader:t}){super({template:$e,showVariants:!1,lazyLoader:t,category:e})}initialize(){this.uiElements={...this.baseUIElements},super.initialize()}async render(){return this.emojiContainer=this.viewFactory.create(Ne,{emojis:this.customEmojis,showVariants:this.showVariants,lazyLoader:this.lazyLoader,category:this.category.key}),super.render({category:this.category,emojis:this.emojiContainer,emojiCount:this.customEmojis.length,icon:V[this.category.key]})}}};class qe extends ${constructor({categoryTabs:e,categories:t,emojiVersion:i}){super({template:Ge,classes:Ve}),this.selectedCategory=0,this.scrollListenerState="active",this.lazyLoader=new He,this.categoryTabs=e,this.categories=t,this.emojiVersion=i,this.handleScroll=function(e,t){let i=null;return()=>{i||(i=window.setTimeout((()=>{e(),i=null}),t))}}(this.handleScroll.bind(this),100)}initialize(){this.appEvents={"category:select":this.handleCategorySelect,"category:previous":this.focusPreviousCategory,"category:next":this.focusNextCategory,"focus:change":this.updateFocusedCategory},this.uiElements={emojis:$.byClass(Ve.emojiArea)},this.uiEvents=[$.uiEvent("scroll",this.handleScroll)],super.initialize()}get focusableEmoji(){return this.el.querySelector('[tabindex="0"]')}async render(){this.emojiCategories=this.categories.map(this.createCategory,this);const e={};return this.categories.forEach(((t,i)=>{e[`emojis-${t.key}`]=this.emojiCategories[i]})),await super.render({emojis:await Promise.all(this.emojiCategories.map((e=>e.render())))}),this.lazyLoader.observe(this.el),this.el}destroy(){super.destroy(),this.emojiCategories.forEach((e=>{var t;null==(t=this.observer)||t.unobserve(e.el),e.destroy()}))}handleCategorySelect(e,t){this.el.style.overflow="hidden",this.selectCategory(e,t),this.el.style.overflow="auto"}createCategory(e){const t=Ke[e.key]||Be;return this.viewFactory.create(t,{category:e,showVariants:!0,lazyLoader:this.lazyLoader,emojiVersion:this.emojiVersion,provider:this.options.recentsProvider})}determineInitialCategory(){var e;return this.options.initialCategory&&this.categories.find((e=>e.key===this.options.initialCategory))?this.options.initialCategory:null==(e=this.categories.find((e=>"recents"!==e.key)))?void 0:e.key}determineFocusTarget(e){const t=this.emojiCategories.find((t=>t.category.key===e));return this.options.initialEmoji&&(null==t?void 0:t.el.querySelector(`[data-emoji="${this.options.initialEmoji}"]`))?this.options.initialEmoji:"button"}reset(e=!0){this.events.emit("preview:hide");const t=this.determineInitialCategory();t&&(this.selectCategory(t,{focus:this.determineFocusTarget(t),performFocus:e,scroll:"jump"}),this.selectedCategory=this.getCategoryIndex(t))}getCategoryIndex(e){return this.categories.findIndex((t=>t.key===e))}focusPreviousCategory(e){this.selectedCategory>0&&this.focusCategory(this.selectedCategory-1,{row:"last",offset:null!=e?e:this.options.emojisPerRow})}focusNextCategory(e){this.selectedCategory<this.categories.length-1&&this.focusCategory(this.selectedCategory+1,{row:"first",offset:null!=e?e:0})}focusCategory(e,t){this.selectCategory(e,{focus:t,performFocus:!0})}async selectCategory(e,t={}){var i;this.scrollListenerState="suspend";const{focus:r,performFocus:n,scroll:s}={performFocus:!1,...t};this.emojiCategories[this.selectedCategory].setActive(!1);const o=this.selectedCategory="number"==typeof e?e:this.getCategoryIndex(e);null==(i=this.categoryTabs)||i.setActiveTab(this.selectedCategory,{performFocus:n,scroll:"button"===r});const a=this.emojiCategories[o].el.offsetTop;var l;this.emojiCategories[o].setActive(!0,(l=r)&&"button"!==l?l:{row:"first",offset:0},"button"!==r&&n),s&&(this.el.scrollTop=a),this.scrollListenerState="resume"}updateFocusedCategory(e){var t;this.categories[this.selectedCategory].key!==e&&(this.scrollListenerState="suspend",this.selectedCategory=this.getCategoryIndex(e),null==(t=this.categoryTabs)||t.setActiveTab(this.selectedCategory,{changeFocusable:!1,performFocus:!1}),this.scrollListenerState="resume")}handleScroll(){if("suspend"===this.scrollListenerState||!this.categoryTabs)return;if("resume"===this.scrollListenerState)return void(this.scrollListenerState="active");const e=this.el.scrollTop,t=this.el.scrollHeight-this.el.offsetHeight,i=this.emojiCategories.findIndex(((t,i)=>{var r;return e<(null==(r=this.emojiCategories[i+1])?void 0:r.el.offsetTop)})),r={changeFocusable:!1,performFocus:!1,scroll:!1};0===e?this.categoryTabs.setActiveTab(0,r):Math.floor(e)===Math.floor(t)||i<0?this.categoryTabs.setActiveTab(this.categories.length-1,r):this.categoryTabs.setActiveTab(i,r)}}const We=new te((({classList:e,classes:t,icon:i,message:r})=>`\n<div class="${e}" role="alert">\n  <div class="${t.iconContainer}"><i data-size="10x" data-icon="${i}"></i></div>\n  <h3 class="${t.title}">${r}</h3>\n</div>\n`)),Ye=b("error","iconContainer","title");class Xe extends ${constructor({message:e,icon:t="warning",template:i=We,className:r}){super({template:i,classes:Ye}),this.message=e,this.icon=t,this.className=r}renderSync(){const e=[Ye.error,this.className].join(" ").trim();return super.renderSync({message:this.message,icon:this.icon,classList:e})}}const Qe=new te((({classList:e,classes:t,icon:i,i18n:r,message:n})=>`\n  <div class="${e}" role="alert">\n    <div class="${t.icon}"><i data-size="10x" data-icon="${i}"></i></div>\n    <h3 class="${t.title}">${n}</h3>\n    <button type="button">${r.get("retry")}</button>\n  </div>\n`)),Je=b("dataError");class Ze extends Xe{constructor({message:e}){super({message:e,template:Qe,className:Je.dataError})}initialize(){this.uiElements={retryButton:"button"},this.uiEvents=[$.childEvent("retryButton","click",this.onRetry)],super.initialize()}async onRetry(){this.emojiData?await this.emojiData.delete():await this.options.dataStore.deleteDatabase(this.options.locale),this.events.emit("reinitialize");const e=await N(this.options.locale,this.options.dataStore,this.options.messages,this.options.emojiData,this.emojiData);this.viewFactory.setEmojiData(e),this.events.emit("data:ready",e)}}const et=b("preview","previewEmoji","previewName","tagList","tag"),tt=new te((({classes:e,tag:t})=>`\n  <li class="${e.tag}">${t}</li>\n`)),it=new te((({classes:e})=>`\n  <div class="${e.preview}">\n    <div class="${e.previewEmoji}"></div>\n    <div class="${e.previewName}"></div>\n    <ul class="${e.tagList}"></ul>\n  </div>\n`));class rt extends ${constructor(){super({template:it,classes:et})}initialize(){this.uiElements={emoji:$.byClass(et.previewEmoji),name:$.byClass(et.previewName),tagList:$.byClass(et.tagList)},this.appEvents={"preview:show":this.showPreview,"preview:hide":this.hidePreview},super.initialize()}showPreview(e,t){if(E(this.ui.emoji,t),this.ui.name.textContent=e.label,e.tags){this.ui.tagList.style.display="flex";const t=e.tags.map((e=>tt.renderSync({tag:e,classes:et})));E(this.ui.tagList,...t)}}hidePreview(){_(this.ui.emoji),_(this.ui.name),_(this.ui.tagList)}}const nt=new te((({classes:e,i18n:t})=>`\n  <button title="${t.get("search.clear")}" class="${e.clearSearchButton}">\n    <i data-icon="xmark"></i>\n  </button>\n`)),st=new te((({classes:e,i18n:t})=>`\n<div class="${e.searchContainer}">\n  <input class="${e.searchField}" placeholder="${t.get("search")}">\n  <span class="${e.searchAccessory}"></span>\n</div>\n`),{mode:"async"}),ot=b("searchContainer","searchField","clearButton","searchAccessory","clearSearchButton","notFound");class at extends ${constructor({categories:e,emojiVersion:t}){super({template:st,classes:ot}),this.categories=e.filter((e=>"recents"!==e.key)),this.emojiVersion=t,this.search=function(e,t){let i=null;return(...r)=>{i&&window.clearTimeout(i),i=window.setTimeout((()=>{e(...r),i=null}),t)}}(this.search.bind(this),100)}initialize(){this.uiElements={searchField:$.byClass(ot.searchField),searchAccessory:$.byClass(ot.searchAccessory)},this.uiEvents=[$.childEvent("searchField","keydown",this.onKeyDown),$.childEvent("searchField","input",this.onSearchInput)],super.initialize()}async render(){return await super.render(),this.searchIcon=G("search"),this.notFoundMessage=this.viewFactory.create(Xe,{message:this.i18n.get("search.notFound"),className:ot.notFound,icon:"sad"}),this.notFoundMessage.renderSync(),this.errorMessage=this.viewFactory.create(Xe,{message:this.i18n.get("search.error")}),this.errorMessage.renderSync(),this.clearSearchButton=nt.render({classes:ot,i18n:this.i18n}),this.clearSearchButton.addEventListener("click",(e=>this.onClearSearch(e))),this.searchField=this.ui.searchField,this.showSearchIcon(),this.el}showSearchIcon(){this.showSearchAccessory(this.searchIcon)}showClearSearchButton(){this.showSearchAccessory(this.clearSearchButton)}showSearchAccessory(e){E(this.ui.searchAccessory,e)}clear(){this.searchField.value="",this.showSearchIcon()}focus(){this.searchField.focus()}onClearSearch(e){var t;e.stopPropagation(),this.searchField.value="",null==(t=this.resultsContainer)||t.destroy(),this.resultsContainer=null,this.showSearchIcon(),this.events.emit("content:show"),this.searchField.focus()}handleResultsKeydown(e){this.resultsContainer&&"Escape"===e.key&&this.onClearSearch(e)}onKeyDown(e){var t;"Escape"===e.key&&this.searchField.value?this.onClearSearch(e):("Enter"===e.key||"ArrowDown"===e.key)&&this.resultsContainer&&(e.preventDefault(),null==(t=this.resultsContainer.el.querySelector('[tabindex="0"]'))||t.focus())}onSearchInput(e){this.searchField.value?(this.showClearSearchButton(),this.search()):this.onClearSearch(e)}async search(){var e;if(this.searchField.value)try{const t=await this.emojiData.searchEmojis(this.searchField.value,this.customEmojis,this.emojiVersion,this.categories);if(this.events.emit("preview:hide"),t.length){const i=new He;this.resultsContainer=this.viewFactory.create(Ne,{emojis:t,fullHeight:!0,showVariants:!0,lazyLoader:i}),this.resultsContainer.renderSync(),null!=(e=this.resultsContainer)&&e.el&&(i.observe(this.resultsContainer.el),this.resultsContainer.setActive(!0,{row:0,offset:0},!1),this.resultsContainer.el.addEventListener("keydown",(e=>this.handleResultsKeydown(e))),this.events.emit("content:show",this.resultsContainer))}else this.events.emit("content:show",this.notFoundMessage)}catch{this.events.emit("content:show",this.errorMessage)}}}const lt=new te((({classes:e})=>`\n  <div class="${e.variantOverlay}">\n    <div class="${e.variantPopup}">\n      <div data-view="emojis" data-render="sync"></div>\n    </div>\n  </div>\n`)),ct=b("variantOverlay","variantPopup"),ut={easing:"ease-in-out",duration:250,fill:"both"},dt={opacity:[0,1]},ht={opacity:[0,1],transform:["scale3d(0.8, 0.8, 0.8)","scale3d(1, 1, 1)"]};class pt extends ${constructor({emoji:e,parent:t}){super({template:lt,classes:ct,parent:t}),this.focusedEmojiIndex=0,this.focusTrap=new j,this.animateShow=()=>Promise.all([y(this.el,dt,ut,this.options),y(this.ui.popup,ht,ut,this.options)]),this.emoji=e}initialize(){this.uiElements={popup:$.byClass(ct.variantPopup)},this.uiEvents=[$.uiEvent("click",this.handleClick),$.uiEvent("keydown",this.handleKeydown)],super.initialize()}animateHide(){const e={...ut,direction:"reverse"};return Promise.all([y(this.el,dt,e,this.options),y(this.ui.popup,ht,e,this.options)])}async hide(){await this.animateHide(),this.events.emit("variantPopup:hide")}handleKeydown(e){"Escape"===e.key&&(this.hide(),e.stopPropagation())}handleClick(e){this.ui.popup.contains(e.target)||this.hide()}getEmoji(e){return this.renderedEmojis[e]}setFocusedEmoji(e){this.getEmoji(this.focusedEmojiIndex).tabIndex=-1,this.focusedEmojiIndex=e;const t=this.getEmoji(this.focusedEmojiIndex);t.tabIndex=0,t.focus()}destroy(){this.emojiContainer.destroy(),this.focusTrap.deactivate(),super.destroy()}renderSync(){const e=[{...this.emoji,skins:null},...(this.emoji.skins||[]).map((e=>({...e,label:this.emoji.label,tags:this.emoji.tags})))];return this.emojiContainer=this.viewFactory.create(Ne,{emojis:e,preview:!1}),super.renderSync({emojis:this.emojiContainer}),e.length<this.options.emojisPerRow&&this.el.style.setProperty("--emojis-per-row",e.length.toString()),this.el}activate(){this.emojiContainer.setActive(!0,{row:0,offset:0},!0),this.focusTrap.activate(this.el)}}const ft=new te((({classes:e,i18n:t,category:i,pickerId:r,icon:n})=>`\n<li class="${e.categoryTab}">\n  <button\n    aria-selected="false"\n    role="tab"\n    class="${e.categoryButton}"\n    tabindex="-1"\n    title="${t.get(`categories.${i.key}`,i.message||i.key)}"\n    type="button"\n    data-category="${i.key}"\n    id="${r}-category-${i.key}"\n  >\n    <i data-icon="${n}"></i>\n</li>\n`)),mt=b("categoryTab","categoryTabActive","categoryButton");class gt extends ${constructor({category:e,icon:t}){super({template:ft,classes:mt}),this.isActive=!1,this.category=e,this.icon=t}initialize(){this.uiElements={button:$.byClass(mt.categoryButton)},this.uiEvents=[$.childEvent("button","click",this.selectCategory),$.childEvent("button","focus",this.selectCategory)],super.initialize()}renderSync(){return super.renderSync({category:this.category,icon:this.icon}),this.ui.button.ariaSelected="false",this.el}setActive(e,t={}){const{changeFocusable:i,performFocus:r,scroll:n}={changeFocusable:!0,performFocus:!0,scroll:!0,...t};this.el.classList.toggle(mt.categoryTabActive,e),i&&(this.ui.button.tabIndex=e?0:-1,this.ui.button.ariaSelected=e.toString()),e&&r&&(this.ui.button.focus(),n&&this.events.emit("category:select",this.category.key,{scroll:"animate",focus:"button",performFocus:!1})),this.isActive=e}selectCategory(){this.isActive||this.events.emit("category:select",this.category.key,{scroll:"animate",focus:"button",performFocus:!0})}}const yt=new te((({classes:e})=>`\n  <div class="${e.categoryButtonsContainer}">\n    <ul role="tablist" class="${e.categoryButtons}">\n      <div data-placeholder="tabs"></div>\n    </ul>\n  </div>\n`)),vt=b("categoryButtons","categoryButtonsContainer");class bt extends ${constructor({categories:e}){super({template:yt,classes:vt}),this.activeCategoryIndex=0,this.categories=e}initialize(){this.keyBindings={ArrowLeft:this.stepSelectedTab(-1),ArrowRight:this.stepSelectedTab(1)},this.uiEvents=[$.uiEvent("scroll",this.checkOverflow)],super.initialize()}checkOverflow(){const e=Math.abs(this.el.scrollLeft-(this.el.scrollWidth-this.el.offsetWidth))>1,t=this.el.scrollLeft>0;this.el.className="categoryButtonsContainer",t&&e?this.el.classList.add("has-overflow-both"):t?this.el.classList.add("has-overflow-left"):e&&this.el.classList.add("has-overflow-right")}renderSync(){return this.tabViews=this.categories.map((e=>this.viewFactory.create(gt,{category:e,icon:V[e.key]}))),super.renderSync({tabs:this.tabViews.map((e=>e.renderSync()))}),this.el}get currentCategory(){return this.categories[this.activeCategoryIndex]}get currentTabView(){return this.tabViews[this.activeCategoryIndex]}setActiveTab(e,t={}){this.checkOverflow();const i=this.currentTabView,r=this.tabViews[e];i.setActive(!1,t),r.setActive(!0,t),this.activeCategoryIndex=e}getTargetCategory(e){return e<0?this.categories.length-1:e>=this.categories.length?0:e}stepSelectedTab(e){return()=>{const t=this.activeCategoryIndex+e;this.setActiveTab(this.getTargetCategory(t),{changeFocusable:!0,performFocus:!0})}}}const wt=[{version:15,emoji:String.fromCodePoint(129768)},{version:14,emoji:String.fromCodePoint(128733)},{version:13,emoji:String.fromCodePoint(129729)},{version:12,emoji:String.fromCodePoint(129449)},{version:11,emoji:String.fromCodePoint(129463)},{version:5,emoji:String.fromCodePoint(129322)},{version:4,emoji:String.fromCodePoint(9877)},{version:3,emoji:String.fromCodePoint(129314)},{version:2,emoji:String.fromCodePoint(128488)},{version:1,emoji:String.fromCodePoint(128512)}];function _t(){var e;const t=wt.find((e=>function(e){const t=document.createElement("canvas").getContext("2d");if(t)return t.textBaseline="top",t.font="32px Arial",t.fillText(e,0,0),0!==t.getImageData(16,16,1,1).data[0]}(e.emoji)));return null!=(e=null==t?void 0:t.version)?e:1}function Et(e,t){return Array.from({length:e},(()=>t)).join("")}function Tt(e){const{emojiCount:t,classes:i,theme:r,className:n,categoryCount:s}=e;return`\n    <div class="picmo__picker ${i.skeleton} ${i.picker} ${r} ${n}">\n      ${(({showHeader:t,classes:i})=>t?`\n    <header class="${i.headerSkeleton}">\n      ${(({showSearch:e,classes:t})=>e?`\n    <div class="${t.searchSkeleton}">\n      <div class="${t.searchInput} ${t.placeholder}"></div>\n    </div>\n  `:"")(e)}\n      ${(({showCategoryTabs:e,classes:t})=>e?`\n    <div class="${t.categoryTabsSkeleton}">\n      ${Et(s,`<div class="${t.placeholder} ${t.categoryTab}"></div>`)}\n    </div>\n  `:"")(e)}\n    </header>\n  `:"")(e)}\n      <div class="${i.contentSkeleton}">\n        <div class="${i.placeholder} ${i.categoryName}"></div>\n        <div class="${i.emojiGrid}">\n          ${Et(t,`<div class="${i.placeholder} ${i.emoji}"></div>`)}\n        </div>\n      </div>\n      ${(({showPreview:e,classes:t})=>e?`\n    <div class="${t.previewSkeleton}">\n      <div class="${t.placeholder} ${t.previewEmoji}"></div>\n      <div class="${t.placeholder} ${t.previewName}"></div>\n      <ul class="${t.tagList}">\n        ${Et(3,`<li class="${t.placeholder} ${t.tag}"></li>`)}\n      </ul>\n    </div>\n  `:"")(e)}\n    </div>\n  `}const St=new te((e=>e.isLoaded?function(e){const{classes:t,theme:i,className:r=""}=e;return`\n    <div class="picmo__picker ${t.picker} ${i} ${r}">\n      ${function({showHeader:e,classes:t}){return e?`\n    <header class="${t.header}">\n      <div data-view="search"></div>\n      <div data-view="categoryTabs" data-render="sync"></div>\n    </header>\n  `:""}(e)}\n      <div class="${t.content}">\n        <div data-view="emojiArea"></div>\n      </div>\n      <div data-view="preview"></div>\n    </div>\n  `}(e):Tt(e))),kt=b("picker","skeleton","placeholder","searchSkeleton","searchInput","categoryTabsSkeleton","headerSkeleton","categoryTab","contentSkeleton","categoryName","emojiGrid","emoji","previewSkeleton","previewEmoji","previewName","tagList","tag","overlay","content","fullHeight","pluginContainer","header"),xt={emojisPerRow:"--emojis-per-row",visibleRows:"--row-count",emojiSize:"--emoji-size"};class Ct extends ${constructor(){super({template:St,classes:kt}),this.pickerReady=!1,this.externalEvents=new Ae,this.updaters={styleProperty:e=>t=>this.el.style.setProperty(xt[e],t.toString()),theme:e=>{const t=this.options.theme,i=this.el.closest(`.${t}`);this.el.classList.remove(t),null==i||i.classList.remove(t),this.el.classList.add(e),null==i||i.classList.add(e)},className:e=>{this.options.className&&this.el.classList.remove(this.options.className),this.el.classList.add(e)},emojisPerRow:this.updateStyleProperty.bind(this,"emojisPerRow"),emojiSize:this.updateStyleProperty.bind(this,"emojiSize"),visibleRows:this.updateStyleProperty.bind(this,"visibleRows")}}initialize(){this.uiElements={pickerContent:$.byClass(kt.content),header:$.byClass(kt.header)},this.uiEvents=[$.uiEvent("keydown",this.handleKeyDown)],this.appEvents={error:this.onError,reinitialize:this.reinitialize,"data:ready":this.onDataReady,"content:show":this.showContent,"variantPopup:hide":this.hideVariantPopup,"emoji:select":this.selectEmoji},super.initialize(),this.options.recentsProvider}destroy(){var e,t;super.destroy(),null==(e=this.search)||e.destroy(),this.emojiArea.destroy(),null==(t=this.categoryTabs)||t.destroy(),this.events.removeAll(),this.externalEvents.removeAll()}clearRecents(){this.options.recentsProvider.clear()}addEventListener(e,t){this.externalEvents.on(e,t)}removeEventListener(e,t){this.externalEvents.off(e,t)}initializePickerView(){this.pickerReady&&(this.showContent(),this.emojiArea.reset(!1))}handleKeyDown(e){const t=e.ctrlKey||e.metaKey;"s"===e.key&&t&&this.search&&(e.preventDefault(),this.search.focus())}buildChildViews(){return this.options.showPreview&&(this.preview=this.viewFactory.create(rt)),this.options.showSearch&&(this.search=this.viewFactory.create(at,{categories:this.categories,emojiVersion:this.emojiVersion})),this.options.showCategoryTabs&&(this.categoryTabs=this.viewFactory.create(bt,{categories:this.categories})),this.currentView=this.emojiArea=this.viewFactory.create(qe,{categoryTabs:this.categoryTabs,categories:this.categories,emojiVersion:this.emojiVersion}),[this.preview,this.search,this.emojiArea,this.categoryTabs]}setStyleProperties(){this.options.showSearch||this.el.style.setProperty("--search-height-full","0px"),this.options.showCategoryTabs||(this.el.style.setProperty("--category-tabs-height","0px"),this.el.style.setProperty("--category-tabs-offset","0px")),this.options.showPreview||this.el.style.setProperty("--emoji-preview-height-full","0px"),Object.keys(xt).forEach((e=>{this.options[e]&&this.el.style.setProperty(xt[e],this.options[e].toString())}))}updateStyleProperty(e,t){this.el.style.setProperty(xt[e],t.toString())}reinitialize(){this.renderSync()}onError(e){const t=this.viewFactory.createWithOptions({data:!1},Ze,{message:this.i18n.get("error.load")}),i=this.el.offsetHeight||375;throw this.el.style.height=`${i}px`,E(this.el,t.renderSync()),e}async onDataReady(e){const t=this.el;try{e?this.emojiData=e:await this.emojiDataPromise,"auto"===this.options.emojiVersion?this.emojiVersion=_t()||parseFloat("14.0"):this.emojiVersion=this.options.emojiVersion,this.categories=await this.emojiData.getCategories(this.options);const[i,r,n,s]=this.buildChildViews();await super.render({isLoaded:!0,search:r,categoryTabs:s,emojiArea:n,preview:i,showHeader:Boolean(this.search||this.categoryTabs),theme:this.options.theme,className:this.options.className}),this.el.style.setProperty("--category-count",this.categories.length.toString()),this.pickerReady=!0,t.replaceWith(this.el),this.setStyleProperties(),this.initializePickerView(),this.setInitialFocus(),this.externalEvents.emit("data:ready")}catch(e){this.events.emit("error",e)}}renderSync(){var e;let t=(null==(e=this.options.categories)?void 0:e.length)||10;if(this.options.showRecents&&(t+=1),super.renderSync({isLoaded:!1,theme:this.options.theme,className:this.options.className,showSearch:this.options.showSearch,showPreview:this.options.showPreview,showCategoryTabs:this.options.showCategoryTabs,showHeader:this.options.showSearch||this.options.showCategoryTabs,emojiCount:this.options.emojisPerRow*this.options.visibleRows,categoryCount:t}),this.el.style.setProperty("--category-count",t.toString()),!this.options.rootElement)throw new Error("Picker must be given a root element via the rootElement option");return E(this.options.rootElement,this.el),this.setStyleProperties(),this.pickerReady&&this.initializePickerView(),this.el}getInitialFocusTarget(){if(typeof this.options.autoFocus<"u")switch(this.options.autoFocus){case"emojis":return this.emojiArea.focusableEmoji;case"search":return this.search;case"auto":return this.search||this.emojiArea.focusableEmoji;default:return null}if(!0===this.options.autoFocusSearch)return console.warn("options.autoFocusSearch is deprecated, please use options.focusTarget instead"),this.search}setInitialFocus(){var e;!this.pickerReady||null==(e=this.getInitialFocusTarget())||e.focus()}reset(e=!0){var t;this.pickerReady&&(this.emojiArea.reset(e),this.showContent(this.emojiArea)),null==(t=this.search)||t.clear(),this.hideVariantPopup()}showContent(e=this.emojiArea){var t,i;e!==this.currentView&&(this.currentView!==this.emojiArea&&(null==(t=this.currentView)||t.destroy()),this.ui.pickerContent.classList.toggle(kt.fullHeight,e!==this.emojiArea),E(this.ui.pickerContent,e.el),this.currentView=e,e===this.emojiArea?(this.emojiArea.reset(),this.categoryTabs&&this.ui.header.appendChild(this.categoryTabs.el)):null==(i=this.categoryTabs)||i.el.remove())}hideVariantPopup(){var e;null==(e=this.variantPopup)||e.destroy()}isPickerClick(e){var t,i;const r=e.target,n=this.el.contains(r),s=null==(i=null==(t=this.variantPopup)?void 0:t.el)?void 0:i.contains(r);return n||s}async selectEmoji({emoji:e}){var t,i;(null==(t=e.skins)?void 0:t.length)&&this.options.showVariants&&!this.isVariantPopupOpen?this.showVariantPopup(e):(await(null==(i=this.variantPopup)?void 0:i.animateHide()),this.events.emit("variantPopup:hide"),await this.emitEmoji(e))}get isVariantPopupOpen(){return this.variantPopup&&!this.variantPopup.isDestroyed}async showVariantPopup(e){const t=document.activeElement;this.events.once("variantPopup:hide",(()=>{null==t||t.focus()})),this.variantPopup=this.viewFactory.create(pt,{emoji:e,parent:this.el}),this.el.appendChild(this.variantPopup.renderSync()),this.variantPopup.activate()}async emitEmoji(e){this.externalEvents.emit("emoji:select",await this.renderer.doEmit(e)),this.options.recentsProvider.addOrUpdateRecent(e,this.options.maxRecents),this.events.emit("recent:add",e)}updateOptions(e){Object.keys(e).forEach((t=>{this.updaters[t](e[t])})),Object.assign(this.options,e)}}class At{constructor({events:e,i18n:t,renderer:i,emojiData:r,options:n,customEmojis:s=[],pickerId:o}){this.events=e,this.i18n=t,this.renderer=i,this.emojiData=r,this.options=n,this.customEmojis=s,this.pickerId=o}setEmojiData(e){this.emojiData=Promise.resolve(e)}createWithOptions(e={},t,...i){const r=new t(...i);return r.setPickerId(this.pickerId),r.setEvents(this.events),r.setI18n(this.i18n),r.setRenderer(this.renderer),!1!==e.data&&r.setEmojiData(this.emojiData),r.setOptions(this.options),r.setCustomEmojis(this.customEmojis),r.viewFactory=this,r.initialize(),r}create(e,...t){return this.createWithOptions({},e,...t)}}var Rt;class Lt{constructor(e={}){s(this,Rt,void 0),o(this,Rt,new Map(Object.entries(e)))}get(e,t=e){return n(this,Rt).get(e)||t}}function Pt(){let e=!1;return function(t){xe.injectStyles&&!e&&(function(e,t){void 0===t&&(t={});var i=t.insertAt;if(e&&!(typeof document>"u")){var r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===i&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}(t),e=!0)}}Rt=new WeakMap;const Ot='.picmo__picker .picmo__icon{width:1.25em;height:1em;fill:currentColor}.picmo__icon-small{font-size:.8em}.picmo__icon-medium{font-size:1em}.picmo__icon-large{font-size:1.25em}.picmo__icon-2x{font-size:2em}.picmo__icon-3x{font-size:3em}.picmo__icon-4x{font-size:4em}.picmo__icon-5x{font-size:5em}.picmo__icon-8x{font-size:8em}.picmo__icon-10x{font-size:10em}.picmo__light,.picmo__auto{color-scheme:light;--accent-color: #4f46e5;--background-color: #f9fafb;--border-color: #cccccc;--category-name-background-color: #f9fafb;--category-name-button-color: #999999;--category-name-text-color: hsl(214, 30%, 50%);--category-tab-active-background-color: rgba(255, 255, 255, .6);--category-tab-active-color: var(--accent-color);--category-tab-color: #666;--category-tab-highlight-background-color: rgba(0, 0, 0, .15);--error-color-dark: hsl(0, 100%, 45%);--error-color: hsl(0, 100%, 40%);--focus-indicator-background-color: hsl(198, 65%, 85%);--focus-indicator-color: #333333;--hover-background-color: #c7d2fe;--placeholder-background-color: #cccccc;--search-background-color: #f9fafb;--search-focus-background-color: #ffffff;--search-icon-color: #999999;--search-placeholder-color: #71717a;--secondary-background-color: #e2e8f0;--secondary-text-color: #666666;--tag-background-color: rgba(162, 190, 245, .3);--text-color: #000000;--variant-popup-background-color: #ffffff}.picmo__dark{color-scheme:dark;--accent-color: #A580F9;--background-color: #333333;--border-color: #666666;--category-name-background-color: #333333;--category-name-button-color: #eeeeee;--category-name-text-color: #ffffff;--category-tab-active-background-color: #000000;--category-tab-active-color: var(--accent-color);--category-tab-color: #cccccc;--category-tab-highlight-background-color: #4A4A4A;--error-color-dark: hsl(0, 7%, 3%);--error-color: hsl(0, 30%, 60%);--focus-indicator-background-color: hsl(0, 0%, 50%);--focus-indicator-color: #999999;--hover-background-color: hsla(0, 0%, 40%, .85);--image-placeholder-color: #ffffff;--placeholder-background-color: #666666;--search-background-color: #71717a;--search-focus-background-color: #52525b;--search-icon-color: #cccccc;--search-placeholder-color: #d4d4d8;--secondary-background-color: #000000;--secondary-text-color: #999999;--tag-background-color: rgba(162, 190, 245, .3);--text-color: #ffffff;--variant-popup-background-color: #333333}@media (prefers-color-scheme: dark){.picmo__auto{color-scheme:dark;--accent-color: #A580F9;--background-color: #333333;--border-color: #666666;--category-name-background-color: #333333;--category-name-button-color: #eeeeee;--category-name-text-color: #ffffff;--category-tab-active-background-color: #000000;--category-tab-active-color: var(--accent-color);--category-tab-color: #cccccc;--category-tab-highlight-background-color: #4A4A4A;--error-color-dark: hsl(0, 7%, 3%);--error-color: hsl(0, 30%, 60%);--focus-indicator-background-color: hsl(0, 0%, 50%);--focus-indicator-color: #999999;--hover-background-color: hsla(0, 0%, 40%, .85);--image-placeholder-color: #ffffff;--placeholder-background-color: #666666;--search-background-color: #71717a;--search-focus-background-color: #52525b;--search-icon-color: #cccccc;--search-placeholder-color: #d4d4d8;--secondary-background-color: #000000;--secondary-text-color: #999999;--tag-background-color: rgba(162, 190, 245, .3);--text-color: #ffffff;--variant-popup-background-color: #333333}}.picmo__picker .picmo__categoryButtonsContainer{overflow:auto;padding:2px 0}.picmo__picker .picmo__categoryButtonsContainer.picmo__has-overflow-right{mask-image:linear-gradient(270deg,rgba(255,255,255,0) 0%,rgba(255,255,255,1) 10%);-webkit-mask-image:linear-gradient(270deg,rgba(255,255,255,0) 0%,rgba(255,255,255,1) 10%)}.picmo__picker .picmo__categoryButtonsContainer.picmo__has-overflow-left{mask-image:linear-gradient(90deg,rgba(255,255,255,0) 0%,rgba(255,255,255,1) 10%);-webkit-mask-image:linear-gradient(90deg,rgba(255,255,255,0) 0%,rgba(255,255,255,1) 10%)}.picmo__picker .picmo__categoryButtonsContainer.picmo__has-overflow-both{mask-image:linear-gradient(90deg,rgba(255,255,255,0) 0%,rgba(255,255,255,1) 10%,rgba(255,255,255,1) 90%,rgba(255,255,255,0) 100%);-webkit-mask-image:linear-gradient(90deg,rgba(255,255,255,0) 0%,rgba(255,255,255,1) 10%,rgba(255,255,255,1) 90%,rgba(255,255,255,0) 100%)}.picmo__picker .picmo__categoryButtons{display:flex;flex-direction:row;gap:var(--tab-gap);margin:0;padding:0 .5em;align-items:center;height:var(--category-tabs-height);box-sizing:border-box;width:100%;justify-content:space-between;position:relative;list-style-type:none;justify-self:center;max-width:min(23.55rem,calc(var(--category-count, 1) * 2.5rem))}.picmo__picker .picmo__categoryButtons .picmo__categoryTab{display:flex;align-items:center;transition:all .1s;width:2em}.picmo__picker .picmo__categoryButtons .picmo__categoryTab.picmo__categoryTabActive .picmo__categoryButton{color:var(--category-tab-active-color);background:linear-gradient(rgba(255,255,255,.75) 0%,rgba(255,255,255,.75) 100%),linear-gradient(var(--category-tab-active-color) 0%,var(--category-tab-active-color) 100%);border:2px solid var(--category-tab-active-color)}.picmo__picker .picmo__categoryButtons .picmo__categoryTab.picmo__categoryTabActive .picmo__categoryButton:hover{background-color:var(--category-tab-active-background-color)}.picmo__picker .picmo__categoryButtons .picmo__categoryTab button.picmo__categoryButton{border-radius:5px;background:transparent;border:2px solid transparent;color:var(--category-tab-color);cursor:pointer;padding:2px;vertical-align:middle;display:flex;align-items:center;justify-content:center;font-size:1.2rem;width:1.6em;height:1.6em;transition:all .1s}.picmo__picker .picmo__categoryButtons .picmo__categoryTab button.picmo__categoryButton:is(img){width:var(--category-tab-size);height:var(--category-tab-size)}.picmo__picker .picmo__categoryButtons .picmo__categoryTab button.picmo__categoryButton:hover{background:var(--category-tab-highlight-background-color)}.picmo__dataError [data-icon]{opacity:.8}@keyframes appear{0%{opacity:0}to{opacity:.8}}@keyframes appear-grow{0%{opacity:0;transform:scale(.8)}to{opacity:.8;transform:scale(1)}}.picmo__picker .picmo__error{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;color:var(--secondary-text-color)}.picmo__picker .picmo__error .picmo__iconContainer{opacity:.8;animation:appear-grow .25s cubic-bezier(.175,.885,.32,1.275);--color-primary: var(--error-color);--color-secondary: var(--error-color-dark)}.picmo__picker .picmo__error .picmo__title{animation:appear .25s;animation-delay:50ms;animation-fill-mode:both}.picmo__picker .picmo__error button{padding:8px 16px;cursor:pointer;background:var(--background-color);border:1px solid var(--text-color);border-radius:5px;color:var(--text-color)}.picmo__picker .picmo__error button:hover{background:var(--text-color);color:var(--background-color)}.picmo__emojiButton{background:transparent;border:none;border-radius:15px;cursor:pointer;display:flex;font-family:var(--emoji-font);font-size:var(--emoji-size);height:100%;justify-content:center;align-items:center;margin:0;overflow:hidden;padding:0;width:100%}.picmo__emojiButton:hover{background:var(--hover-background-color)}.picmo__emojiButton:focus{border-radius:0;background:var(--focus-indicator-background-color);outline:1px solid var(--focus-indicator-color)}.picmo__picker .picmo__emojiArea{height:var(--emoji-area-height);overflow-y:auto;position:relative}.picmo__picker .picmo__emojiCategory{position:relative}.picmo__picker .picmo__emojiCategory .picmo__categoryName{font-size:.9em;padding:.5rem;margin:0;background:var(--category-name-background-color);color:var(--category-name-text-color);top:0;z-index:1;display:grid;gap:4px;grid-template-columns:auto 1fr auto;align-items:center;line-height:1;box-sizing:border-box;height:var(--category-name-height);justify-content:flex-start;text-transform:uppercase}.picmo__picker .picmo__emojiCategory .picmo__categoryName button{background:transparent;border:none;display:flex;align-items:center;cursor:pointer;color:var(--category-name-button-color)}.picmo__picker .picmo__emojiCategory .picmo__categoryName button:hover{opacity:1}.picmo__picker .picmo__emojiCategory .picmo__noRecents{color:var(--secondary-text-color);grid-column:1 / span var(--emojis-per-row);font-size:.9em;text-align:center;display:flex;align-items:center;justify-content:center;min-height:calc(var(--emoji-size) * var(--emoji-size-multiplier))}.picmo__picker .picmo__emojiCategory .picmo__recentEmojis[data-empty=true]{display:none}:is(.picmo__picker .picmo__emojiCategory) .picmo__recentEmojis[data-empty=false]+div{display:none}.picmo__picker .picmo__emojiContainer{display:grid;justify-content:space-between;gap:1px;padding:0 .5em;grid-template-columns:repeat(var(--emojis-per-row),calc(var(--emoji-size) * var(--emoji-size-multiplier)));grid-auto-rows:calc(var(--emoji-size) * var(--emoji-size-multiplier));align-items:center;justify-items:center}.picmo__picker.picmo__picker{--border-radius: 5px;--emoji-area-height: calc( (var(--row-count) * var(--emoji-size) * var(--emoji-size-multiplier)) + var(--category-name-height) );--content-height: var(--emoji-area-height);--emojis-per-row: 8;--row-count: 6;--emoji-preview-margin: 4px;--emoji-preview-height: calc(var(--emoji-preview-size) + 1em + 1px);--emoji-preview-height-full: calc(var(--emoji-preview-height) + var(--emoji-preview-margin));--emoji-preview-size: 2.75em;--emoji-size: 2rem;--emoji-size-multiplier: 1.3;--content-margin: 8px;--category-tabs-height:calc(1.5em + 9px);--category-tabs-offset: 8px;--category-tab-size: 1.2rem;--category-name-height: 2rem;--category-name-padding-y: 6px;--search-height: 2em;--search-margin: .5em;--search-margin-bottom: 4px;--search-height-full: calc(var(--search-height) + var(--search-margin) + var(--search-margin-bottom));--overlay-background-color: rgba(0, 0, 0, .8);--emoji-font: "Segoe UI Emoji", "Segoe UI Symbol", "Segoe UI", "Apple Color Emoji", "Twemoji Mozilla", "Noto Color Emoji", "EmojiOne Color", "Android Emoji";--ui-font: -apple-system, BlinkMacSystemFont, "Helvetica Neue", sans-serif;--ui-font-size: 16px;--picker-width: calc(var(--emojis-per-row) * var(--emoji-size) * var(--emoji-size-multiplier) + 2.75rem);--preview-background-color: var(--secondary-background-color);background:var(--background-color);border-radius:var(--border-radius);border:1px solid var(--border-color);font-family:var(--ui-font);font-size:var(--ui-font-size);overflow:hidden;position:relative;width:var(--picker-width);display:grid;gap:8px}.picmo__picker.picmo__picker>*{font-family:var(--ui-font)}.picmo__picker.picmo__skeleton{background:var(--background-color);border-radius:var(--border-radius);border:1px solid var(--border-color);font-family:var(--ui-font);width:var(--picker-width);color:var(--secondary-text-color)}.picmo__picker.picmo__skeleton *{box-sizing:border-box}.picmo__picker.picmo__skeleton .picmo__placeholder{background:var(--placeholder-background-color);position:relative;overflow:hidden}.picmo__picker.picmo__skeleton .picmo__placeholder:after{position:absolute;top:0;right:0;bottom:0;left:0;transform:translate(-100%);background-image:linear-gradient(90deg,rgba(255,255,255,0) 0,rgba(255,255,255,.2) 20%,rgba(255,255,255,.5) 60%,rgba(255,255,255,0) 100%);animation:shine 2s infinite;content:""}.picmo__picker.picmo__skeleton .picmo__headerSkeleton{background-color:var(--secondary-background-color);padding-top:8px;padding-bottom:8px;display:flex;flex-direction:column;overflow:hidden;gap:8px;border-bottom:1px solid var(--border-color);width:var(--picker-width)}.picmo__picker.picmo__skeleton .picmo__searchSkeleton{padding:0 8px;height:var(--search-height)}.picmo__picker.picmo__skeleton .picmo__searchSkeleton .picmo__searchInput{width:100%;height:28px;border-radius:3px}.picmo__picker.picmo__skeleton .picmo__categoryTabsSkeleton{height:var(--category-tabs-height);display:flex;flex-direction:row;align-items:center;justify-self:center;width:calc(2rem * var(--category-count, 1))}.picmo__picker.picmo__skeleton .picmo__categoryTabsSkeleton .picmo__categoryTab{width:25px;height:25px;padding:2px;border-radius:5px;margin:.25em}.picmo__picker.picmo__skeleton .picmo__contentSkeleton{height:var(--content-height);padding-right:8px;opacity:.7}.picmo__picker.picmo__skeleton .picmo__contentSkeleton .picmo__categoryName{width:50%;height:1rem;margin:.5rem;box-sizing:border-box}.picmo__picker.picmo__skeleton .picmo__contentSkeleton .picmo__emojiGrid{display:grid;justify-content:space-between;gap:1px;padding:0 .5em;grid-template-columns:repeat(var(--emojis-per-row),calc(var(--emoji-size) * var(--emoji-size-multiplier)));grid-auto-rows:calc(var(--emoji-size) * var(--emoji-size-multiplier));align-items:center;justify-items:center;width:var(--picker-width)}.picmo__picker.picmo__skeleton .picmo__contentSkeleton .picmo__emojiGrid .picmo__emoji{width:var(--emoji-size);height:var(--emoji-size);border-radius:50%}.picmo__picker.picmo__skeleton .picmo__previewSkeleton{height:var(--emoji-preview-height);border-top:1px solid var(--border-color);display:grid;align-items:center;padding:.5em;gap:6px;grid-template-columns:auto 1fr;grid-template-rows:auto 1fr;grid-template-areas:"emoji name" "emoji tags"}.picmo__picker.picmo__skeleton .picmo__previewSkeleton .picmo__previewEmoji{grid-area:emoji;border-radius:50%;width:var(--emoji-preview-size);height:var(--emoji-preview-size)}.picmo__picker.picmo__skeleton .picmo__previewSkeleton .picmo__previewName{grid-area:name;height:.8em;width:80%}.picmo__picker.picmo__skeleton .picmo__previewSkeleton .picmo__tagList{grid-area:tags;list-style-type:none;display:flex;flex-direction:row;padding:0;margin:0}.picmo__picker.picmo__skeleton .picmo__previewSkeleton .picmo__tagList .picmo__tag{border-radius:3px;padding:2px 8px;margin-right:.25em;height:1em;width:20%}.picmo__overlay{background:rgba(0,0,0,.75);height:100%;left:0;position:fixed;top:0;width:100%;z-index:1000}.picmo__content{position:relative;overflow:hidden;height:var(--content-height)}.picmo__content.picmo__fullHeight{height:calc(var(--content-height) + var(--category-tabs-height) + var(--category-tabs-offset));overflow-y:auto}.picmo__pluginContainer{margin:.5em;display:flex;flex-direction:row}.picmo__header{background-color:var(--secondary-background-color);padding-top:8px;padding-bottom:8px;display:grid;gap:8px;border-bottom:1px solid var(--border-color)}@media (prefers-reduced-motion: reduce){.picmo__placeholder{background:var(--placeholder-background-color);position:relative;overflow:hidden}.picmo__placeholder:after{display:none}}.picmo__picker .picmo__preview{border-top:1px solid var(--border-color);display:grid;align-items:center;gap:6px;grid-template-columns:auto 1fr;grid-template-rows:auto 1fr;grid-template-areas:"emoji name" "emoji tags";height:var(--emoji-preview-height);box-sizing:border-box;padding:.5em;position:relative;background:var(--preview-background-color)}.picmo__picker .picmo__preview .picmo__previewEmoji{grid-area:emoji;font-size:var(--emoji-preview-size);font-family:var(--emoji-font);width:1.25em;display:flex;align-items:center;justify-content:center}.picmo__picker .picmo__preview .picmo__previewName{grid-area:name;color:var(--text-color);font-size:.8em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:500}.picmo__picker .picmo__preview .picmo__tagList{grid-area:tags;list-style-type:none;display:flex;flex-direction:row;padding:0;margin:0;font-size:.75em;overflow:hidden}.picmo__picker .picmo__preview .picmo__tag{border-radius:3px;background:var(--tag-background-color);color:var(--text-color);padding:2px 8px;margin-right:.25em;white-space:nowrap}.picmo__picker .picmo__preview .picmo__tag:last-child{margin-right:0}.picmo__picker .picmo__searchContainer{display:flex;height:var(--search-height);box-sizing:border-box;padding:0 8px;position:relative}.picmo__picker .picmo__searchContainer .picmo__searchField{background:var(--search-background-color);border-radius:3px;border:none;box-sizing:border-box;color:var(--text-color);font-size:.9em;outline:none;padding:.5em 2.25em .5em .5em;width:100%}.picmo__picker .picmo__searchContainer .picmo__searchField:focus{background:var(--search-focus-background-color)}.picmo__picker .picmo__searchContainer .picmo__searchField::placeholder{color:var(--search-placeholder-color)}.picmo__picker .picmo__searchContainer .picmo__searchAccessory{color:var(--search-icon-color);height:100%;position:absolute;right:1em;top:0;width:1.25rem;display:flex;align-items:center}.picmo__picker .picmo__searchContainer .picmo__searchAccessory svg{fill:var(--search-icon-color)}.picmo__picker .picmo__searchContainer .picmo__clearButton{border:0;color:var(--search-icon-color);background:transparent;cursor:pointer}.picmo__picker .picmo__searchContainer .picmo__clearSearchButton{cursor:pointer;border:none;background:transparent;color:var(--search-icon-color);font-size:1em;width:100%;height:100%;display:flex;align-items:center;padding:0}.picmo__picker .picmo__searchContainer .picmo__notFound [data-icon]{fill:#f3e265}.picmo__picker .picmo__variantOverlay{background:var(--overlay-background-color);border-radius:5px;display:flex;flex-direction:column;height:100%;justify-content:center;left:0;position:absolute;top:0;width:100%;z-index:1}.picmo__picker .picmo__variantOverlay .picmo__variantPopup{background:var(--variant-popup-background-color);border-radius:5px;margin:.5em;padding:.5em;text-align:center;user-select:none;display:flex;align-items:center;justify-content:center}.picmo__customEmoji{width:1em;height:1em}@keyframes shine{to{transform:translate(100%)}}.picmo__picker .picmo__imagePlaceholder{width:2rem;height:2rem;border-radius:50%}.picmo__placeholder{background:#DDDBDD;position:relative}.picmo__placeholder:after{position:absolute;top:0;right:0;bottom:0;left:0;transform:translate(-100%);background-image:linear-gradient(90deg,rgba(255,255,255,0) 0,rgba(255,255,255,.2) 20%,rgba(255,255,255,.5) 60%,rgba(255,255,255,0) 100%);animation:shine 2s infinite;content:""}\n';let Dt,It=0;const Mt=Pt();function Ft(e){Mt(Ot);const t=be(e),i=((null==t?void 0:t.custom)||[]).map((e=>({...e,custom:!0,tags:["custom",...e.tags||[]]}))),r=new Ce;Dt||(Dt=function(e){return N(e.locale,e.dataStore,e.messages,e.emojiData)}(t));const n=new Lt(t.i18n);Dt.then((e=>{r.emit("data:ready",e)})).catch((e=>{r.emit("error",e)}));const s=new At({events:r,i18n:n,customEmojis:i,renderer:t.renderer,options:t,emojiData:Dt,pickerId:`picmo-${Date.now()}-${It++}`}).create(Ct);return s.renderSync(),s}Symbol.toStringTag}}]);
//# sourceMappingURL=vendor.js.map